var iu=Object.defineProperty;var oo=i=>{throw TypeError(i)};var ru=(i,t,e)=>t in i?iu(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var lo=(i,t,e)=>ru(i,typeof t!="symbol"?t+"":t,e),yr=(i,t,e)=>t.has(i)||oo("Cannot "+e);var ie=(i,t,e)=>(yr(i,t,"read from private field"),e?e.call(i):t.get(i)),Ls=(i,t,e)=>t.has(i)?oo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),pn=(i,t,e,s)=>(yr(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e),ni=(i,t,e)=>(yr(i,t,"access private method"),e);var co=(i,t,e,s)=>({set _(n){pn(i,t,n,e)},get _(){return ie(i,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();function ba(i){const t=Object.create(null);for(const e of i.split(","))t[e]=1;return e=>e in t}const Dt={},Zs=[],ss=()=>{},Gl=()=>!1,Ui=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),Aa=i=>i.startsWith("onUpdate:"),se=Object.assign,wa=(i,t)=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)},au=Object.prototype.hasOwnProperty,Rt=(i,t)=>au.call(i,t),gt=Array.isArray,Qs=i=>zi(i)==="[object Map]",Xl=i=>zi(i)==="[object Set]",vt=i=>typeof i=="function",Wt=i=>typeof i=="string",vs=i=>typeof i=="symbol",jt=i=>i!==null&&typeof i=="object",Kl=i=>(jt(i)||vt(i))&&vt(i.then)&&vt(i.catch),Yl=Object.prototype.toString,zi=i=>Yl.call(i),ou=i=>zi(i).slice(8,-1),Jl=i=>zi(i)==="[object Object]",xa=i=>Wt(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,In=ba(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wi=i=>{const t=Object.create(null);return(e=>t[e]||(t[e]=i(e)))},lu=/-\w/g,ke=Wi(i=>i.replace(lu,t=>t.slice(1).toUpperCase())),cu=/\B([A-Z])/g,zs=Wi(i=>i.replace(cu,"-$1").toLowerCase()),Gi=Wi(i=>i.charAt(0).toUpperCase()+i.slice(1)),br=Wi(i=>i?`on${Gi(i)}`:""),Ps=(i,t)=>!Object.is(i,t),vi=(i,...t)=>{for(let e=0;e<i.length;e++)i[e](...t)},Zl=(i,t,e,s=!1)=>{Object.defineProperty(i,t,{configurable:!0,enumerable:!1,writable:s,value:e})},Ea=i=>{const t=parseFloat(i);return isNaN(t)?i:t};let ho;const Xi=()=>ho||(ho=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ki(i){if(gt(i)){const t={};for(let e=0;e<i.length;e++){const s=i[e],n=Wt(s)?fu(s):Ki(s);if(n)for(const r in n)t[r]=n[r]}return t}else if(Wt(i)||jt(i))return i}const hu=/;(?![^(]*\))/g,uu=/:([^]+)/,du=/\/\*[^]*?\*\//g;function fu(i){const t={};return i.replace(du,"").split(hu).forEach(e=>{if(e){const s=e.split(uu);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function ue(i){let t="";if(Wt(i))t=i;else if(gt(i))for(let e=0;e<i.length;e++){const s=ue(i[e]);s&&(t+=s+" ")}else if(jt(i))for(const e in i)i[e]&&(t+=e+" ");return t.trim()}const pu="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gu=ba(pu);function Ql(i){return!!i||i===""}const ql=i=>!!(i&&i.__v_isRef===!0),ut=i=>Wt(i)?i:i==null?"":gt(i)||jt(i)&&(i.toString===Yl||!vt(i.toString))?ql(i)?ut(i.value):JSON.stringify(i,tc,2):String(i),tc=(i,t)=>ql(t)?tc(i,t.value):Qs(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,n],r)=>(e[Ar(s,r)+" =>"]=n,e),{})}:Xl(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Ar(e))}:vs(t)?Ar(t):jt(t)&&!gt(t)&&!Jl(t)?String(t):t,Ar=(i,t="")=>{var e;return vs(i)?`Symbol(${(e=i.description)!=null?e:t})`:i};let xe;class mu{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=xe,!t&&xe&&(this.index=(xe.scopes||(xe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=xe;try{return xe=this,t()}finally{xe=e}}}on(){++this._on===1&&(this.prevScope=xe,xe=this)}off(){this._on>0&&--this._on===0&&(xe=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(this.effects.length=0,e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function vu(){return xe}let kt;const wr=new WeakSet;class ec{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,xe&&xe.active&&xe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,wr.has(this)&&(wr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||nc(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,uo(this),ic(this);const t=kt,e=Be;kt=this,Be=!0;try{return this.fn()}finally{rc(this),kt=t,Be=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Pa(t);this.deps=this.depsTail=void 0,uo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?wr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Wr(this)&&this.run()}get dirty(){return Wr(this)}}let sc=0,Rn,Mn;function nc(i,t=!1){if(i.flags|=8,t){i.next=Mn,Mn=i;return}i.next=Rn,Rn=i}function Sa(){sc++}function Ta(){if(--sc>0)return;if(Mn){let t=Mn;for(Mn=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let i;for(;Rn;){let t=Rn;for(Rn=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){i||(i=s)}t=e}}if(i)throw i}function ic(i){for(let t=i.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function rc(i){let t,e=i.depsTail,s=e;for(;s;){const n=s.prevDep;s.version===-1?(s===e&&(e=n),Pa(s),yu(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=n}i.deps=t,i.depsTail=e}function Wr(i){for(let t=i.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ac(t.dep.computed)||t.dep.version!==t.version))return!0;return!!i._dirty}function ac(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===Bn)||(i.globalVersion=Bn,!i.isSSR&&i.flags&128&&(!i.deps&&!i._dirty||!Wr(i))))return;i.flags|=2;const t=i.dep,e=kt,s=Be;kt=i,Be=!0;try{ic(i);const n=i.fn(i._value);(t.version===0||Ps(n,i._value))&&(i.flags|=128,i._value=n,t.version++)}catch(n){throw t.version++,n}finally{kt=e,Be=s,rc(i),i.flags&=-3}}function Pa(i,t=!1){const{dep:e,prevSub:s,nextSub:n}=i;if(s&&(s.nextSub=n,i.prevSub=void 0),n&&(n.prevSub=s,i.nextSub=void 0),e.subs===i&&(e.subs=s,!s&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Pa(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function yu(i){const{prevDep:t,nextDep:e}=i;t&&(t.nextDep=e,i.prevDep=void 0),e&&(e.prevDep=t,i.nextDep=void 0)}let Be=!0;const oc=[];function fs(){oc.push(Be),Be=!1}function ps(){const i=oc.pop();Be=i===void 0?!0:i}function uo(i){const{cleanup:t}=i;if(i.cleanup=void 0,t){const e=kt;kt=void 0;try{t()}finally{kt=e}}}let Bn=0;class bu{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ca{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!kt||!Be||kt===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==kt)e=this.activeLink=new bu(kt,this),kt.deps?(e.prevDep=kt.depsTail,kt.depsTail.nextDep=e,kt.depsTail=e):kt.deps=kt.depsTail=e,lc(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const s=e.nextDep;s.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=s),e.prevDep=kt.depsTail,e.nextDep=void 0,kt.depsTail.nextDep=e,kt.depsTail=e,kt.deps===e&&(kt.deps=s)}return e}trigger(t){this.version++,Bn++,this.notify(t)}notify(t){Sa();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Ta()}}}function lc(i){if(i.dep.sc++,i.sub.flags&4){const t=i.dep.computed;if(t&&!i.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)lc(s)}const e=i.dep.subs;e!==i&&(i.prevSub=e,e&&(e.nextSub=i)),i.dep.subs=i}}const Gr=new WeakMap,Bs=Symbol(""),Xr=Symbol(""),Hn=Symbol("");function le(i,t,e){if(Be&&kt){let s=Gr.get(i);s||Gr.set(i,s=new Map);let n=s.get(e);n||(s.set(e,n=new Ca),n.map=s,n.key=e),n.track()}}function ls(i,t,e,s,n,r){const a=Gr.get(i);if(!a){Bn++;return}const o=l=>{l&&l.trigger()};if(Sa(),t==="clear")a.forEach(o);else{const l=gt(i),c=l&&xa(e);if(l&&e==="length"){const h=Number(s);a.forEach((u,d)=>{(d==="length"||d===Hn||!vs(d)&&d>=h)&&o(u)})}else switch((e!==void 0||a.has(void 0))&&o(a.get(e)),c&&o(a.get(Hn)),t){case"add":l?c&&o(a.get("length")):(o(a.get(Bs)),Qs(i)&&o(a.get(Xr)));break;case"delete":l||(o(a.get(Bs)),Qs(i)&&o(a.get(Xr)));break;case"set":Qs(i)&&o(a.get(Bs));break}}Ta()}function Gs(i){const t=It(i);return t===i?t:(le(t,"iterate",Hn),Fe(i)?t:t.map(He))}function Yi(i){return le(i=It(i),"iterate",Hn),i}function ws(i,t){return gs(i)?ln(Hs(i)?He(t):t):He(t)}const Au={__proto__:null,[Symbol.iterator](){return xr(this,Symbol.iterator,i=>ws(this,i))},concat(...i){return Gs(this).concat(...i.map(t=>gt(t)?Gs(t):t))},entries(){return xr(this,"entries",i=>(i[1]=ws(this,i[1]),i))},every(i,t){return is(this,"every",i,t,void 0,arguments)},filter(i,t){return is(this,"filter",i,t,e=>e.map(s=>ws(this,s)),arguments)},find(i,t){return is(this,"find",i,t,e=>ws(this,e),arguments)},findIndex(i,t){return is(this,"findIndex",i,t,void 0,arguments)},findLast(i,t){return is(this,"findLast",i,t,e=>ws(this,e),arguments)},findLastIndex(i,t){return is(this,"findLastIndex",i,t,void 0,arguments)},forEach(i,t){return is(this,"forEach",i,t,void 0,arguments)},includes(...i){return Er(this,"includes",i)},indexOf(...i){return Er(this,"indexOf",i)},join(i){return Gs(this).join(i)},lastIndexOf(...i){return Er(this,"lastIndexOf",i)},map(i,t){return is(this,"map",i,t,void 0,arguments)},pop(){return gn(this,"pop")},push(...i){return gn(this,"push",i)},reduce(i,...t){return fo(this,"reduce",i,t)},reduceRight(i,...t){return fo(this,"reduceRight",i,t)},shift(){return gn(this,"shift")},some(i,t){return is(this,"some",i,t,void 0,arguments)},splice(...i){return gn(this,"splice",i)},toReversed(){return Gs(this).toReversed()},toSorted(i){return Gs(this).toSorted(i)},toSpliced(...i){return Gs(this).toSpliced(...i)},unshift(...i){return gn(this,"unshift",i)},values(){return xr(this,"values",i=>ws(this,i))}};function xr(i,t,e){const s=Yi(i),n=s[t]();return s!==i&&!Fe(i)&&(n._next=n.next,n.next=()=>{const r=n._next();return r.done||(r.value=e(r.value)),r}),n}const wu=Array.prototype;function is(i,t,e,s,n,r){const a=Yi(i),o=a!==i&&!Fe(i),l=a[t];if(l!==wu[t]){const u=l.apply(i,r);return o?He(u):u}let c=e;a!==i&&(o?c=function(u,d){return e.call(this,ws(i,u),d,i)}:e.length>2&&(c=function(u,d){return e.call(this,u,d,i)}));const h=l.call(a,c,s);return o&&n?n(h):h}function fo(i,t,e,s){const n=Yi(i);let r=e;return n!==i&&(Fe(i)?e.length>3&&(r=function(a,o,l){return e.call(this,a,o,l,i)}):r=function(a,o,l){return e.call(this,a,ws(i,o),l,i)}),n[t](r,...s)}function Er(i,t,e){const s=It(i);le(s,"iterate",Hn);const n=s[t](...e);return(n===-1||n===!1)&&La(e[0])?(e[0]=It(e[0]),s[t](...e)):n}function gn(i,t,e=[]){fs(),Sa();const s=It(i)[t].apply(i,e);return Ta(),ps(),s}const xu=ba("__proto__,__v_isRef,__isVue"),cc=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(vs));function Eu(i){vs(i)||(i=String(i));const t=It(this);return le(t,"has",i),t.hasOwnProperty(i)}class hc{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){if(e==="__v_skip")return t.__v_skip;const n=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!n;if(e==="__v_isReadonly")return n;if(e==="__v_isShallow")return r;if(e==="__v_raw")return s===(n?r?Nu:pc:r?fc:dc).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const a=gt(t);if(!n){let l;if(a&&(l=Au[e]))return l;if(e==="hasOwnProperty")return Eu}const o=Reflect.get(t,e,de(t)?t:s);if((vs(e)?cc.has(e):xu(e))||(n||le(t,"get",e),r))return o;if(de(o)){const l=a&&xa(e)?o:o.value;return n&&jt(l)?Yr(l):l}return jt(o)?n?Yr(o):Ra(o):o}}class uc extends hc{constructor(t=!1){super(!1,t)}set(t,e,s,n){let r=t[e];const a=gt(t)&&xa(e);if(!this._isShallow){const c=gs(r);if(!Fe(s)&&!gs(s)&&(r=It(r),s=It(s)),!a&&de(r)&&!de(s))return c||(r.value=s),!0}const o=a?Number(e)<t.length:Rt(t,e),l=Reflect.set(t,e,s,de(t)?t:n);return t===It(n)&&(o?Ps(s,r)&&ls(t,"set",e,s):ls(t,"add",e,s)),l}deleteProperty(t,e){const s=Rt(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&s&&ls(t,"delete",e,void 0),n}has(t,e){const s=Reflect.has(t,e);return(!vs(e)||!cc.has(e))&&le(t,"has",e),s}ownKeys(t){return le(t,"iterate",gt(t)?"length":Bs),Reflect.ownKeys(t)}}class Su extends hc{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Tu=new uc,Pu=new Su,Cu=new uc(!0);const Kr=i=>i,ii=i=>Reflect.getPrototypeOf(i);function Iu(i,t,e){return function(...s){const n=this.__v_raw,r=It(n),a=Qs(r),o=i==="entries"||i===Symbol.iterator&&a,l=i==="keys"&&a,c=n[i](...s),h=e?Kr:t?ln:He;return!t&&le(r,"iterate",l?Xr:Bs),se(Object.create(c),{next(){const{value:u,done:d}=c.next();return d?{value:u,done:d}:{value:o?[h(u[0]),h(u[1])]:h(u),done:d}}})}}function ri(i){return function(...t){return i==="delete"?!1:i==="clear"?void 0:this}}function Ru(i,t){const e={get(n){const r=this.__v_raw,a=It(r),o=It(n);i||(Ps(n,o)&&le(a,"get",n),le(a,"get",o));const{has:l}=ii(a),c=t?Kr:i?ln:He;if(l.call(a,n))return c(r.get(n));if(l.call(a,o))return c(r.get(o));r!==a&&r.get(n)},get size(){const n=this.__v_raw;return!i&&le(It(n),"iterate",Bs),n.size},has(n){const r=this.__v_raw,a=It(r),o=It(n);return i||(Ps(n,o)&&le(a,"has",n),le(a,"has",o)),n===o?r.has(n):r.has(n)||r.has(o)},forEach(n,r){const a=this,o=a.__v_raw,l=It(o),c=t?Kr:i?ln:He;return!i&&le(l,"iterate",Bs),o.forEach((h,u)=>n.call(r,c(h),c(u),a))}};return se(e,i?{add:ri("add"),set:ri("set"),delete:ri("delete"),clear:ri("clear")}:{add(n){!t&&!Fe(n)&&!gs(n)&&(n=It(n));const r=It(this);return ii(r).has.call(r,n)||(r.add(n),ls(r,"add",n,n)),this},set(n,r){!t&&!Fe(r)&&!gs(r)&&(r=It(r));const a=It(this),{has:o,get:l}=ii(a);let c=o.call(a,n);c||(n=It(n),c=o.call(a,n));const h=l.call(a,n);return a.set(n,r),c?Ps(r,h)&&ls(a,"set",n,r):ls(a,"add",n,r),this},delete(n){const r=It(this),{has:a,get:o}=ii(r);let l=a.call(r,n);l||(n=It(n),l=a.call(r,n)),o&&o.call(r,n);const c=r.delete(n);return l&&ls(r,"delete",n,void 0),c},clear(){const n=It(this),r=n.size!==0,a=n.clear();return r&&ls(n,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=Iu(n,i,t)}),e}function Ia(i,t){const e=Ru(i,t);return(s,n,r)=>n==="__v_isReactive"?!i:n==="__v_isReadonly"?i:n==="__v_raw"?s:Reflect.get(Rt(e,n)&&n in s?e:s,n,r)}const Mu={get:Ia(!1,!1)},Lu={get:Ia(!1,!0)},Ou={get:Ia(!0,!1)};const dc=new WeakMap,fc=new WeakMap,pc=new WeakMap,Nu=new WeakMap;function Du(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function _u(i){return i.__v_skip||!Object.isExtensible(i)?0:Du(ou(i))}function Ra(i){return gs(i)?i:Ma(i,!1,Tu,Mu,dc)}function Fu(i){return Ma(i,!1,Cu,Lu,fc)}function Yr(i){return Ma(i,!0,Pu,Ou,pc)}function Ma(i,t,e,s,n){if(!jt(i)||i.__v_raw&&!(t&&i.__v_isReactive))return i;const r=_u(i);if(r===0)return i;const a=n.get(i);if(a)return a;const o=new Proxy(i,r===2?s:e);return n.set(i,o),o}function Hs(i){return gs(i)?Hs(i.__v_raw):!!(i&&i.__v_isReactive)}function gs(i){return!!(i&&i.__v_isReadonly)}function Fe(i){return!!(i&&i.__v_isShallow)}function La(i){return i?!!i.__v_raw:!1}function It(i){const t=i&&i.__v_raw;return t?It(t):i}function gc(i){return!Rt(i,"__v_skip")&&Object.isExtensible(i)&&Zl(i,"__v_skip",!0),i}const He=i=>jt(i)?Ra(i):i,ln=i=>jt(i)?Yr(i):i;function de(i){return i?i.__v_isRef===!0:!1}function Nt(i){return mc(i,!1)}function ku(i){return mc(i,!0)}function mc(i,t){return de(i)?i:new ju(i,t)}class ju{constructor(t,e){this.dep=new Ca,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:It(t),this._value=e?t:He(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,s=this.__v_isShallow||Fe(t)||gs(t);t=s?t:It(t),Ps(t,e)&&(this._rawValue=t,this._value=s?t:He(t),this.dep.trigger())}}function yt(i){return de(i)?i.value:i}const $u={get:(i,t,e)=>t==="__v_raw"?i:yt(Reflect.get(i,t,e)),set:(i,t,e,s)=>{const n=i[t];return de(n)&&!de(e)?(n.value=e,!0):Reflect.set(i,t,e,s)}};function vc(i){return Hs(i)?i:new Proxy(i,$u)}class Bu{constructor(t,e,s){this.fn=t,this.setter=e,this._value=void 0,this.dep=new Ca(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Bn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&kt!==this)return nc(this,!0),!0}get value(){const t=this.dep.track();return ac(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Hu(i,t,e=!1){let s,n;return vt(i)?s=i:(s=i.get,n=i.set),new Bu(s,n,e)}const ai={},Pi=new WeakMap;let Ds;function Vu(i,t=!1,e=Ds){if(e){let s=Pi.get(e);s||Pi.set(e,s=[]),s.push(i)}}function Uu(i,t,e=Dt){const{immediate:s,deep:n,once:r,scheduler:a,augmentJob:o,call:l}=e,c=b=>n?b:Fe(b)||n===!1||n===0?cs(b,1):cs(b);let h,u,d,f,p=!1,g=!1;if(de(i)?(u=()=>i.value,p=Fe(i)):Hs(i)?(u=()=>c(i),p=!0):gt(i)?(g=!0,p=i.some(b=>Hs(b)||Fe(b)),u=()=>i.map(b=>{if(de(b))return b.value;if(Hs(b))return c(b);if(vt(b))return l?l(b,2):b()})):vt(i)?t?u=l?()=>l(i,2):i:u=()=>{if(d){fs();try{d()}finally{ps()}}const b=Ds;Ds=h;try{return l?l(i,3,[f]):i(f)}finally{Ds=b}}:u=ss,t&&n){const b=u,A=n===!0?1/0:n;u=()=>cs(b(),A)}const m=vu(),v=()=>{h.stop(),m&&m.active&&wa(m.effects,h)};if(r&&t){const b=t;t=(...A)=>{b(...A),v()}}let y=g?new Array(i.length).fill(ai):ai;const w=b=>{if(!(!(h.flags&1)||!h.dirty&&!b))if(t){const A=h.run();if(n||p||(g?A.some((S,T)=>Ps(S,y[T])):Ps(A,y))){d&&d();const S=Ds;Ds=h;try{const T=[A,y===ai?void 0:g&&y[0]===ai?[]:y,f];y=A,l?l(t,3,T):t(...T)}finally{Ds=S}}}else h.run()};return o&&o(w),h=new ec(u),h.scheduler=a?()=>a(w,!1):w,f=b=>Vu(b,!1,h),d=h.onStop=()=>{const b=Pi.get(h);if(b){if(l)l(b,4);else for(const A of b)A();Pi.delete(h)}},t?s?w(!0):y=h.run():a?a(w.bind(null,!0),!0):h.run(),v.pause=h.pause.bind(h),v.resume=h.resume.bind(h),v.stop=v,v}function cs(i,t=1/0,e){if(t<=0||!jt(i)||i.__v_skip||(e=e||new Map,(e.get(i)||0)>=t))return i;if(e.set(i,t),t--,de(i))cs(i.value,t,e);else if(gt(i))for(let s=0;s<i.length;s++)cs(i[s],t,e);else if(Xl(i)||Qs(i))i.forEach(s=>{cs(s,t,e)});else if(Jl(i)){for(const s in i)cs(i[s],t,e);for(const s of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,s)&&cs(i[s],t,e)}return i}function Qn(i,t,e,s){try{return s?i(...s):i()}catch(n){Ji(n,t,e)}}function ns(i,t,e,s){if(vt(i)){const n=Qn(i,t,e,s);return n&&Kl(n)&&n.catch(r=>{Ji(r,t,e)}),n}if(gt(i)){const n=[];for(let r=0;r<i.length;r++)n.push(ns(i[r],t,e,s));return n}}function Ji(i,t,e,s=!0){const n=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Dt;if(t){let o=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;o;){const h=o.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](i,l,c)===!1)return}o=o.parent}if(r){fs(),Qn(r,null,10,[i,l,c]),ps();return}}zu(i,e,n,s,a)}function zu(i,t,e,s=!0,n=!1){if(n)throw i;console.error(i)}const pe=[];let Je=-1;const qs=[];let xs=null,Xs=0;const yc=Promise.resolve();let Ci=null;function bc(i){const t=Ci||yc;return i?t.then(this?i.bind(this):i):t}function Wu(i){let t=Je+1,e=pe.length;for(;t<e;){const s=t+e>>>1,n=pe[s],r=Vn(n);r<i||r===i&&n.flags&2?t=s+1:e=s}return t}function Oa(i){if(!(i.flags&1)){const t=Vn(i),e=pe[pe.length-1];!e||!(i.flags&2)&&t>=Vn(e)?pe.push(i):pe.splice(Wu(t),0,i),i.flags|=1,Ac()}}function Ac(){Ci||(Ci=yc.then(xc))}function Gu(i){gt(i)?qs.push(...i):xs&&i.id===-1?xs.splice(Xs+1,0,i):i.flags&1||(qs.push(i),i.flags|=1),Ac()}function po(i,t,e=Je+1){for(;e<pe.length;e++){const s=pe[e];if(s&&s.flags&2){if(i&&s.id!==i.uid)continue;pe.splice(e,1),e--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function wc(i){if(qs.length){const t=[...new Set(qs)].sort((e,s)=>Vn(e)-Vn(s));if(qs.length=0,xs){xs.push(...t);return}for(xs=t,Xs=0;Xs<xs.length;Xs++){const e=xs[Xs];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}xs=null,Xs=0}}const Vn=i=>i.id==null?i.flags&2?-1:1/0:i.id;function xc(i){try{for(Je=0;Je<pe.length;Je++){const t=pe[Je];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Qn(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Je<pe.length;Je++){const t=pe[Je];t&&(t.flags&=-2)}Je=-1,pe.length=0,wc(),Ci=null,(pe.length||qs.length)&&xc()}}let ee=null,Ec=null;function Ii(i){const t=ee;return ee=i,Ec=i&&i.type.__scopeId||null,t}function Gt(i,t=ee,e){if(!t||i._n)return i;const s=(...n)=>{s._d&&Li(-1);const r=Ii(t);let a;try{a=i(...n)}finally{Ii(r),s._d&&Li(1)}return a};return s._n=!0,s._c=!0,s._d=!0,s}function Na(i,t){if(ee===null)return i;const e=nr(ee),s=i.dirs||(i.dirs=[]);for(let n=0;n<t.length;n++){let[r,a,o,l=Dt]=t[n];r&&(vt(r)&&(r={mounted:r,updated:r}),r.deep&&cs(a),s.push({dir:r,instance:e,value:a,oldValue:void 0,arg:o,modifiers:l}))}return i}function Os(i,t,e,s){const n=i.dirs,r=t&&t.dirs;for(let a=0;a<n.length;a++){const o=n[a];r&&(o.oldValue=r[a].value);let l=o.dir[s];l&&(fs(),ns(l,e,8,[i.el,o,i,t]),ps())}}function Xu(i,t){if(ce){let e=ce.provides;const s=ce.parent&&ce.parent.provides;s===e&&(e=ce.provides=Object.create(s)),e[i]=t}}function yi(i,t,e=!1){const s=Wd();if(s||en){let n=en?en._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(n&&i in n)return n[i];if(arguments.length>1)return e&&vt(t)?t.call(s&&s.proxy):t}}const Ku=Symbol.for("v-scx"),Yu=()=>yi(Ku);function Ln(i,t,e){return Sc(i,t,e)}function Sc(i,t,e=Dt){const{immediate:s,deep:n,flush:r,once:a}=e,o=se({},e),l=t&&s||!t&&r!=="post";let c;if(Gn){if(r==="sync"){const f=Yu();c=f.__watcherHandles||(f.__watcherHandles=[])}else if(!l){const f=()=>{};return f.stop=ss,f.resume=ss,f.pause=ss,f}}const h=ce;o.call=(f,p,g)=>ns(f,h,p,g);let u=!1;r==="post"?o.scheduler=f=>{Ie(f,h&&h.suspense)}:r!=="sync"&&(u=!0,o.scheduler=(f,p)=>{p?f():Oa(f)}),o.augmentJob=f=>{t&&(f.flags|=4),u&&(f.flags|=2,h&&(f.id=h.uid,f.i=h))};const d=Uu(i,t,o);return Gn&&(c?c.push(d):l&&d()),d}function Ju(i,t,e){const s=this.proxy,n=Wt(i)?i.includes(".")?Tc(s,i):()=>s[i]:i.bind(s,s);let r;vt(t)?r=t:(r=t.handler,e=t);const a=qn(this),o=Sc(n,r.bind(s),e);return a(),o}function Tc(i,t){const e=t.split(".");return()=>{let s=i;for(let n=0;n<e.length&&s;n++)s=s[e[n]];return s}}const Zu=Symbol("_vte"),Qu=i=>i.__isTeleport,qu=Symbol("_leaveCb");function Da(i,t){i.shapeFlag&6&&i.component?(i.transition=t,Da(i.component.subTree,t)):i.shapeFlag&128?(i.ssContent.transition=t.clone(i.ssContent),i.ssFallback.transition=t.clone(i.ssFallback)):i.transition=t}function Zt(i,t){return vt(i)?se({name:i.name},t,{setup:i}):i}function Pc(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}const Ri=new WeakMap;function On(i,t,e,s,n=!1){if(gt(i)){i.forEach((p,g)=>On(p,t&&(gt(t)?t[g]:t),e,s,n));return}if(tn(s)&&!n){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&On(i,t,e,s.component.subTree);return}const r=s.shapeFlag&4?nr(s.component):s.el,a=n?null:r,{i:o,r:l}=i,c=t&&t.r,h=o.refs===Dt?o.refs={}:o.refs,u=o.setupState,d=It(u),f=u===Dt?Gl:p=>Rt(d,p);if(c!=null&&c!==l){if(go(t),Wt(c))h[c]=null,f(c)&&(u[c]=null);else if(de(c)){c.value=null;const p=t;p.k&&(h[p.k]=null)}}if(vt(l))Qn(l,o,12,[a,h]);else{const p=Wt(l),g=de(l);if(p||g){const m=()=>{if(i.f){const v=p?f(l)?u[l]:h[l]:l.value;if(n)gt(v)&&wa(v,r);else if(gt(v))v.includes(r)||v.push(r);else if(p)h[l]=[r],f(l)&&(u[l]=h[l]);else{const y=[r];l.value=y,i.k&&(h[i.k]=y)}}else p?(h[l]=a,f(l)&&(u[l]=a)):g&&(l.value=a,i.k&&(h[i.k]=a))};if(a){const v=()=>{m(),Ri.delete(i)};v.id=-1,Ri.set(i,v),Ie(v,e)}else go(i),m()}}}function go(i){const t=Ri.get(i);t&&(t.flags|=8,Ri.delete(i))}Xi().requestIdleCallback;Xi().cancelIdleCallback;const tn=i=>!!i.type.__asyncLoader,Cc=i=>i.type.__isKeepAlive;function td(i,t){Ic(i,"a",t)}function ed(i,t){Ic(i,"da",t)}function Ic(i,t,e=ce){const s=i.__wdc||(i.__wdc=()=>{let n=e;for(;n;){if(n.isDeactivated)return;n=n.parent}return i()});if(Zi(t,s,e),e){let n=e.parent;for(;n&&n.parent;)Cc(n.parent.vnode)&&sd(s,t,e,n),n=n.parent}}function sd(i,t,e,s){const n=Zi(t,i,s,!0);qi(()=>{wa(s[t],n)},e)}function Zi(i,t,e=ce,s=!1){if(e){const n=e[i]||(e[i]=[]),r=t.__weh||(t.__weh=(...a)=>{fs();const o=qn(e),l=ns(t,e,i,a);return o(),ps(),l});return s?n.unshift(r):n.push(r),r}}const ys=i=>(t,e=ce)=>{(!Gn||i==="sp")&&Zi(i,(...s)=>t(...s),e)},nd=ys("bm"),Qi=ys("m"),id=ys("bu"),rd=ys("u"),Rc=ys("bum"),qi=ys("um"),ad=ys("sp"),od=ys("rtg"),ld=ys("rtc");function cd(i,t=ce){Zi("ec",i,t)}const hd="components",Mc=Symbol.for("v-ndc");function cn(i){return Wt(i)?ud(hd,i,!1)||i:i||Mc}function ud(i,t,e=!0,s=!1){const n=ee||ce;if(n){const r=n.type;{const o=Jd(r,!1);if(o&&(o===t||o===ke(t)||o===Gi(ke(t))))return r}const a=mo(n[i]||r[i],t)||mo(n.appContext[i],t);return!a&&s?r:a}}function mo(i,t){return i&&(i[t]||i[ke(t)]||i[Gi(ke(t))])}function tr(i,t,e,s){let n;const r=e,a=gt(i);if(a||Wt(i)){const o=a&&Hs(i);let l=!1,c=!1;o&&(l=!Fe(i),c=gs(i),i=Yi(i)),n=new Array(i.length);for(let h=0,u=i.length;h<u;h++)n[h]=t(l?c?ln(He(i[h])):He(i[h]):i[h],h,void 0,r)}else if(typeof i=="number"){n=new Array(i);for(let o=0;o<i;o++)n[o]=t(o+1,o,void 0,r)}else if(jt(i))if(i[Symbol.iterator])n=Array.from(i,(o,l)=>t(o,l,void 0,r));else{const o=Object.keys(i);n=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const h=o[l];n[l]=t(i[h],h,l,r)}}else n=[];return n}function Un(i,t,e={},s,n){if(ee.ce||ee.parent&&tn(ee.parent)&&ee.parent.ce){const c=Object.keys(e).length>0;return t!=="default"&&(e.name=t),U(),ht(Ut,null,[bt("slot",e,s&&s())],c?-2:64)}let r=i[t];r&&r._c&&(r._d=!1),U();const a=r&&Lc(r(e)),o=e.key||a&&a.key,l=ht(Ut,{key:(o&&!vs(o)?o:`_${t}`)+(!a&&s?"_fb":"")},a||(s?s():[]),a&&i._===1?64:-2);return!n&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),r&&r._c&&(r._d=!0),l}function Lc(i){return i.some(t=>Wn(t)?!(t.type===ms||t.type===Ut&&!Lc(t.children)):!0)?i:null}const Jr=i=>i?Zc(i)?nr(i):Jr(i.parent):null,Nn=se(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>Jr(i.parent),$root:i=>Jr(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>Nc(i),$forceUpdate:i=>i.f||(i.f=()=>{Oa(i.update)}),$nextTick:i=>i.n||(i.n=bc.bind(i.proxy)),$watch:i=>Ju.bind(i)}),Sr=(i,t)=>i!==Dt&&!i.__isScriptSetup&&Rt(i,t),dd={get({_:i},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:n,props:r,accessCache:a,type:o,appContext:l}=i;if(t[0]!=="$"){const d=a[t];if(d!==void 0)switch(d){case 1:return s[t];case 2:return n[t];case 4:return e[t];case 3:return r[t]}else{if(Sr(s,t))return a[t]=1,s[t];if(n!==Dt&&Rt(n,t))return a[t]=2,n[t];if(Rt(r,t))return a[t]=3,r[t];if(e!==Dt&&Rt(e,t))return a[t]=4,e[t];Zr&&(a[t]=0)}}const c=Nn[t];let h,u;if(c)return t==="$attrs"&&le(i.attrs,"get",""),c(i);if((h=o.__cssModules)&&(h=h[t]))return h;if(e!==Dt&&Rt(e,t))return a[t]=4,e[t];if(u=l.config.globalProperties,Rt(u,t))return u[t]},set({_:i},t,e){const{data:s,setupState:n,ctx:r}=i;return Sr(n,t)?(n[t]=e,!0):s!==Dt&&Rt(s,t)?(s[t]=e,!0):Rt(i.props,t)||t[0]==="$"&&t.slice(1)in i?!1:(r[t]=e,!0)},has({_:{data:i,setupState:t,accessCache:e,ctx:s,appContext:n,props:r,type:a}},o){let l;return!!(e[o]||i!==Dt&&o[0]!=="$"&&Rt(i,o)||Sr(t,o)||Rt(r,o)||Rt(s,o)||Rt(Nn,o)||Rt(n.config.globalProperties,o)||(l=a.__cssModules)&&l[o])},defineProperty(i,t,e){return e.get!=null?i._.accessCache[t]=0:Rt(e,"value")&&this.set(i,t,e.value,null),Reflect.defineProperty(i,t,e)}};function vo(i){return gt(i)?i.reduce((t,e)=>(t[e]=null,t),{}):i}let Zr=!0;function fd(i){const t=Nc(i),e=i.proxy,s=i.ctx;Zr=!1,t.beforeCreate&&yo(t.beforeCreate,i,"bc");const{data:n,computed:r,methods:a,watch:o,provide:l,inject:c,created:h,beforeMount:u,mounted:d,beforeUpdate:f,updated:p,activated:g,deactivated:m,beforeDestroy:v,beforeUnmount:y,destroyed:w,unmounted:b,render:A,renderTracked:S,renderTriggered:T,errorCaptured:R,serverPrefetch:x,expose:I,inheritAttrs:M,components:H,directives:B,filters:W}=t;if(c&&pd(c,s,null),a)for(const _ in a){const Y=a[_];vt(Y)&&(s[_]=Y.bind(e))}if(n){const _=n.call(e,e);jt(_)&&(i.data=Ra(_))}if(Zr=!0,r)for(const _ in r){const Y=r[_],nt=vt(Y)?Y.bind(e,e):vt(Y.get)?Y.get.bind(e,e):ss,mt=!vt(Y)&&vt(Y.set)?Y.set.bind(e):ss,wt=Bt({get:nt,set:mt});Object.defineProperty(s,_,{enumerable:!0,configurable:!0,get:()=>wt.value,set:rt=>wt.value=rt})}if(o)for(const _ in o)Oc(o[_],s,e,_);if(l){const _=vt(l)?l.call(e):l;Reflect.ownKeys(_).forEach(Y=>{Xu(Y,_[Y])})}h&&yo(h,i,"c");function F(_,Y){gt(Y)?Y.forEach(nt=>_(nt.bind(e))):Y&&_(Y.bind(e))}if(F(nd,u),F(Qi,d),F(id,f),F(rd,p),F(td,g),F(ed,m),F(cd,R),F(ld,S),F(od,T),F(Rc,y),F(qi,b),F(ad,x),gt(I))if(I.length){const _=i.exposed||(i.exposed={});I.forEach(Y=>{Object.defineProperty(_,Y,{get:()=>e[Y],set:nt=>e[Y]=nt,enumerable:!0})})}else i.exposed||(i.exposed={});A&&i.render===ss&&(i.render=A),M!=null&&(i.inheritAttrs=M),H&&(i.components=H),B&&(i.directives=B),x&&Pc(i)}function pd(i,t,e=ss){gt(i)&&(i=Qr(i));for(const s in i){const n=i[s];let r;jt(n)?"default"in n?r=yi(n.from||s,n.default,!0):r=yi(n.from||s):r=yi(n),de(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:a=>r.value=a}):t[s]=r}}function yo(i,t,e){ns(gt(i)?i.map(s=>s.bind(t.proxy)):i.bind(t.proxy),t,e)}function Oc(i,t,e,s){let n=s.includes(".")?Tc(e,s):()=>e[s];if(Wt(i)){const r=t[i];vt(r)&&Ln(n,r)}else if(vt(i))Ln(n,i.bind(e));else if(jt(i))if(gt(i))i.forEach(r=>Oc(r,t,e,s));else{const r=vt(i.handler)?i.handler.bind(e):t[i.handler];vt(r)&&Ln(n,r,i)}}function Nc(i){const t=i.type,{mixins:e,extends:s}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:a}}=i.appContext,o=r.get(t);let l;return o?l=o:!n.length&&!e&&!s?l=t:(l={},n.length&&n.forEach(c=>Mi(l,c,a,!0)),Mi(l,t,a)),jt(t)&&r.set(t,l),l}function Mi(i,t,e,s=!1){const{mixins:n,extends:r}=t;r&&Mi(i,r,e,!0),n&&n.forEach(a=>Mi(i,a,e,!0));for(const a in t)if(!(s&&a==="expose")){const o=gd[a]||e&&e[a];i[a]=o?o(i[a],t[a]):t[a]}return i}const gd={data:bo,props:Ao,emits:Ao,methods:Tn,computed:Tn,beforeCreate:fe,created:fe,beforeMount:fe,mounted:fe,beforeUpdate:fe,updated:fe,beforeDestroy:fe,beforeUnmount:fe,destroyed:fe,unmounted:fe,activated:fe,deactivated:fe,errorCaptured:fe,serverPrefetch:fe,components:Tn,directives:Tn,watch:vd,provide:bo,inject:md};function bo(i,t){return t?i?function(){return se(vt(i)?i.call(this,this):i,vt(t)?t.call(this,this):t)}:t:i}function md(i,t){return Tn(Qr(i),Qr(t))}function Qr(i){if(gt(i)){const t={};for(let e=0;e<i.length;e++)t[i[e]]=i[e];return t}return i}function fe(i,t){return i?[...new Set([].concat(i,t))]:t}function Tn(i,t){return i?se(Object.create(null),i,t):t}function Ao(i,t){return i?gt(i)&&gt(t)?[...new Set([...i,...t])]:se(Object.create(null),vo(i),vo(t??{})):t}function vd(i,t){if(!i)return t;if(!t)return i;const e=se(Object.create(null),i);for(const s in t)e[s]=fe(i[s],t[s]);return e}function Dc(){return{app:null,config:{isNativeTag:Gl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yd=0;function bd(i,t){return function(s,n=null){vt(s)||(s=se({},s)),n!=null&&!jt(n)&&(n=null);const r=Dc(),a=new WeakSet,o=[];let l=!1;const c=r.app={_uid:yd++,_component:s,_props:n,_container:null,_context:r,_instance:null,version:Qd,get config(){return r.config},set config(h){},use(h,...u){return a.has(h)||(h&&vt(h.install)?(a.add(h),h.install(c,...u)):vt(h)&&(a.add(h),h(c,...u))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,u){return u?(r.components[h]=u,c):r.components[h]},directive(h,u){return u?(r.directives[h]=u,c):r.directives[h]},mount(h,u,d){if(!l){const f=c._ceVNode||bt(s,n);return f.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),i(f,h,d),l=!0,c._container=h,h.__vue_app__=c,nr(f.component)}},onUnmount(h){o.push(h)},unmount(){l&&(ns(o,c._instance,16),i(null,c._container),delete c._container.__vue_app__)},provide(h,u){return r.provides[h]=u,c},runWithContext(h){const u=en;en=c;try{return h()}finally{en=u}}};return c}}let en=null;const Ad=(i,t)=>t==="modelValue"||t==="model-value"?i.modelModifiers:i[`${t}Modifiers`]||i[`${ke(t)}Modifiers`]||i[`${zs(t)}Modifiers`];function wd(i,t,...e){if(i.isUnmounted)return;const s=i.vnode.props||Dt;let n=e;const r=t.startsWith("update:"),a=r&&Ad(s,t.slice(7));a&&(a.trim&&(n=e.map(h=>Wt(h)?h.trim():h)),a.number&&(n=e.map(Ea)));let o,l=s[o=br(t)]||s[o=br(ke(t))];!l&&r&&(l=s[o=br(zs(t))]),l&&ns(l,i,6,n);const c=s[o+"Once"];if(c){if(!i.emitted)i.emitted={};else if(i.emitted[o])return;i.emitted[o]=!0,ns(c,i,6,n)}}const xd=new WeakMap;function _c(i,t,e=!1){const s=e?xd:t.emitsCache,n=s.get(i);if(n!==void 0)return n;const r=i.emits;let a={},o=!1;if(!vt(i)){const l=c=>{const h=_c(c,t,!0);h&&(o=!0,se(a,h))};!e&&t.mixins.length&&t.mixins.forEach(l),i.extends&&l(i.extends),i.mixins&&i.mixins.forEach(l)}return!r&&!o?(jt(i)&&s.set(i,null),null):(gt(r)?r.forEach(l=>a[l]=null):se(a,r),jt(i)&&s.set(i,a),a)}function er(i,t){return!i||!Ui(t)?!1:(t=t.slice(2).replace(/Once$/,""),Rt(i,t[0].toLowerCase()+t.slice(1))||Rt(i,zs(t))||Rt(i,t))}function wo(i){const{type:t,vnode:e,proxy:s,withProxy:n,propsOptions:[r],slots:a,attrs:o,emit:l,render:c,renderCache:h,props:u,data:d,setupState:f,ctx:p,inheritAttrs:g}=i,m=Ii(i);let v,y;try{if(e.shapeFlag&4){const b=n||s,A=b;v=qe(c.call(A,b,h,u,f,d,p)),y=o}else{const b=t;v=qe(b.length>1?b(u,{attrs:o,slots:a,emit:l}):b(u,null)),y=t.props?o:Ed(o)}}catch(b){Dn.length=0,Ji(b,i,1),v=bt(ms)}let w=v;if(y&&g!==!1){const b=Object.keys(y),{shapeFlag:A}=w;b.length&&A&7&&(r&&b.some(Aa)&&(y=Sd(y,r)),w=hn(w,y,!1,!0))}return e.dirs&&(w=hn(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(e.dirs):e.dirs),e.transition&&Da(w,e.transition),v=w,Ii(m),v}const Ed=i=>{let t;for(const e in i)(e==="class"||e==="style"||Ui(e))&&((t||(t={}))[e]=i[e]);return t},Sd=(i,t)=>{const e={};for(const s in i)(!Aa(s)||!(s.slice(9)in t))&&(e[s]=i[s]);return e};function Td(i,t,e){const{props:s,children:n,component:r}=i,{props:a,children:o,patchFlag:l}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return s?xo(s,a,c):!!a;if(l&8){const h=t.dynamicProps;for(let u=0;u<h.length;u++){const d=h[u];if(a[d]!==s[d]&&!er(c,d))return!0}}}else return(n||o)&&(!o||!o.$stable)?!0:s===a?!1:s?a?xo(s,a,c):!0:!!a;return!1}function xo(i,t,e){const s=Object.keys(t);if(s.length!==Object.keys(i).length)return!0;for(let n=0;n<s.length;n++){const r=s[n];if(t[r]!==i[r]&&!er(e,r))return!0}return!1}function Pd({vnode:i,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===i&&(s.el=i.el),s===i)(i=t.vnode).el=e,t=t.parent;else break}}const Fc={},kc=()=>Object.create(Fc),jc=i=>Object.getPrototypeOf(i)===Fc;function Cd(i,t,e,s=!1){const n={},r=kc();i.propsDefaults=Object.create(null),$c(i,t,n,r);for(const a in i.propsOptions[0])a in n||(n[a]=void 0);e?i.props=s?n:Fu(n):i.type.props?i.props=n:i.props=r,i.attrs=r}function Id(i,t,e,s){const{props:n,attrs:r,vnode:{patchFlag:a}}=i,o=It(n),[l]=i.propsOptions;let c=!1;if((s||a>0)&&!(a&16)){if(a&8){const h=i.vnode.dynamicProps;for(let u=0;u<h.length;u++){let d=h[u];if(er(i.emitsOptions,d))continue;const f=t[d];if(l)if(Rt(r,d))f!==r[d]&&(r[d]=f,c=!0);else{const p=ke(d);n[p]=qr(l,o,p,f,i,!1)}else f!==r[d]&&(r[d]=f,c=!0)}}}else{$c(i,t,n,r)&&(c=!0);let h;for(const u in o)(!t||!Rt(t,u)&&((h=zs(u))===u||!Rt(t,h)))&&(l?e&&(e[u]!==void 0||e[h]!==void 0)&&(n[u]=qr(l,o,u,void 0,i,!0)):delete n[u]);if(r!==o)for(const u in r)(!t||!Rt(t,u))&&(delete r[u],c=!0)}c&&ls(i.attrs,"set","")}function $c(i,t,e,s){const[n,r]=i.propsOptions;let a=!1,o;if(t)for(let l in t){if(In(l))continue;const c=t[l];let h;n&&Rt(n,h=ke(l))?!r||!r.includes(h)?e[h]=c:(o||(o={}))[h]=c:er(i.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,a=!0)}if(r){const l=It(e),c=o||Dt;for(let h=0;h<r.length;h++){const u=r[h];e[u]=qr(n,l,u,c[u],i,!Rt(c,u))}}return a}function qr(i,t,e,s,n,r){const a=i[e];if(a!=null){const o=Rt(a,"default");if(o&&s===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&vt(l)){const{propsDefaults:c}=n;if(e in c)s=c[e];else{const h=qn(n);s=c[e]=l.call(null,t),h()}}else s=l;n.ce&&n.ce._setProp(e,s)}a[0]&&(r&&!o?s=!1:a[1]&&(s===""||s===zs(e))&&(s=!0))}return s}const Rd=new WeakMap;function Bc(i,t,e=!1){const s=e?Rd:t.propsCache,n=s.get(i);if(n)return n;const r=i.props,a={},o=[];let l=!1;if(!vt(i)){const h=u=>{l=!0;const[d,f]=Bc(u,t,!0);se(a,d),f&&o.push(...f)};!e&&t.mixins.length&&t.mixins.forEach(h),i.extends&&h(i.extends),i.mixins&&i.mixins.forEach(h)}if(!r&&!l)return jt(i)&&s.set(i,Zs),Zs;if(gt(r))for(let h=0;h<r.length;h++){const u=ke(r[h]);Eo(u)&&(a[u]=Dt)}else if(r)for(const h in r){const u=ke(h);if(Eo(u)){const d=r[h],f=a[u]=gt(d)||vt(d)?{type:d}:se({},d),p=f.type;let g=!1,m=!0;if(gt(p))for(let v=0;v<p.length;++v){const y=p[v],w=vt(y)&&y.name;if(w==="Boolean"){g=!0;break}else w==="String"&&(m=!1)}else g=vt(p)&&p.name==="Boolean";f[0]=g,f[1]=m,(g||Rt(f,"default"))&&o.push(u)}}const c=[a,o];return jt(i)&&s.set(i,c),c}function Eo(i){return i[0]!=="$"&&!In(i)}const _a=i=>i==="_"||i==="_ctx"||i==="$stable",Fa=i=>gt(i)?i.map(qe):[qe(i)],Md=(i,t,e)=>{if(t._n)return t;const s=Gt((...n)=>Fa(t(...n)),e);return s._c=!1,s},Hc=(i,t,e)=>{const s=i._ctx;for(const n in i){if(_a(n))continue;const r=i[n];if(vt(r))t[n]=Md(n,r,s);else if(r!=null){const a=Fa(r);t[n]=()=>a}}},Vc=(i,t)=>{const e=Fa(t);i.slots.default=()=>e},Uc=(i,t,e)=>{for(const s in t)(e||!_a(s))&&(i[s]=t[s])},Ld=(i,t,e)=>{const s=i.slots=kc();if(i.vnode.shapeFlag&32){const n=t._;n?(Uc(s,t,e),e&&Zl(s,"_",n,!0)):Hc(t,s)}else t&&Vc(i,t)},Od=(i,t,e)=>{const{vnode:s,slots:n}=i;let r=!0,a=Dt;if(s.shapeFlag&32){const o=t._;o?e&&o===1?r=!1:Uc(n,t,e):(r=!t.$stable,Hc(t,n)),a=t}else t&&(Vc(i,t),a={default:1});if(r)for(const o in n)!_a(o)&&a[o]==null&&delete n[o]},Ie=kd;function Nd(i){return Dd(i)}function Dd(i,t){const e=Xi();e.__VUE__=!0;const{insert:s,remove:n,patchProp:r,createElement:a,createText:o,createComment:l,setText:c,setElementText:h,parentNode:u,nextSibling:d,setScopeId:f=ss,insertStaticContent:p}=i,g=(E,P,O,k=null,D=null,$=null,J=void 0,G=null,Z=!!P.dynamicChildren)=>{if(E===P)return;E&&!mn(E,P)&&(k=C(E),rt(E,D,$,!0),E=null),P.patchFlag===-2&&(Z=!1,P.dynamicChildren=null);const{type:V,ref:at,shapeFlag:Q}=P;switch(V){case sr:m(E,P,O,k);break;case ms:v(E,P,O,k);break;case bi:E==null&&y(P,O,k,J);break;case Ut:H(E,P,O,k,D,$,J,G,Z);break;default:Q&1?A(E,P,O,k,D,$,J,G,Z):Q&6?B(E,P,O,k,D,$,J,G,Z):(Q&64||Q&128)&&V.process(E,P,O,k,D,$,J,G,Z,tt)}at!=null&&D?On(at,E&&E.ref,$,P||E,!P):at==null&&E&&E.ref!=null&&On(E.ref,null,$,E,!0)},m=(E,P,O,k)=>{if(E==null)s(P.el=o(P.children),O,k);else{const D=P.el=E.el;P.children!==E.children&&c(D,P.children)}},v=(E,P,O,k)=>{E==null?s(P.el=l(P.children||""),O,k):P.el=E.el},y=(E,P,O,k)=>{[E.el,E.anchor]=p(E.children,P,O,k,E.el,E.anchor)},w=({el:E,anchor:P},O,k)=>{let D;for(;E&&E!==P;)D=d(E),s(E,O,k),E=D;s(P,O,k)},b=({el:E,anchor:P})=>{let O;for(;E&&E!==P;)O=d(E),n(E),E=O;n(P)},A=(E,P,O,k,D,$,J,G,Z)=>{if(P.type==="svg"?J="svg":P.type==="math"&&(J="mathml"),E==null)S(P,O,k,D,$,J,G,Z);else{const V=E.el&&E.el._isVueCE?E.el:null;try{V&&V._beginPatch(),x(E,P,D,$,J,G,Z)}finally{V&&V._endPatch()}}},S=(E,P,O,k,D,$,J,G)=>{let Z,V;const{props:at,shapeFlag:Q,transition:it,dirs:ft}=E;if(Z=E.el=a(E.type,$,at&&at.is,at),Q&8?h(Z,E.children):Q&16&&R(E.children,Z,null,k,D,Tr(E,$),J,G),ft&&Os(E,null,k,"created"),T(Z,E,E.scopeId,J,k),at){for(const Ft in at)Ft!=="value"&&!In(Ft)&&r(Z,Ft,null,at[Ft],$,k);"value"in at&&r(Z,"value",null,at.value,$),(V=at.onVnodeBeforeMount)&&Ge(V,k,E)}ft&&Os(E,null,k,"beforeMount");const Tt=_d(D,it);Tt&&it.beforeEnter(Z),s(Z,P,O),((V=at&&at.onVnodeMounted)||Tt||ft)&&Ie(()=>{V&&Ge(V,k,E),Tt&&it.enter(Z),ft&&Os(E,null,k,"mounted")},D)},T=(E,P,O,k,D)=>{if(O&&f(E,O),k)for(let $=0;$<k.length;$++)f(E,k[$]);if(D){let $=D.subTree;if(P===$||Xc($.type)&&($.ssContent===P||$.ssFallback===P)){const J=D.vnode;T(E,J,J.scopeId,J.slotScopeIds,D.parent)}}},R=(E,P,O,k,D,$,J,G,Z=0)=>{for(let V=Z;V<E.length;V++){const at=E[V]=G?Es(E[V]):qe(E[V]);g(null,at,P,O,k,D,$,J,G)}},x=(E,P,O,k,D,$,J)=>{const G=P.el=E.el;let{patchFlag:Z,dynamicChildren:V,dirs:at}=P;Z|=E.patchFlag&16;const Q=E.props||Dt,it=P.props||Dt;let ft;if(O&&Ns(O,!1),(ft=it.onVnodeBeforeUpdate)&&Ge(ft,O,P,E),at&&Os(P,E,O,"beforeUpdate"),O&&Ns(O,!0),(Q.innerHTML&&it.innerHTML==null||Q.textContent&&it.textContent==null)&&h(G,""),V?I(E.dynamicChildren,V,G,O,k,Tr(P,D),$):J||Y(E,P,G,null,O,k,Tr(P,D),$,!1),Z>0){if(Z&16)M(G,Q,it,O,D);else if(Z&2&&Q.class!==it.class&&r(G,"class",null,it.class,D),Z&4&&r(G,"style",Q.style,it.style,D),Z&8){const Tt=P.dynamicProps;for(let Ft=0;Ft<Tt.length;Ft++){const Lt=Tt[Ft],ve=Q[Lt],ye=it[Lt];(ye!==ve||Lt==="value")&&r(G,Lt,ve,ye,D,O)}}Z&1&&E.children!==P.children&&h(G,P.children)}else!J&&V==null&&M(G,Q,it,O,D);((ft=it.onVnodeUpdated)||at)&&Ie(()=>{ft&&Ge(ft,O,P,E),at&&Os(P,E,O,"updated")},k)},I=(E,P,O,k,D,$,J)=>{for(let G=0;G<P.length;G++){const Z=E[G],V=P[G],at=Z.el&&(Z.type===Ut||!mn(Z,V)||Z.shapeFlag&198)?u(Z.el):O;g(Z,V,at,null,k,D,$,J,!0)}},M=(E,P,O,k,D)=>{if(P!==O){if(P!==Dt)for(const $ in P)!In($)&&!($ in O)&&r(E,$,P[$],null,D,k);for(const $ in O){if(In($))continue;const J=O[$],G=P[$];J!==G&&$!=="value"&&r(E,$,G,J,D,k)}"value"in O&&r(E,"value",P.value,O.value,D)}},H=(E,P,O,k,D,$,J,G,Z)=>{const V=P.el=E?E.el:o(""),at=P.anchor=E?E.anchor:o("");let{patchFlag:Q,dynamicChildren:it,slotScopeIds:ft}=P;ft&&(G=G?G.concat(ft):ft),E==null?(s(V,O,k),s(at,O,k),R(P.children||[],O,at,D,$,J,G,Z)):Q>0&&Q&64&&it&&E.dynamicChildren&&E.dynamicChildren.length===it.length?(I(E.dynamicChildren,it,O,D,$,J,G),(P.key!=null||D&&P===D.subTree)&&zc(E,P,!0)):Y(E,P,O,at,D,$,J,G,Z)},B=(E,P,O,k,D,$,J,G,Z)=>{P.slotScopeIds=G,E==null?P.shapeFlag&512?D.ctx.activate(P,O,k,J,Z):W(P,O,k,D,$,J,Z):et(E,P,Z)},W=(E,P,O,k,D,$,J)=>{const G=E.component=zd(E,k,D);if(Cc(E)&&(G.ctx.renderer=tt),Gd(G,!1,J),G.asyncDep){if(D&&D.registerDep(G,F,J),!E.el){const Z=G.subTree=bt(ms);v(null,Z,P,O),E.placeholder=Z.el}}else F(G,E,P,O,D,$,J)},et=(E,P,O)=>{const k=P.component=E.component;if(Td(E,P,O))if(k.asyncDep&&!k.asyncResolved){_(k,P,O);return}else k.next=P,k.update();else P.el=E.el,k.vnode=P},F=(E,P,O,k,D,$,J)=>{const G=()=>{if(E.isMounted){let{next:Q,bu:it,u:ft,parent:Tt,vnode:Ft}=E;{const ze=Wc(E);if(ze){Q&&(Q.el=Ft.el,_(E,Q,J)),ze.asyncDep.then(()=>{E.isUnmounted||G()});return}}let Lt=Q,ve;Ns(E,!1),Q?(Q.el=Ft.el,_(E,Q,J)):Q=Ft,it&&vi(it),(ve=Q.props&&Q.props.onVnodeBeforeUpdate)&&Ge(ve,Tt,Q,Ft),Ns(E,!0);const ye=wo(E),Ue=E.subTree;E.subTree=ye,g(Ue,ye,u(Ue.el),C(Ue),E,D,$),Q.el=ye.el,Lt===null&&Pd(E,ye.el),ft&&Ie(ft,D),(ve=Q.props&&Q.props.onVnodeUpdated)&&Ie(()=>Ge(ve,Tt,Q,Ft),D)}else{let Q;const{el:it,props:ft}=P,{bm:Tt,m:Ft,parent:Lt,root:ve,type:ye}=E,Ue=tn(P);Ns(E,!1),Tt&&vi(Tt),!Ue&&(Q=ft&&ft.onVnodeBeforeMount)&&Ge(Q,Lt,P),Ns(E,!0);{ve.ce&&ve.ce._def.shadowRoot!==!1&&ve.ce._injectChildStyle(ye);const ze=E.subTree=wo(E);g(null,ze,O,k,E,D,$),P.el=ze.el}if(Ft&&Ie(Ft,D),!Ue&&(Q=ft&&ft.onVnodeMounted)){const ze=P;Ie(()=>Ge(Q,Lt,ze),D)}(P.shapeFlag&256||Lt&&tn(Lt.vnode)&&Lt.vnode.shapeFlag&256)&&E.a&&Ie(E.a,D),E.isMounted=!0,P=O=k=null}};E.scope.on();const Z=E.effect=new ec(G);E.scope.off();const V=E.update=Z.run.bind(Z),at=E.job=Z.runIfDirty.bind(Z);at.i=E,at.id=E.uid,Z.scheduler=()=>Oa(at),Ns(E,!0),V()},_=(E,P,O)=>{P.component=E;const k=E.vnode.props;E.vnode=P,E.next=null,Id(E,P.props,k,O),Od(E,P.children,O),fs(),po(E),ps()},Y=(E,P,O,k,D,$,J,G,Z=!1)=>{const V=E&&E.children,at=E?E.shapeFlag:0,Q=P.children,{patchFlag:it,shapeFlag:ft}=P;if(it>0){if(it&128){mt(V,Q,O,k,D,$,J,G,Z);return}else if(it&256){nt(V,Q,O,k,D,$,J,G,Z);return}}ft&8?(at&16&&N(V,D,$),Q!==V&&h(O,Q)):at&16?ft&16?mt(V,Q,O,k,D,$,J,G,Z):N(V,D,$,!0):(at&8&&h(O,""),ft&16&&R(Q,O,k,D,$,J,G,Z))},nt=(E,P,O,k,D,$,J,G,Z)=>{E=E||Zs,P=P||Zs;const V=E.length,at=P.length,Q=Math.min(V,at);let it;for(it=0;it<Q;it++){const ft=P[it]=Z?Es(P[it]):qe(P[it]);g(E[it],ft,O,null,D,$,J,G,Z)}V>at?N(E,D,$,!0,!1,Q):R(P,O,k,D,$,J,G,Z,Q)},mt=(E,P,O,k,D,$,J,G,Z)=>{let V=0;const at=P.length;let Q=E.length-1,it=at-1;for(;V<=Q&&V<=it;){const ft=E[V],Tt=P[V]=Z?Es(P[V]):qe(P[V]);if(mn(ft,Tt))g(ft,Tt,O,null,D,$,J,G,Z);else break;V++}for(;V<=Q&&V<=it;){const ft=E[Q],Tt=P[it]=Z?Es(P[it]):qe(P[it]);if(mn(ft,Tt))g(ft,Tt,O,null,D,$,J,G,Z);else break;Q--,it--}if(V>Q){if(V<=it){const ft=it+1,Tt=ft<at?P[ft].el:k;for(;V<=it;)g(null,P[V]=Z?Es(P[V]):qe(P[V]),O,Tt,D,$,J,G,Z),V++}}else if(V>it)for(;V<=Q;)rt(E[V],D,$,!0),V++;else{const ft=V,Tt=V,Ft=new Map;for(V=Tt;V<=it;V++){const Ce=P[V]=Z?Es(P[V]):qe(P[V]);Ce.key!=null&&Ft.set(Ce.key,V)}let Lt,ve=0;const ye=it-Tt+1;let Ue=!1,ze=0;const fn=new Array(ye);for(V=0;V<ye;V++)fn[V]=0;for(V=ft;V<=Q;V++){const Ce=E[V];if(ve>=ye){rt(Ce,D,$,!0);continue}let We;if(Ce.key!=null)We=Ft.get(Ce.key);else for(Lt=Tt;Lt<=it;Lt++)if(fn[Lt-Tt]===0&&mn(Ce,P[Lt])){We=Lt;break}We===void 0?rt(Ce,D,$,!0):(fn[We-Tt]=V+1,We>=ze?ze=We:Ue=!0,g(Ce,P[We],O,null,D,$,J,G,Z),ve++)}const io=Ue?Fd(fn):Zs;for(Lt=io.length-1,V=ye-1;V>=0;V--){const Ce=Tt+V,We=P[Ce],ro=P[Ce+1],ao=Ce+1<at?ro.el||Gc(ro):k;fn[V]===0?g(null,We,O,ao,D,$,J,G,Z):Ue&&(Lt<0||V!==io[Lt]?wt(We,O,ao,2):Lt--)}}},wt=(E,P,O,k,D=null)=>{const{el:$,type:J,transition:G,children:Z,shapeFlag:V}=E;if(V&6){wt(E.component.subTree,P,O,k);return}if(V&128){E.suspense.move(P,O,k);return}if(V&64){J.move(E,P,O,tt);return}if(J===Ut){s($,P,O);for(let Q=0;Q<Z.length;Q++)wt(Z[Q],P,O,k);s(E.anchor,P,O);return}if(J===bi){w(E,P,O);return}if(k!==2&&V&1&&G)if(k===0)G.beforeEnter($),s($,P,O),Ie(()=>G.enter($),D);else{const{leave:Q,delayLeave:it,afterLeave:ft}=G,Tt=()=>{E.ctx.isUnmounted?n($):s($,P,O)},Ft=()=>{$._isLeaving&&$[qu](!0),Q($,()=>{Tt(),ft&&ft()})};it?it($,Tt,Ft):Ft()}else s($,P,O)},rt=(E,P,O,k=!1,D=!1)=>{const{type:$,props:J,ref:G,children:Z,dynamicChildren:V,shapeFlag:at,patchFlag:Q,dirs:it,cacheIndex:ft}=E;if(Q===-2&&(D=!1),G!=null&&(fs(),On(G,null,O,E,!0),ps()),ft!=null&&(P.renderCache[ft]=void 0),at&256){P.ctx.deactivate(E);return}const Tt=at&1&&it,Ft=!tn(E);let Lt;if(Ft&&(Lt=J&&J.onVnodeBeforeUnmount)&&Ge(Lt,P,E),at&6)te(E.component,O,k);else{if(at&128){E.suspense.unmount(O,k);return}Tt&&Os(E,null,P,"beforeUnmount"),at&64?E.type.remove(E,P,O,tt,k):V&&!V.hasOnce&&($!==Ut||Q>0&&Q&64)?N(V,P,O,!1,!0):($===Ut&&Q&384||!D&&at&16)&&N(Z,P,O),k&&xt(E)}(Ft&&(Lt=J&&J.onVnodeUnmounted)||Tt)&&Ie(()=>{Lt&&Ge(Lt,P,E),Tt&&Os(E,null,P,"unmounted")},O)},xt=E=>{const{type:P,el:O,anchor:k,transition:D}=E;if(P===Ut){ne(O,k);return}if(P===bi){b(E);return}const $=()=>{n(O),D&&!D.persisted&&D.afterLeave&&D.afterLeave()};if(E.shapeFlag&1&&D&&!D.persisted){const{leave:J,delayLeave:G}=D,Z=()=>J(O,$);G?G(E.el,$,Z):Z()}else $()},ne=(E,P)=>{let O;for(;E!==P;)O=d(E),n(E),E=O;n(P)},te=(E,P,O)=>{const{bum:k,scope:D,job:$,subTree:J,um:G,m:Z,a:V}=E;So(Z),So(V),k&&vi(k),D.stop(),$&&($.flags|=8,rt(J,E,P,O)),G&&Ie(G,P),Ie(()=>{E.isUnmounted=!0},P)},N=(E,P,O,k=!1,D=!1,$=0)=>{for(let J=$;J<E.length;J++)rt(E[J],P,O,k,D)},C=E=>{if(E.shapeFlag&6)return C(E.component.subTree);if(E.shapeFlag&128)return E.suspense.next();const P=d(E.anchor||E.el),O=P&&P[Zu];return O?d(O):P};let L=!1;const K=(E,P,O)=>{let k;E==null?P._vnode&&(rt(P._vnode,null,null,!0),k=P._vnode.component):g(P._vnode||null,E,P,null,null,null,O),P._vnode=E,L||(L=!0,po(k),wc(),L=!1)},tt={p:g,um:rt,m:wt,r:xt,mt:W,mc:R,pc:Y,pbc:I,n:C,o:i};return{render:K,hydrate:void 0,createApp:bd(K)}}function Tr({type:i,props:t},e){return e==="svg"&&i==="foreignObject"||e==="mathml"&&i==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function Ns({effect:i,job:t},e){e?(i.flags|=32,t.flags|=4):(i.flags&=-33,t.flags&=-5)}function _d(i,t){return(!i||i&&!i.pendingBranch)&&t&&!t.persisted}function zc(i,t,e=!1){const s=i.children,n=t.children;if(gt(s)&&gt(n))for(let r=0;r<s.length;r++){const a=s[r];let o=n[r];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=n[r]=Es(n[r]),o.el=a.el),!e&&o.patchFlag!==-2&&zc(a,o)),o.type===sr&&(o.patchFlag!==-1?o.el=a.el:o.__elIndex=r+(i.type===Ut?1:0)),o.type===ms&&!o.el&&(o.el=a.el)}}function Fd(i){const t=i.slice(),e=[0];let s,n,r,a,o;const l=i.length;for(s=0;s<l;s++){const c=i[s];if(c!==0){if(n=e[e.length-1],i[n]<c){t[s]=n,e.push(s);continue}for(r=0,a=e.length-1;r<a;)o=r+a>>1,i[e[o]]<c?r=o+1:a=o;c<i[e[r]]&&(r>0&&(t[s]=e[r-1]),e[r]=s)}}for(r=e.length,a=e[r-1];r-- >0;)e[r]=a,a=t[a];return e}function Wc(i){const t=i.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Wc(t)}function So(i){if(i)for(let t=0;t<i.length;t++)i[t].flags|=8}function Gc(i){if(i.placeholder)return i.placeholder;const t=i.component;return t?Gc(t.subTree):null}const Xc=i=>i.__isSuspense;function kd(i,t){t&&t.pendingBranch?gt(i)?t.effects.push(...i):t.effects.push(i):Gu(i)}const Ut=Symbol.for("v-fgt"),sr=Symbol.for("v-txt"),ms=Symbol.for("v-cmt"),bi=Symbol.for("v-stc"),Dn=[];let Oe=null;function U(i=!1){Dn.push(Oe=i?null:[])}function jd(){Dn.pop(),Oe=Dn[Dn.length-1]||null}let zn=1;function Li(i,t=!1){zn+=i,i<0&&Oe&&t&&(Oe.hasOnce=!0)}function Kc(i){return i.dynamicChildren=zn>0?Oe||Zs:null,jd(),zn>0&&Oe&&Oe.push(i),i}function ct(i,t,e,s,n,r){return Kc(X(i,t,e,s,n,r,!0))}function ht(i,t,e,s,n){return Kc(bt(i,t,e,s,n,!0))}function Wn(i){return i?i.__v_isVNode===!0:!1}function mn(i,t){return i.type===t.type&&i.key===t.key}const Yc=({key:i})=>i??null,Ai=({ref:i,ref_key:t,ref_for:e})=>(typeof i=="number"&&(i=""+i),i!=null?Wt(i)||de(i)||vt(i)?{i:ee,r:i,k:t,f:!!e}:i:null);function X(i,t=null,e=null,s=0,n=null,r=i===Ut?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:i,props:t,key:t&&Yc(t),ref:t&&Ai(t),scopeId:Ec,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:ee};return o?(ka(l,e),r&128&&i.normalize(l)):e&&(l.shapeFlag|=Wt(e)?8:16),zn>0&&!a&&Oe&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Oe.push(l),l}const bt=$d;function $d(i,t=null,e=null,s=0,n=null,r=!1){if((!i||i===Mc)&&(i=ms),Wn(i)){const o=hn(i,t,!0);return e&&ka(o,e),zn>0&&!r&&Oe&&(o.shapeFlag&6?Oe[Oe.indexOf(i)]=o:Oe.push(o)),o.patchFlag=-2,o}if(Zd(i)&&(i=i.__vccOpts),t){t=Bd(t);let{class:o,style:l}=t;o&&!Wt(o)&&(t.class=ue(o)),jt(l)&&(La(l)&&!gt(l)&&(l=se({},l)),t.style=Ki(l))}const a=Wt(i)?1:Xc(i)?128:Qu(i)?64:jt(i)?4:vt(i)?2:0;return X(i,t,e,s,n,a,r,!0)}function Bd(i){return i?La(i)||jc(i)?se({},i):i:null}function hn(i,t,e=!1,s=!1){const{props:n,ref:r,patchFlag:a,children:o,transition:l}=i,c=t?Hd(n||{},t):n,h={__v_isVNode:!0,__v_skip:!0,type:i.type,props:c,key:c&&Yc(c),ref:t&&t.ref?e&&r?gt(r)?r.concat(Ai(t)):[r,Ai(t)]:Ai(t):r,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:o,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:t&&i.type!==Ut?a===-1?16:a|16:a,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:l,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&hn(i.ssContent),ssFallback:i.ssFallback&&hn(i.ssFallback),placeholder:i.placeholder,el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return l&&s&&Da(h,l.clone(h)),h}function Cs(i=" ",t=0){return bt(sr,null,i,t)}function Jc(i,t){const e=bt(bi,null,i);return e.staticCount=t,e}function Se(i="",t=!1){return t?(U(),ht(ms,null,i)):bt(ms,null,i)}function qe(i){return i==null||typeof i=="boolean"?bt(ms):gt(i)?bt(Ut,null,i.slice()):Wn(i)?Es(i):bt(sr,null,String(i))}function Es(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:hn(i)}function ka(i,t){let e=0;const{shapeFlag:s}=i;if(t==null)t=null;else if(gt(t))e=16;else if(typeof t=="object")if(s&65){const n=t.default;n&&(n._c&&(n._d=!1),ka(i,n()),n._c&&(n._d=!0));return}else{e=32;const n=t._;!n&&!jc(t)?t._ctx=ee:n===3&&ee&&(ee.slots._===1?t._=1:(t._=2,i.patchFlag|=1024))}else vt(t)?(t={default:t,_ctx:ee},e=32):(t=String(t),s&64?(e=16,t=[Cs(t)]):e=8);i.children=t,i.shapeFlag|=e}function Hd(...i){const t={};for(let e=0;e<i.length;e++){const s=i[e];for(const n in s)if(n==="class")t.class!==s.class&&(t.class=ue([t.class,s.class]));else if(n==="style")t.style=Ki([t.style,s.style]);else if(Ui(n)){const r=t[n],a=s[n];a&&r!==a&&!(gt(r)&&r.includes(a))&&(t[n]=r?[].concat(r,a):a)}else n!==""&&(t[n]=s[n])}return t}function Ge(i,t,e,s=null){ns(i,t,7,[e,s])}const Vd=Dc();let Ud=0;function zd(i,t,e){const s=i.type,n=(t?t.appContext:i.appContext)||Vd,r={uid:Ud++,vnode:i,type:s,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new mu(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Bc(s,n),emitsOptions:_c(s,n),emit:null,emitted:null,propsDefaults:Dt,inheritAttrs:s.inheritAttrs,ctx:Dt,data:Dt,props:Dt,attrs:Dt,slots:Dt,refs:Dt,setupState:Dt,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=wd.bind(null,r),i.ce&&i.ce(r),r}let ce=null;const Wd=()=>ce||ee;let Oi,ta;{const i=Xi(),t=(e,s)=>{let n;return(n=i[e])||(n=i[e]=[]),n.push(s),r=>{n.length>1?n.forEach(a=>a(r)):n[0](r)}};Oi=t("__VUE_INSTANCE_SETTERS__",e=>ce=e),ta=t("__VUE_SSR_SETTERS__",e=>Gn=e)}const qn=i=>{const t=ce;return Oi(i),i.scope.on(),()=>{i.scope.off(),Oi(t)}},To=()=>{ce&&ce.scope.off(),Oi(null)};function Zc(i){return i.vnode.shapeFlag&4}let Gn=!1;function Gd(i,t=!1,e=!1){t&&ta(t);const{props:s,children:n}=i.vnode,r=Zc(i);Cd(i,s,r,t),Ld(i,n,e||t);const a=r?Xd(i,t):void 0;return t&&ta(!1),a}function Xd(i,t){const e=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,dd);const{setup:s}=e;if(s){fs();const n=i.setupContext=s.length>1?Yd(i):null,r=qn(i),a=Qn(s,i,0,[i.props,n]),o=Kl(a);if(ps(),r(),(o||i.sp)&&!tn(i)&&Pc(i),o){if(a.then(To,To),t)return a.then(l=>{Po(i,l)}).catch(l=>{Ji(l,i,0)});i.asyncDep=a}else Po(i,a)}else Qc(i)}function Po(i,t,e){vt(t)?i.type.__ssrInlineRender?i.ssrRender=t:i.render=t:jt(t)&&(i.setupState=vc(t)),Qc(i)}function Qc(i,t,e){const s=i.type;i.render||(i.render=s.render||ss);{const n=qn(i);fs();try{fd(i)}finally{ps(),n()}}}const Kd={get(i,t){return le(i,"get",""),i[t]}};function Yd(i){const t=e=>{i.exposed=e||{}};return{attrs:new Proxy(i.attrs,Kd),slots:i.slots,emit:i.emit,expose:t}}function nr(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(vc(gc(i.exposed)),{get(t,e){if(e in t)return t[e];if(e in Nn)return Nn[e](i)},has(t,e){return e in t||e in Nn}})):i.proxy}function Jd(i,t=!0){return vt(i)?i.displayName||i.name:i.name||t&&i.__name}function Zd(i){return vt(i)&&"__vccOpts"in i}const Bt=(i,t)=>Hu(i,t,Gn);function Ni(i,t,e){try{Li(-1);const s=arguments.length;return s===2?jt(t)&&!gt(t)?Wn(t)?bt(i,null,[t]):bt(i,t):bt(i,null,t):(s>3?e=Array.prototype.slice.call(arguments,2):s===3&&Wn(e)&&(e=[e]),bt(i,t,e))}finally{Li(1)}}const Qd="3.5.27";let ea;const Co=typeof window<"u"&&window.trustedTypes;if(Co)try{ea=Co.createPolicy("vue",{createHTML:i=>i})}catch{}const qc=ea?i=>ea.createHTML(i):i=>i,qd="http://www.w3.org/2000/svg",tf="http://www.w3.org/1998/Math/MathML",as=typeof document<"u"?document:null,Io=as&&as.createElement("template"),ef={insert:(i,t,e)=>{t.insertBefore(i,e||null)},remove:i=>{const t=i.parentNode;t&&t.removeChild(i)},createElement:(i,t,e,s)=>{const n=t==="svg"?as.createElementNS(qd,i):t==="mathml"?as.createElementNS(tf,i):e?as.createElement(i,{is:e}):as.createElement(i);return i==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:i=>as.createTextNode(i),createComment:i=>as.createComment(i),setText:(i,t)=>{i.nodeValue=t},setElementText:(i,t)=>{i.textContent=t},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>as.querySelector(i),setScopeId(i,t){i.setAttribute(t,"")},insertStaticContent(i,t,e,s,n,r){const a=e?e.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),e),!(n===r||!(n=n.nextSibling)););else{Io.innerHTML=qc(s==="svg"?`<svg>${i}</svg>`:s==="mathml"?`<math>${i}</math>`:i);const o=Io.content;if(s==="svg"||s==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,e)}return[a?a.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},sf=Symbol("_vtc");function nf(i,t,e){const s=i[sf];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?i.removeAttribute("class"):e?i.setAttribute("class",t):i.className=t}const Di=Symbol("_vod"),th=Symbol("_vsh"),eh={name:"show",beforeMount(i,{value:t},{transition:e}){i[Di]=i.style.display==="none"?"":i.style.display,e&&t?e.beforeEnter(i):vn(i,t)},mounted(i,{value:t},{transition:e}){e&&t&&e.enter(i)},updated(i,{value:t,oldValue:e},{transition:s}){!t!=!e&&(s?t?(s.beforeEnter(i),vn(i,!0),s.enter(i)):s.leave(i,()=>{vn(i,!1)}):vn(i,t))},beforeUnmount(i,{value:t}){vn(i,t)}};function vn(i,t){i.style.display=t?i[Di]:"none",i[th]=!t}const rf=Symbol(""),af=/(?:^|;)\s*display\s*:/;function of(i,t,e){const s=i.style,n=Wt(e);let r=!1;if(e&&!n){if(t)if(Wt(t))for(const a of t.split(";")){const o=a.slice(0,a.indexOf(":")).trim();e[o]==null&&wi(s,o,"")}else for(const a in t)e[a]==null&&wi(s,a,"");for(const a in e)a==="display"&&(r=!0),wi(s,a,e[a])}else if(n){if(t!==e){const a=s[rf];a&&(e+=";"+a),s.cssText=e,r=af.test(e)}}else t&&i.removeAttribute("style");Di in i&&(i[Di]=r?s.display:"",i[th]&&(s.display="none"))}const Ro=/\s*!important$/;function wi(i,t,e){if(gt(e))e.forEach(s=>wi(i,t,s));else if(e==null&&(e=""),t.startsWith("--"))i.setProperty(t,e);else{const s=lf(i,t);Ro.test(e)?i.setProperty(zs(s),e.replace(Ro,""),"important"):i[s]=e}}const Mo=["Webkit","Moz","ms"],Pr={};function lf(i,t){const e=Pr[t];if(e)return e;let s=ke(t);if(s!=="filter"&&s in i)return Pr[t]=s;s=Gi(s);for(let n=0;n<Mo.length;n++){const r=Mo[n]+s;if(r in i)return Pr[t]=r}return t}const Lo="http://www.w3.org/1999/xlink";function Oo(i,t,e,s,n,r=gu(t)){s&&t.startsWith("xlink:")?e==null?i.removeAttributeNS(Lo,t.slice(6,t.length)):i.setAttributeNS(Lo,t,e):e==null||r&&!Ql(e)?i.removeAttribute(t):i.setAttribute(t,r?"":vs(e)?String(e):e)}function No(i,t,e,s,n){if(t==="innerHTML"||t==="textContent"){e!=null&&(i[t]=t==="innerHTML"?qc(e):e);return}const r=i.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const o=r==="OPTION"?i.getAttribute("value")||"":i.value,l=e==null?i.type==="checkbox"?"on":"":String(e);(o!==l||!("_value"in i))&&(i.value=l),e==null&&i.removeAttribute(t),i._value=e;return}let a=!1;if(e===""||e==null){const o=typeof i[t];o==="boolean"?e=Ql(e):e==null&&o==="string"?(e="",a=!0):o==="number"&&(e=0,a=!0)}try{i[t]=e}catch{}a&&i.removeAttribute(n||t)}function Ks(i,t,e,s){i.addEventListener(t,e,s)}function cf(i,t,e,s){i.removeEventListener(t,e,s)}const Do=Symbol("_vei");function hf(i,t,e,s,n=null){const r=i[Do]||(i[Do]={}),a=r[t];if(s&&a)a.value=s;else{const[o,l]=uf(t);if(s){const c=r[t]=pf(s,n);Ks(i,o,c,l)}else a&&(cf(i,o,a,l),r[t]=void 0)}}const _o=/(?:Once|Passive|Capture)$/;function uf(i){let t;if(_o.test(i)){t={};let s;for(;s=i.match(_o);)i=i.slice(0,i.length-s[0].length),t[s[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):zs(i.slice(2)),t]}let Cr=0;const df=Promise.resolve(),ff=()=>Cr||(df.then(()=>Cr=0),Cr=Date.now());function pf(i,t){const e=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=e.attached)return;ns(gf(s,e.value),t,5,[s])};return e.value=i,e.attached=ff(),e}function gf(i,t){if(gt(t)){const e=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{e.call(i),i._stopped=!0},t.map(s=>n=>!n._stopped&&s&&s(n))}else return t}const Fo=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,mf=(i,t,e,s,n,r)=>{const a=n==="svg";t==="class"?nf(i,s,a):t==="style"?of(i,e,s):Ui(t)?Aa(t)||hf(i,t,e,s,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):vf(i,t,s,a))?(No(i,t,s),!i.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Oo(i,t,s,a,r,t!=="value")):i._isVueCE&&(/[A-Z]/.test(t)||!Wt(s))?No(i,ke(t),s,r,t):(t==="true-value"?i._trueValue=s:t==="false-value"&&(i._falseValue=s),Oo(i,t,s,a))};function vf(i,t,e,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in i&&Fo(t)&&vt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&i.tagName==="IFRAME"||t==="form"||t==="list"&&i.tagName==="INPUT"||t==="type"&&i.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=i.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return Fo(t)&&Wt(e)?!1:t in i}const ko=i=>{const t=i.props["onUpdate:modelValue"]||!1;return gt(t)?e=>vi(t,e):t};function yf(i){i.target.composing=!0}function jo(i){const t=i.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ir=Symbol("_assign");function $o(i,t,e){return t&&(i=i.trim()),e&&(i=Ea(i)),i}const bf={created(i,{modifiers:{lazy:t,trim:e,number:s}},n){i[Ir]=ko(n);const r=s||n.props&&n.props.type==="number";Ks(i,t?"change":"input",a=>{a.target.composing||i[Ir]($o(i.value,e,r))}),(e||r)&&Ks(i,"change",()=>{i.value=$o(i.value,e,r)}),t||(Ks(i,"compositionstart",yf),Ks(i,"compositionend",jo),Ks(i,"change",jo))},mounted(i,{value:t}){i.value=t??""},beforeUpdate(i,{value:t,oldValue:e,modifiers:{lazy:s,trim:n,number:r}},a){if(i[Ir]=ko(a),i.composing)return;const o=(r||i.type==="number")&&!/^0\d/.test(i.value)?Ea(i.value):i.value,l=t??"";o!==l&&(document.activeElement===i&&i.type!=="range"&&(s&&t===e||n&&i.value.trim()===l)||(i.value=l))}},Af=se({patchProp:mf},ef);let Bo;function wf(){return Bo||(Bo=Nd(Af))}const xf=((...i)=>{const t=wf().createApp(...i),{mount:e}=t;return t.mount=s=>{const n=Sf(s);if(!n)return;const r=t._component;!vt(r)&&!r.render&&!r.template&&(r.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const a=e(n,!1,Ef(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),a},t});function Ef(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function Sf(i){return Wt(i)?document.querySelector(i):i}const me=(i,t)=>{const e=i.__vccOpts||i;for(const[s,n]of t)e[s]=n;return e},Tf={},Pf={class:"sidebar"};function Cf(i,t){return U(),ct("aside",Pf,[...t[0]||(t[0]=[Jc('<div class="sidebar-logo">Smart Reader</div><div class="nav-group"><div class="nav-item active"> </div><div class="nav-item"> </div><div class="nav-item"> </div></div><div class="sidebar-footer">Version MVP</div>',3)])])}const If=me(Tf,[["render",Cf]]),Rf={class:"toolbar"},Mf={class:"toolbar-actions"},Lf={class:"view-toggle"},Of={class:"button"},Nf={__name:"LibraryToolbar",props:{viewMode:{type:String,default:"grid"}},emits:["add-files","refresh","toggle-view"],setup(i,{emit:t}){const e=t,s=Nt(null),n=r=>{const a=Array.from(r.target.files||[]);e("add-files",a),s.value&&(s.value.value="")};return(r,a)=>(U(),ct("div",Rf,[a[4]||(a[4]=X("div",null,[X("div",{class:"breadcrumb"}," / ")],-1)),X("div",Mf,[X("div",Lf,[X("button",{class:ue({active:i.viewMode==="grid"}),onClick:a[0]||(a[0]=o=>r.$emit("toggle-view","grid"))},"",2),X("button",{class:ue({active:i.viewMode==="list"}),onClick:a[1]||(a[1]=o=>r.$emit("toggle-view","list"))},"",2)]),X("button",{class:"button secondary",onClick:a[2]||(a[2]=o=>r.$emit("refresh"))},""),X("label",Of,[a[3]||(a[3]=Cs(" +  ",-1)),X("input",{ref_key:"fileInput",ref:s,type:"file",accept:".pdf",multiple:"",class:"hidden-input",onChange:n},null,544)])])]))}},Df=me(Nf,[["__scopeId","data-v-9dfa2bfb"]]),_f={key:0,class:"empty-state"},Ff={key:1,class:"empty-state"},kf={key:2,class:"empty-state"},jf={key:3,class:"grid"},$f=["onClick"],Bf={class:"file-title"},Hf={class:"file-meta"},Vf={__name:"FileGrid",props:{files:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:""}},setup(i){const t=s=>s==="processing"?"Loading":s==="ready"?"Ready":s==="error"?"Error":"",e=s=>s==="processing"?"status-processing":s==="ready"?"status-ready":s==="error"?"status-error":"status-idle";return(s,n)=>(U(),ct("div",null,[i.loading?(U(),ct("div",_f,"...")):i.error?(U(),ct("div",Ff,ut(i.error),1)):i.files.length?(U(),ct("div",jf,[(U(!0),ct(Ut,null,tr(i.files,r=>(U(),ct("div",{key:r.id,class:"file-card",onClick:a=>s.$emit("open",r)},[n[0]||(n[0]=X("div",{class:"file-thumb"},"",-1)),X("div",Bf,ut(r.name),1),X("div",Hf,[X("span",null,ut(r.page_count?`${r.page_count} `:"PDF"),1),X("span",null,ut(t(r.status)),1)]),X("span",{class:ue(["status-badge",e(r.status)])},ut(t(r.status)),3)],8,$f))),128))])):(U(),ct("div",kf," PDF"))]))}};var Uf={9306:((i,t,e)=>{var s=e(4901),n=e(6823),r=TypeError;i.exports=function(a){if(s(a))return a;throw new r(n(a)+" is not a function")}}),3506:((i,t,e)=>{var s=e(3925),n=String,r=TypeError;i.exports=function(a){if(s(a))return a;throw new r("Can't set "+n(a)+" as a prototype")}}),7080:((i,t,e)=>{var s=e(4402).has;i.exports=function(n){return s(n),n}}),679:((i,t,e)=>{var s=e(1625),n=TypeError;i.exports=function(r,a){if(s(a,r))return r;throw new n("Incorrect invocation")}}),8551:((i,t,e)=>{var s=e(34),n=String,r=TypeError;i.exports=function(a){if(s(a))return a;throw new r(n(a)+" is not an object")}}),7811:(i=>{i.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"}),7394:((i,t,e)=>{var s=e(4576),n=e(6706),r=e(2195),a=s.ArrayBuffer,o=s.TypeError;i.exports=a&&n(a.prototype,"byteLength","get")||function(l){if(r(l)!=="ArrayBuffer")throw new o("ArrayBuffer expected");return l.byteLength}}),3238:((i,t,e)=>{var s=e(4576),n=e(7476),r=e(7394),a=s.ArrayBuffer,o=a&&a.prototype,l=o&&n(o.slice);i.exports=function(c){if(r(c)!==0||!l)return!1;try{return l(c,0,0),!1}catch{return!0}}}),5169:((i,t,e)=>{var s=e(3238),n=TypeError;i.exports=function(r){if(s(r))throw new n("ArrayBuffer is detached");return r}}),5636:((i,t,e)=>{var s=e(4576),n=e(9504),r=e(6706),a=e(7696),o=e(5169),l=e(7394),c=e(4483),h=e(1548),u=s.structuredClone,d=s.ArrayBuffer,f=s.DataView,p=Math.min,g=d.prototype,m=f.prototype,v=n(g.slice),y=r(g,"resizable","get"),w=r(g,"maxByteLength","get"),b=n(m.getInt8),A=n(m.setInt8);i.exports=(h||c)&&function(S,T,R){var x=l(S),I=T===void 0?x:a(T),M=!y||!y(S),H;if(o(S),h&&(S=u(S,{transfer:[S]}),x===I&&(R||M)))return S;if(x>=I&&(!R||M))H=v(S,0,I);else{var B=R&&!M&&w?{maxByteLength:w(S)}:void 0;H=new d(I,B);for(var W=new f(S),et=new f(H),F=p(I,x),_=0;_<F;_++)A(et,_,b(W,_))}return h||c(S),H}}),4644:((i,t,e)=>{var s=e(7811),n=e(3724),r=e(4576),a=e(4901),o=e(34),l=e(9297),c=e(6955),h=e(6823),u=e(6699),d=e(6840),f=e(2106),p=e(1625),g=e(2787),m=e(2967),v=e(8227),y=e(3392),w=e(1181),b=w.enforce,A=w.get,S=r.Int8Array,T=S&&S.prototype,R=r.Uint8ClampedArray,x=R&&R.prototype,I=S&&g(S),M=T&&g(T),H=Object.prototype,B=r.TypeError,W=v("toStringTag"),et=y("TYPED_ARRAY_TAG"),F="TypedArrayConstructor",_=s&&!!m&&c(r.opera)!=="Opera",Y=!1,nt,mt,wt,rt={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},xt={BigInt64Array:8,BigUint64Array:8},ne=function(E){if(!o(E))return!1;var P=c(E);return P==="DataView"||l(rt,P)||l(xt,P)},te=function(z){var E=g(z);if(o(E)){var P=A(E);return P&&l(P,F)?P[F]:te(E)}},N=function(z){if(!o(z))return!1;var E=c(z);return l(rt,E)||l(xt,E)},C=function(z){if(N(z))return z;throw new B("Target is not a typed array")},L=function(z){if(a(z)&&(!m||p(I,z)))return z;throw new B(h(z)+" is not a typed array constructor")},K=function(z,E,P,O){if(n){if(P)for(var k in rt){var D=r[k];if(D&&l(D.prototype,z))try{delete D.prototype[z]}catch{try{D.prototype[z]=E}catch{}}}(!M[z]||P)&&d(M,z,P?E:_&&T[z]||E,O)}},tt=function(z,E,P){var O,k;if(n){if(m){if(P){for(O in rt)if(k=r[O],k&&l(k,z))try{delete k[z]}catch{}}if(!I[z]||P)try{return d(I,z,P?E:_&&I[z]||E)}catch{}else return}for(O in rt)k=r[O],k&&(!k[z]||P)&&d(k,z,E)}};for(nt in rt)mt=r[nt],wt=mt&&mt.prototype,wt?b(wt)[F]=mt:_=!1;for(nt in xt)mt=r[nt],wt=mt&&mt.prototype,wt&&(b(wt)[F]=mt);if((!_||!a(I)||I===Function.prototype)&&(I=function(){throw new B("Incorrect invocation")},_))for(nt in rt)r[nt]&&m(r[nt],I);if((!_||!M||M===H)&&(M=I.prototype,_))for(nt in rt)r[nt]&&m(r[nt].prototype,M);if(_&&g(x)!==M&&m(x,M),n&&!l(M,W)){Y=!0,f(M,W,{configurable:!0,get:function(){return o(this)?this[et]:void 0}});for(nt in rt)r[nt]&&u(r[nt],et,nt)}i.exports={NATIVE_ARRAY_BUFFER_VIEWS:_,TYPED_ARRAY_TAG:Y&&et,aTypedArray:C,aTypedArrayConstructor:L,exportTypedArrayMethod:K,exportTypedArrayStaticMethod:tt,getTypedArrayConstructor:te,isView:ne,isTypedArray:N,TypedArray:I,TypedArrayPrototype:M}}),5370:((i,t,e)=>{var s=e(6198);i.exports=function(n,r,a){for(var o=0,l=arguments.length>2?a:s(r),c=new n(l);l>o;)c[o]=r[o++];return c}}),9617:((i,t,e)=>{var s=e(5397),n=e(5610),r=e(6198),a=function(o){return function(l,c,h){var u=s(l),d=r(u);if(d===0)return!o&&-1;var f=n(h,d),p;if(o&&c!==c){for(;d>f;)if(p=u[f++],p!==p)return!0}else for(;d>f;f++)if((o||f in u)&&u[f]===c)return o||f||0;return!o&&-1}};i.exports={includes:a(!0),indexOf:a(!1)}}),4527:((i,t,e)=>{var s=e(3724),n=e(4376),r=TypeError,a=Object.getOwnPropertyDescriptor,o=s&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}})();i.exports=o?function(l,c){if(n(l)&&!a(l,"length").writable)throw new r("Cannot set read only .length");return l.length=c}:function(l,c){return l.length=c}}),7680:((i,t,e)=>{var s=e(9504);i.exports=s([].slice)}),7628:((i,t,e)=>{var s=e(6198);i.exports=function(n,r){for(var a=s(n),o=new r(a),l=0;l<a;l++)o[l]=n[a-l-1];return o}}),9928:((i,t,e)=>{var s=e(6198),n=e(1291),r=RangeError;i.exports=function(a,o,l,c){var h=s(a),u=n(l),d=u<0?h+u:u;if(d>=h||d<0)throw new r("Incorrect index");for(var f=new o(h),p=0;p<h;p++)f[p]=p===d?c:a[p];return f}}),6319:((i,t,e)=>{var s=e(8551),n=e(9539);i.exports=function(r,a,o,l){try{return l?a(s(o)[0],o[1]):a(o)}catch(c){n(r,"throw",c)}}}),2195:((i,t,e)=>{var s=e(9504),n=s({}.toString),r=s("".slice);i.exports=function(a){return r(n(a),8,-1)}}),6955:((i,t,e)=>{var s=e(2140),n=e(4901),r=e(2195),a=e(8227),o=a("toStringTag"),l=Object,c=r((function(){return arguments})())==="Arguments",h=function(u,d){try{return u[d]}catch{}};i.exports=s?r:function(u){var d,f,p;return u===void 0?"Undefined":u===null?"Null":typeof(f=h(d=l(u),o))=="string"?f:c?r(d):(p=r(d))==="Object"&&n(d.callee)?"Arguments":p}}),7740:((i,t,e)=>{var s=e(9297),n=e(5031),r=e(7347),a=e(4913);i.exports=function(o,l,c){for(var h=n(l),u=a.f,d=r.f,f=0;f<h.length;f++){var p=h[f];!s(o,p)&&!(c&&s(c,p))&&u(o,p,d(l,p))}}}),2211:((i,t,e)=>{var s=e(9039);i.exports=!s(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype})}),2529:(i=>{i.exports=function(t,e){return{value:t,done:e}}}),6699:((i,t,e)=>{var s=e(3724),n=e(4913),r=e(6980);i.exports=s?function(a,o,l){return n.f(a,o,r(1,l))}:function(a,o,l){return a[o]=l,a}}),6980:(i=>{i.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}}),4659:((i,t,e)=>{var s=e(3724),n=e(4913),r=e(6980);i.exports=function(a,o,l){s?n.f(a,o,r(0,l)):a[o]=l}}),2106:((i,t,e)=>{var s=e(283),n=e(4913);i.exports=function(r,a,o){return o.get&&s(o.get,a,{getter:!0}),o.set&&s(o.set,a,{setter:!0}),n.f(r,a,o)}}),6840:((i,t,e)=>{var s=e(4901),n=e(4913),r=e(283),a=e(9433);i.exports=function(o,l,c,h){h||(h={});var u=h.enumerable,d=h.name!==void 0?h.name:l;if(s(c)&&r(c,d,h),h.global)u?o[l]=c:a(l,c);else{try{h.unsafe?o[l]&&(u=!0):delete o[l]}catch{}u?o[l]=c:n.f(o,l,{value:c,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return o}}),6279:((i,t,e)=>{var s=e(6840);i.exports=function(n,r,a){for(var o in r)s(n,o,r[o],a);return n}}),9433:((i,t,e)=>{var s=e(4576),n=Object.defineProperty;i.exports=function(r,a){try{n(s,r,{value:a,configurable:!0,writable:!0})}catch{s[r]=a}return a}}),3724:((i,t,e)=>{var s=e(9039);i.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}),4483:((i,t,e)=>{var s=e(4576),n=e(9429),r=e(1548),a=s.structuredClone,o=s.ArrayBuffer,l=s.MessageChannel,c=!1,h,u,d,f;if(r)c=function(p){a(p,{transfer:[p]})};else if(o)try{l||(h=n("worker_threads"),h&&(l=h.MessageChannel)),l&&(u=new l,d=new o(2),f=function(p){u.port1.postMessage(null,[p])},d.byteLength===2&&(f(d),d.byteLength===0&&(c=f)))}catch{}i.exports=c}),4055:((i,t,e)=>{var s=e(4576),n=e(34),r=s.document,a=n(r)&&n(r.createElement);i.exports=function(o){return a?r.createElement(o):{}}}),6837:(i=>{var t=TypeError,e=9007199254740991;i.exports=function(s){if(s>e)throw t("Maximum allowed index exceeded");return s}}),5002:(i=>{i.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}}),8727:(i=>{i.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),6193:((i,t,e)=>{var s=e(4215);i.exports=s==="NODE"}),2839:((i,t,e)=>{var s=e(4576),n=s.navigator,r=n&&n.userAgent;i.exports=r?String(r):""}),9519:((i,t,e)=>{var s=e(4576),n=e(2839),r=s.process,a=s.Deno,o=r&&r.versions||a&&a.version,l=o&&o.v8,c,h;l&&(c=l.split("."),h=c[0]>0&&c[0]<4?1:+(c[0]+c[1])),!h&&n&&(c=n.match(/Edge\/(\d+)/),(!c||c[1]>=74)&&(c=n.match(/Chrome\/(\d+)/),c&&(h=+c[1]))),i.exports=h}),4215:((i,t,e)=>{var s=e(4576),n=e(2839),r=e(2195),a=function(o){return n.slice(0,o.length)===o};i.exports=(function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":s.Bun&&typeof Bun.version=="string"?"BUN":s.Deno&&typeof Deno.version=="object"?"DENO":r(s.process)==="process"?"NODE":s.window&&s.document?"BROWSER":"REST"})()}),8574:((i,t,e)=>{var s=e(9504),n=Error,r=s("".replace),a=(function(c){return String(new n(c).stack)})("zxcasd"),o=/\n\s*at [^:]*:[^\n]*/,l=o.test(a);i.exports=function(c,h){if(l&&typeof c=="string"&&!n.prepareStackTrace)for(;h--;)c=r(c,o,"");return c}}),6518:((i,t,e)=>{var s=e(4576),n=e(7347).f,r=e(6699),a=e(6840),o=e(9433),l=e(7740),c=e(2796);i.exports=function(h,u){var d=h.target,f=h.global,p=h.stat,g,m,v,y,w,b;if(f?m=s:p?m=s[d]||o(d,{}):m=s[d]&&s[d].prototype,m)for(v in u){if(w=u[v],h.dontCallGetSet?(b=n(m,v),y=b&&b.value):y=m[v],g=c(f?v:d+(p?".":"#")+v,h.forced),!g&&y!==void 0){if(typeof w==typeof y)continue;l(w,y)}(h.sham||y&&y.sham)&&r(w,"sham",!0),a(m,v,w,h)}}}),9039:(i=>{i.exports=function(t){try{return!!t()}catch{return!0}}}),8745:((i,t,e)=>{var s=e(616),n=Function.prototype,r=n.apply,a=n.call;i.exports=typeof Reflect=="object"&&Reflect.apply||(s?a.bind(r):function(){return a.apply(r,arguments)})}),6080:((i,t,e)=>{var s=e(7476),n=e(9306),r=e(616),a=s(s.bind);i.exports=function(o,l){return n(o),l===void 0?o:r?a(o,l):function(){return o.apply(l,arguments)}}}),616:((i,t,e)=>{var s=e(9039);i.exports=!s(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")})}),9565:((i,t,e)=>{var s=e(616),n=Function.prototype.call;i.exports=s?n.bind(n):function(){return n.apply(n,arguments)}}),350:((i,t,e)=>{var s=e(3724),n=e(9297),r=Function.prototype,a=s&&Object.getOwnPropertyDescriptor,o=n(r,"name"),l=o&&(function(){}).name==="something",c=o&&(!s||s&&a(r,"name").configurable);i.exports={EXISTS:o,PROPER:l,CONFIGURABLE:c}}),6706:((i,t,e)=>{var s=e(9504),n=e(9306);i.exports=function(r,a,o){try{return s(n(Object.getOwnPropertyDescriptor(r,a)[o]))}catch{}}}),7476:((i,t,e)=>{var s=e(2195),n=e(9504);i.exports=function(r){if(s(r)==="Function")return n(r)}}),9504:((i,t,e)=>{var s=e(616),n=Function.prototype,r=n.call,a=s&&n.bind.bind(r,r);i.exports=s?a:function(o){return function(){return r.apply(o,arguments)}}}),9429:((i,t,e)=>{var s=e(4576),n=e(6193);i.exports=function(r){if(n){try{return s.process.getBuiltinModule(r)}catch{}try{return Function('return require("'+r+'")')()}catch{}}}}),7751:((i,t,e)=>{var s=e(4576),n=e(4901),r=function(a){return n(a)?a:void 0};i.exports=function(a,o){return arguments.length<2?r(s[a]):s[a]&&s[a][o]}}),1767:(i=>{i.exports=function(t){return{iterator:t,next:t.next,done:!1}}}),8646:((i,t,e)=>{var s=e(9565),n=e(8551),r=e(1767),a=e(851);i.exports=function(o,l){(!l||typeof o!="string")&&n(o);var c=a(o);return r(n(c!==void 0?s(c,o):o))}}),851:((i,t,e)=>{var s=e(6955),n=e(5966),r=e(4117),a=e(6269),o=e(8227),l=o("iterator");i.exports=function(c){if(!r(c))return n(c,l)||n(c,"@@iterator")||a[s(c)]}}),81:((i,t,e)=>{var s=e(9565),n=e(9306),r=e(8551),a=e(6823),o=e(851),l=TypeError;i.exports=function(c,h){var u=arguments.length<2?o(c):h;if(n(u))return r(s(u,c));throw new l(a(c)+" is not iterable")}}),5966:((i,t,e)=>{var s=e(9306),n=e(4117);i.exports=function(r,a){var o=r[a];return n(o)?void 0:s(o)}}),3789:((i,t,e)=>{var s=e(9306),n=e(8551),r=e(9565),a=e(1291),o=e(1767),l="Invalid size",c=RangeError,h=TypeError,u=Math.max,d=function(f,p){this.set=f,this.size=u(p,0),this.has=s(f.has),this.keys=s(f.keys)};d.prototype={getIterator:function(){return o(n(r(this.keys,this.set)))},includes:function(f){return r(this.has,this.set,f)}},i.exports=function(f){n(f);var p=+f.size;if(p!==p)throw new h(l);var g=a(p);if(g<0)throw new c(l);return new d(f,g)}}),4576:(function(i){var t=function(e){return e&&e.Math===Math&&e};i.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof global=="object"&&global)||t(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()}),9297:((i,t,e)=>{var s=e(9504),n=e(8981),r=s({}.hasOwnProperty);i.exports=Object.hasOwn||function(o,l){return r(n(o),l)}}),421:(i=>{i.exports={}}),397:((i,t,e)=>{var s=e(7751);i.exports=s("document","documentElement")}),5917:((i,t,e)=>{var s=e(3724),n=e(9039),r=e(4055);i.exports=!s&&!n(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7})}),7055:((i,t,e)=>{var s=e(9504),n=e(9039),r=e(2195),a=Object,o=s("".split);i.exports=n(function(){return!a("z").propertyIsEnumerable(0)})?function(l){return r(l)==="String"?o(l,""):a(l)}:a}),3167:((i,t,e)=>{var s=e(4901),n=e(34),r=e(2967);i.exports=function(a,o,l){var c,h;return r&&s(c=o.constructor)&&c!==l&&n(h=c.prototype)&&h!==l.prototype&&r(a,h),a}}),3706:((i,t,e)=>{var s=e(9504),n=e(4901),r=e(7629),a=s(Function.toString);n(r.inspectSource)||(r.inspectSource=function(o){return a(o)}),i.exports=r.inspectSource}),1181:((i,t,e)=>{var s=e(8622),n=e(4576),r=e(34),a=e(6699),o=e(9297),l=e(7629),c=e(6119),h=e(421),u="Object already initialized",d=n.TypeError,f=n.WeakMap,p,g,m,v=function(A){return m(A)?g(A):p(A,{})},y=function(A){return function(S){var T;if(!r(S)||(T=g(S)).type!==A)throw new d("Incompatible receiver, "+A+" required");return T}};if(s||l.state){var w=l.state||(l.state=new f);w.get=w.get,w.has=w.has,w.set=w.set,p=function(A,S){if(w.has(A))throw new d(u);return S.facade=A,w.set(A,S),S},g=function(A){return w.get(A)||{}},m=function(A){return w.has(A)}}else{var b=c("state");h[b]=!0,p=function(A,S){if(o(A,b))throw new d(u);return S.facade=A,a(A,b,S),S},g=function(A){return o(A,b)?A[b]:{}},m=function(A){return o(A,b)}}i.exports={set:p,get:g,has:m,enforce:v,getterFor:y}}),4209:((i,t,e)=>{var s=e(8227),n=e(6269),r=s("iterator"),a=Array.prototype;i.exports=function(o){return o!==void 0&&(n.Array===o||a[r]===o)}}),4376:((i,t,e)=>{var s=e(2195);i.exports=Array.isArray||function(r){return s(r)==="Array"}}),1108:((i,t,e)=>{var s=e(6955);i.exports=function(n){var r=s(n);return r==="BigInt64Array"||r==="BigUint64Array"}}),4901:(i=>{var t=typeof document=="object"&&document.all;i.exports=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"}}),2796:((i,t,e)=>{var s=e(9039),n=e(4901),r=/#|\.prototype\./,a=function(u,d){var f=l[o(u)];return f===h?!0:f===c?!1:n(d)?s(d):!!d},o=a.normalize=function(u){return String(u).replace(r,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",h=a.POLYFILL="P";i.exports=a}),4117:(i=>{i.exports=function(t){return t==null}}),34:((i,t,e)=>{var s=e(4901);i.exports=function(n){return typeof n=="object"?n!==null:s(n)}}),3925:((i,t,e)=>{var s=e(34);i.exports=function(n){return s(n)||n===null}}),6395:(i=>{i.exports=!1}),757:((i,t,e)=>{var s=e(7751),n=e(4901),r=e(1625),a=e(7040),o=Object;i.exports=a?function(l){return typeof l=="symbol"}:function(l){var c=s("Symbol");return n(c)&&r(c.prototype,o(l))}}),507:((i,t,e)=>{var s=e(9565);i.exports=function(n,r,a){for(var o=a?n:n.iterator,l=n.next,c,h;!(c=s(l,o)).done;)if(h=r(c.value),h!==void 0)return h}}),2652:((i,t,e)=>{var s=e(6080),n=e(9565),r=e(8551),a=e(6823),o=e(4209),l=e(6198),c=e(1625),h=e(81),u=e(851),d=e(9539),f=TypeError,p=function(m,v){this.stopped=m,this.result=v},g=p.prototype;i.exports=function(m,v,y){var w=y&&y.that,b=!!(y&&y.AS_ENTRIES),A=!!(y&&y.IS_RECORD),S=!!(y&&y.IS_ITERATOR),T=!!(y&&y.INTERRUPTED),R=s(v,w),x,I,M,H,B,W,et,F=function(Y){return x&&d(x,"normal",Y),new p(!0,Y)},_=function(Y){return b?(r(Y),T?R(Y[0],Y[1],F):R(Y[0],Y[1])):T?R(Y,F):R(Y)};if(A)x=m.iterator;else if(S)x=m;else{if(I=u(m),!I)throw new f(a(m)+" is not iterable");if(o(I)){for(M=0,H=l(m);H>M;M++)if(B=_(m[M]),B&&c(g,B))return B;return new p(!1)}x=h(m,I)}for(W=A?m.next:x.next;!(et=n(W,x)).done;){try{B=_(et.value)}catch(Y){d(x,"throw",Y)}if(typeof B=="object"&&B&&c(g,B))return B}return new p(!1)}}),9539:((i,t,e)=>{var s=e(9565),n=e(8551),r=e(5966);i.exports=function(a,o,l){var c,h;n(a);try{if(c=r(a,"return"),!c){if(o==="throw")throw l;return l}c=s(c,a)}catch(u){h=!0,c=u}if(o==="throw")throw l;if(h)throw c;return n(c),l}}),9462:((i,t,e)=>{var s=e(9565),n=e(2360),r=e(6699),a=e(6279),o=e(8227),l=e(1181),c=e(5966),h=e(7657).IteratorPrototype,u=e(2529),d=e(9539),f=o("toStringTag"),p="IteratorHelper",g="WrapForValidIterator",m=l.set,v=function(b){var A=l.getterFor(b?g:p);return a(n(h),{next:function(){var T=A(this);if(b)return T.nextHandler();try{var R=T.done?void 0:T.nextHandler();return u(R,T.done)}catch(x){throw T.done=!0,x}},return:function(){var S=A(this),T=S.iterator;if(S.done=!0,b){var R=c(T,"return");return R?s(R,T):u(void 0,!0)}if(S.inner)try{d(S.inner.iterator,"normal")}catch(x){return d(T,"throw",x)}return T&&d(T,"normal"),u(void 0,!0)}})},y=v(!0),w=v(!1);r(w,f,"Iterator Helper"),i.exports=function(b,A){var S=function(R,x){x?(x.iterator=R.iterator,x.next=R.next):x=R,x.type=A?g:p,x.nextHandler=b,x.counter=0,x.done=!1,m(this,x)};return S.prototype=A?y:w,S}}),713:((i,t,e)=>{var s=e(9565),n=e(9306),r=e(8551),a=e(1767),o=e(9462),l=e(6319),c=o(function(){var h=this.iterator,u=r(s(this.next,h)),d=this.done=!!u.done;if(!d)return l(h,this.mapper,[u.value,this.counter++],!0)});i.exports=function(u){return r(this),n(u),new c(a(this),{mapper:u})}}),7657:((i,t,e)=>{var s=e(9039),n=e(4901),r=e(34),a=e(2360),o=e(2787),l=e(6840),c=e(8227),h=e(6395),u=c("iterator"),d=!1,f,p,g;[].keys&&(g=[].keys(),"next"in g?(p=o(o(g)),p!==Object.prototype&&(f=p)):d=!0);var m=!r(f)||s(function(){var v={};return f[u].call(v)!==v});m?f={}:h&&(f=a(f)),n(f[u])||l(f,u,function(){return this}),i.exports={IteratorPrototype:f,BUGGY_SAFARI_ITERATORS:d}}),6269:(i=>{i.exports={}}),6198:((i,t,e)=>{var s=e(8014);i.exports=function(n){return s(n.length)}}),283:((i,t,e)=>{var s=e(9504),n=e(9039),r=e(4901),a=e(9297),o=e(3724),l=e(350).CONFIGURABLE,c=e(3706),h=e(1181),u=h.enforce,d=h.get,f=String,p=Object.defineProperty,g=s("".slice),m=s("".replace),v=s([].join),y=o&&!n(function(){return p(function(){},"length",{value:8}).length!==8}),w=String(String).split("String"),b=i.exports=function(A,S,T){g(f(S),0,7)==="Symbol("&&(S="["+m(f(S),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),T&&T.getter&&(S="get "+S),T&&T.setter&&(S="set "+S),(!a(A,"name")||l&&A.name!==S)&&(o?p(A,"name",{value:S,configurable:!0}):A.name=S),y&&T&&a(T,"arity")&&A.length!==T.arity&&p(A,"length",{value:T.arity});try{T&&a(T,"constructor")&&T.constructor?o&&p(A,"prototype",{writable:!1}):A.prototype&&(A.prototype=void 0)}catch{}var R=u(A);return a(R,"source")||(R.source=v(w,typeof S=="string"?S:"")),A};Function.prototype.toString=b(function(){return r(this)&&d(this).source||c(this)},"toString")}),741:(i=>{var t=Math.ceil,e=Math.floor;i.exports=Math.trunc||function(n){var r=+n;return(r>0?e:t)(r)}}),6043:((i,t,e)=>{var s=e(9306),n=TypeError,r=function(a){var o,l;this.promise=new a(function(c,h){if(o!==void 0||l!==void 0)throw new n("Bad Promise constructor");o=c,l=h}),this.resolve=s(o),this.reject=s(l)};i.exports.f=function(a){return new r(a)}}),2603:((i,t,e)=>{var s=e(655);i.exports=function(n,r){return n===void 0?arguments.length<2?"":r:s(n)}}),4149:(i=>{var t=RangeError;i.exports=function(e){if(e===e)return e;throw new t("NaN is not allowed")}}),2360:((i,t,e)=>{var s=e(8551),n=e(6801),r=e(8727),a=e(421),o=e(397),l=e(4055),c=e(6119),h=">",u="<",d="prototype",f="script",p=c("IE_PROTO"),g=function(){},m=function(A){return u+f+h+A+u+"/"+f+h},v=function(A){A.write(m("")),A.close();var S=A.parentWindow.Object;return A=null,S},y=function(){var A=l("iframe"),S="java"+f+":",T;return A.style.display="none",o.appendChild(A),A.src=String(S),T=A.contentWindow.document,T.open(),T.write(m("document.F=Object")),T.close(),T.F},w,b=function(){try{w=new ActiveXObject("htmlfile")}catch{}b=typeof document<"u"?document.domain&&w?v(w):y():v(w);for(var A=r.length;A--;)delete b[d][r[A]];return b()};a[p]=!0,i.exports=Object.create||function(S,T){var R;return S!==null?(g[d]=s(S),R=new g,g[d]=null,R[p]=S):R=b(),T===void 0?R:n.f(R,T)}}),6801:((i,t,e)=>{var s=e(3724),n=e(8686),r=e(4913),a=e(8551),o=e(5397),l=e(1072);t.f=s&&!n?Object.defineProperties:function(h,u){a(h);for(var d=o(u),f=l(u),p=f.length,g=0,m;p>g;)r.f(h,m=f[g++],d[m]);return h}}),4913:((i,t,e)=>{var s=e(3724),n=e(5917),r=e(8686),a=e(8551),o=e(6969),l=TypeError,c=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",f="writable";t.f=s?r?function(g,m,v){if(a(g),m=o(m),a(v),typeof g=="function"&&m==="prototype"&&"value"in v&&f in v&&!v[f]){var y=h(g,m);y&&y[f]&&(g[m]=v.value,v={configurable:d in v?v[d]:y[d],enumerable:u in v?v[u]:y[u],writable:!1})}return c(g,m,v)}:c:function(g,m,v){if(a(g),m=o(m),a(v),n)try{return c(g,m,v)}catch{}if("get"in v||"set"in v)throw new l("Accessors not supported");return"value"in v&&(g[m]=v.value),g}}),7347:((i,t,e)=>{var s=e(3724),n=e(9565),r=e(8773),a=e(6980),o=e(5397),l=e(6969),c=e(9297),h=e(5917),u=Object.getOwnPropertyDescriptor;t.f=s?u:function(f,p){if(f=o(f),p=l(p),h)try{return u(f,p)}catch{}if(c(f,p))return a(!n(r.f,f,p),f[p])}}),8480:((i,t,e)=>{var s=e(1828),n=e(8727),r=n.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(o){return s(o,r)}}),3717:((i,t)=>{t.f=Object.getOwnPropertySymbols}),2787:((i,t,e)=>{var s=e(9297),n=e(4901),r=e(8981),a=e(6119),o=e(2211),l=a("IE_PROTO"),c=Object,h=c.prototype;i.exports=o?c.getPrototypeOf:function(u){var d=r(u);if(s(d,l))return d[l];var f=d.constructor;return n(f)&&d instanceof f?f.prototype:d instanceof c?h:null}}),1625:((i,t,e)=>{var s=e(9504);i.exports=s({}.isPrototypeOf)}),1828:((i,t,e)=>{var s=e(9504),n=e(9297),r=e(5397),a=e(9617).indexOf,o=e(421),l=s([].push);i.exports=function(c,h){var u=r(c),d=0,f=[],p;for(p in u)!n(o,p)&&n(u,p)&&l(f,p);for(;h.length>d;)n(u,p=h[d++])&&(~a(f,p)||l(f,p));return f}}),1072:((i,t,e)=>{var s=e(1828),n=e(8727);i.exports=Object.keys||function(a){return s(a,n)}}),8773:((i,t)=>{var e={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,n=s&&!e.call({1:2},1);t.f=n?function(a){var o=s(this,a);return!!o&&o.enumerable}:e}),2967:((i,t,e)=>{var s=e(6706),n=e(34),r=e(7750),a=e(3506);i.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var o=!1,l={},c;try{c=s(Object.prototype,"__proto__","set"),c(l,[]),o=l instanceof Array}catch{}return function(u,d){return r(u),a(d),n(u)&&(o?c(u,d):u.__proto__=d),u}})():void 0)}),4270:((i,t,e)=>{var s=e(9565),n=e(4901),r=e(34),a=TypeError;i.exports=function(o,l){var c,h;if(l==="string"&&n(c=o.toString)&&!r(h=s(c,o))||n(c=o.valueOf)&&!r(h=s(c,o))||l!=="string"&&n(c=o.toString)&&!r(h=s(c,o)))return h;throw new a("Can't convert object to primitive value")}}),5031:((i,t,e)=>{var s=e(7751),n=e(9504),r=e(8480),a=e(3717),o=e(8551),l=n([].concat);i.exports=s("Reflect","ownKeys")||function(h){var u=r.f(o(h)),d=a.f;return d?l(u,d(h)):u}}),8235:((i,t,e)=>{var s=e(9504),n=e(9297),r=SyntaxError,a=parseInt,o=String.fromCharCode,l=s("".charAt),c=s("".slice),h=s(/./.exec),u={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},d=/^[\da-f]{4}$/i,f=/^[\u0000-\u001F]$/;i.exports=function(p,g){for(var m=!0,v="";g<p.length;){var y=l(p,g);if(y==="\\"){var w=c(p,g,g+2);if(n(u,w))v+=u[w],g+=2;else if(w==="\\u"){g+=2;var b=c(p,g,g+4);if(!h(d,b))throw new r("Bad Unicode escape at: "+g);v+=o(a(b,16)),g+=4}else throw new r('Unknown escape sequence: "'+w+'"')}else if(y==='"'){m=!1,g++;break}else{if(h(f,y))throw new r("Bad control character in string literal at: "+g);v+=y,g++}}if(m)throw new r("Unterminated string at: "+g);return{value:v,end:g}}}),1103:(i=>{i.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}}),7750:((i,t,e)=>{var s=e(4117),n=TypeError;i.exports=function(r){if(s(r))throw new n("Can't call method on "+r);return r}}),9286:((i,t,e)=>{var s=e(4402),n=e(8469),r=s.Set,a=s.add;i.exports=function(o){var l=new r;return n(o,function(c){a(l,c)}),l}}),3440:((i,t,e)=>{var s=e(7080),n=e(4402),r=e(9286),a=e(5170),o=e(3789),l=e(8469),c=e(507),h=n.has,u=n.remove;i.exports=function(f){var p=s(this),g=o(f),m=r(p);return a(p)<=g.size?l(p,function(v){g.includes(v)&&u(m,v)}):c(g.getIterator(),function(v){h(p,v)&&u(m,v)}),m}}),4402:((i,t,e)=>{var s=e(9504),n=Set.prototype;i.exports={Set,add:s(n.add),has:s(n.has),remove:s(n.delete),proto:n}}),8750:((i,t,e)=>{var s=e(7080),n=e(4402),r=e(5170),a=e(3789),o=e(8469),l=e(507),c=n.Set,h=n.add,u=n.has;i.exports=function(f){var p=s(this),g=a(f),m=new c;return r(p)>g.size?l(g.getIterator(),function(v){u(p,v)&&h(m,v)}):o(p,function(v){g.includes(v)&&h(m,v)}),m}}),4449:((i,t,e)=>{var s=e(7080),n=e(4402).has,r=e(5170),a=e(3789),o=e(8469),l=e(507),c=e(9539);i.exports=function(u){var d=s(this),f=a(u);if(r(d)<=f.size)return o(d,function(g){if(f.includes(g))return!1},!0)!==!1;var p=f.getIterator();return l(p,function(g){if(n(d,g))return c(p,"normal",!1)})!==!1}}),3838:((i,t,e)=>{var s=e(7080),n=e(5170),r=e(8469),a=e(3789);i.exports=function(l){var c=s(this),h=a(l);return n(c)>h.size?!1:r(c,function(u){if(!h.includes(u))return!1},!0)!==!1}}),8527:((i,t,e)=>{var s=e(7080),n=e(4402).has,r=e(5170),a=e(3789),o=e(507),l=e(9539);i.exports=function(h){var u=s(this),d=a(h);if(r(u)<d.size)return!1;var f=d.getIterator();return o(f,function(p){if(!n(u,p))return l(f,"normal",!1)})!==!1}}),8469:((i,t,e)=>{var s=e(9504),n=e(507),r=e(4402),a=r.Set,o=r.proto,l=s(o.forEach),c=s(o.keys),h=c(new a).next;i.exports=function(u,d,f){return f?n({iterator:c(u),next:h},d):l(u,d)}}),4916:((i,t,e)=>{var s=e(7751),n=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};i.exports=function(r){var a=s("Set");try{new a()[r](n(0));try{return new a()[r](n(-1)),!1}catch{return!0}}catch{return!1}}}),5170:((i,t,e)=>{var s=e(6706),n=e(4402);i.exports=s(n.proto,"size","get")||function(r){return r.size}}),3650:((i,t,e)=>{var s=e(7080),n=e(4402),r=e(9286),a=e(3789),o=e(507),l=n.add,c=n.has,h=n.remove;i.exports=function(d){var f=s(this),p=a(d).getIterator(),g=r(f);return o(p,function(m){c(f,m)?h(g,m):l(g,m)}),g}}),4204:((i,t,e)=>{var s=e(7080),n=e(4402).add,r=e(9286),a=e(3789),o=e(507);i.exports=function(c){var h=s(this),u=a(c).getIterator(),d=r(h);return o(u,function(f){n(d,f)}),d}}),6119:((i,t,e)=>{var s=e(5745),n=e(3392),r=s("keys");i.exports=function(a){return r[a]||(r[a]=n(a))}}),7629:((i,t,e)=>{var s=e(6395),n=e(4576),r=e(9433),a="__core-js_shared__",o=i.exports=n[a]||r(a,{});(o.versions||(o.versions=[])).push({version:"3.39.0",mode:s?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),5745:((i,t,e)=>{var s=e(7629);i.exports=function(n,r){return s[n]||(s[n]=r||{})}}),1548:((i,t,e)=>{var s=e(4576),n=e(9039),r=e(9519),a=e(4215),o=s.structuredClone;i.exports=!!o&&!n(function(){if(a==="DENO"&&r>92||a==="NODE"&&r>94||a==="BROWSER"&&r>97)return!1;var l=new ArrayBuffer(8),c=o(l,{transfer:[l]});return l.byteLength!==0||c.byteLength!==8})}),4495:((i,t,e)=>{var s=e(9519),n=e(9039),r=e(4576),a=r.String;i.exports=!!Object.getOwnPropertySymbols&&!n(function(){var o=Symbol("symbol detection");return!a(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&s&&s<41})}),5610:((i,t,e)=>{var s=e(1291),n=Math.max,r=Math.min;i.exports=function(a,o){var l=s(a);return l<0?n(l+o,0):r(l,o)}}),5854:((i,t,e)=>{var s=e(2777),n=TypeError;i.exports=function(r){var a=s(r,"number");if(typeof a=="number")throw new n("Can't convert number to bigint");return BigInt(a)}}),7696:((i,t,e)=>{var s=e(1291),n=e(8014),r=RangeError;i.exports=function(a){if(a===void 0)return 0;var o=s(a),l=n(o);if(o!==l)throw new r("Wrong length or index");return l}}),5397:((i,t,e)=>{var s=e(7055),n=e(7750);i.exports=function(r){return s(n(r))}}),1291:((i,t,e)=>{var s=e(741);i.exports=function(n){var r=+n;return r!==r||r===0?0:s(r)}}),8014:((i,t,e)=>{var s=e(1291),n=Math.min;i.exports=function(r){var a=s(r);return a>0?n(a,9007199254740991):0}}),8981:((i,t,e)=>{var s=e(7750),n=Object;i.exports=function(r){return n(s(r))}}),9590:((i,t,e)=>{var s=e(1291),n=RangeError;i.exports=function(r){var a=s(r);if(a<0)throw new n("The argument can't be less than 0");return a}}),2777:((i,t,e)=>{var s=e(9565),n=e(34),r=e(757),a=e(5966),o=e(4270),l=e(8227),c=TypeError,h=l("toPrimitive");i.exports=function(u,d){if(!n(u)||r(u))return u;var f=a(u,h),p;if(f){if(d===void 0&&(d="default"),p=s(f,u,d),!n(p)||r(p))return p;throw new c("Can't convert object to primitive value")}return d===void 0&&(d="number"),o(u,d)}}),6969:((i,t,e)=>{var s=e(2777),n=e(757);i.exports=function(r){var a=s(r,"string");return n(a)?a:a+""}}),2140:((i,t,e)=>{var s=e(8227),n=s("toStringTag"),r={};r[n]="z",i.exports=String(r)==="[object z]"}),655:((i,t,e)=>{var s=e(6955),n=String;i.exports=function(r){if(s(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return n(r)}}),6823:(i=>{var t=String;i.exports=function(e){try{return t(e)}catch{return"Object"}}}),3392:((i,t,e)=>{var s=e(9504),n=0,r=Math.random(),a=s(1 .toString);i.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+a(++n+r,36)}}),7040:((i,t,e)=>{var s=e(4495);i.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}),8686:((i,t,e)=>{var s=e(3724),n=e(9039);i.exports=s&&n(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}),2812:(i=>{var t=TypeError;i.exports=function(e,s){if(e<s)throw new t("Not enough arguments");return e}}),8622:((i,t,e)=>{var s=e(4576),n=e(4901),r=s.WeakMap;i.exports=n(r)&&/native code/.test(String(r))}),8227:((i,t,e)=>{var s=e(4576),n=e(5745),r=e(9297),a=e(3392),o=e(4495),l=e(7040),c=s.Symbol,h=n("wks"),u=l?c.for||c:c&&c.withoutSetter||a;i.exports=function(d){return r(h,d)||(h[d]=o&&r(c,d)?c[d]:u("Symbol."+d)),h[d]}}),6573:((i,t,e)=>{var s=e(3724),n=e(2106),r=e(3238),a=ArrayBuffer.prototype;s&&!("detached"in a)&&n(a,"detached",{configurable:!0,get:function(){return r(this)}})}),7936:((i,t,e)=>{var s=e(6518),n=e(5636);n&&s({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return n(this,arguments.length?arguments[0]:void 0,!1)}})}),8100:((i,t,e)=>{var s=e(6518),n=e(5636);n&&s({target:"ArrayBuffer",proto:!0},{transfer:function(){return n(this,arguments.length?arguments[0]:void 0,!0)}})}),4114:((i,t,e)=>{var s=e(6518),n=e(8981),r=e(6198),a=e(4527),o=e(6837),l=e(9039),c=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),h=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},u=c||!h();s({target:"Array",proto:!0,arity:1,forced:u},{push:function(f){var p=n(this),g=r(p),m=arguments.length;o(g+m);for(var v=0;v<m;v++)p[g]=arguments[v],g++;return a(p,g),g}})}),8111:((i,t,e)=>{var s=e(6518),n=e(4576),r=e(679),a=e(8551),o=e(4901),l=e(2787),c=e(2106),h=e(4659),u=e(9039),d=e(9297),f=e(8227),p=e(7657).IteratorPrototype,g=e(3724),m=e(6395),v="constructor",y="Iterator",w=f("toStringTag"),b=TypeError,A=n[y],S=m||!o(A)||A.prototype!==p||!u(function(){A({})}),T=function(){if(r(this,p),l(this)===p)throw new b("Abstract class Iterator not directly constructable")},R=function(x,I){g?c(p,x,{configurable:!0,get:function(){return I},set:function(M){if(a(this),this===p)throw new b("You can't redefine this property");d(this,x)?this[x]=M:h(this,x,M)}}):p[x]=I};d(p,w)||R(w,y),(S||!d(p,v)||p[v]===Object)&&R(v,T),T.prototype=p,s({global:!0,constructor:!0,forced:S},{Iterator:T})}),9314:((i,t,e)=>{var s=e(6518),n=e(9565),r=e(8551),a=e(1767),o=e(4149),l=e(9590),c=e(9462),h=e(6395),u=c(function(){for(var d=this.iterator,f=this.next,p,g;this.remaining;)if(this.remaining--,p=r(n(f,d)),g=this.done=!!p.done,g)return;if(p=r(n(f,d)),g=this.done=!!p.done,!g)return p.value});s({target:"Iterator",proto:!0,real:!0,forced:h},{drop:function(f){r(this);var p=l(o(+f));return new u(a(this),{remaining:p})}})}),1148:((i,t,e)=>{var s=e(6518),n=e(2652),r=e(9306),a=e(8551),o=e(1767);s({target:"Iterator",proto:!0,real:!0},{every:function(c){a(this),r(c);var h=o(this),u=0;return!n(h,function(d,f){if(!c(d,u++))return f()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),2489:((i,t,e)=>{var s=e(6518),n=e(9565),r=e(9306),a=e(8551),o=e(1767),l=e(9462),c=e(6319),h=e(6395),u=l(function(){for(var d=this.iterator,f=this.predicate,p=this.next,g,m,v;;){if(g=a(n(p,d)),m=this.done=!!g.done,m)return;if(v=g.value,c(d,f,[v,this.counter++],!0))return v}});s({target:"Iterator",proto:!0,real:!0,forced:h},{filter:function(f){return a(this),r(f),new u(o(this),{predicate:f})}})}),531:((i,t,e)=>{var s=e(6518),n=e(9565),r=e(9306),a=e(8551),o=e(1767),l=e(8646),c=e(9462),h=e(9539),u=e(6395),d=c(function(){for(var f=this.iterator,p=this.mapper,g,m;;){if(m=this.inner)try{if(g=a(n(m.next,m.iterator)),!g.done)return g.value;this.inner=null}catch(v){h(f,"throw",v)}if(g=a(n(this.next,f)),this.done=!!g.done)return;try{this.inner=l(p(g.value,this.counter++),!1)}catch(v){h(f,"throw",v)}}});s({target:"Iterator",proto:!0,real:!0,forced:u},{flatMap:function(p){return a(this),r(p),new d(o(this),{mapper:p,inner:null})}})}),1701:((i,t,e)=>{var s=e(6518),n=e(713),r=e(6395);s({target:"Iterator",proto:!0,real:!0,forced:r},{map:n})}),3579:((i,t,e)=>{var s=e(6518),n=e(2652),r=e(9306),a=e(8551),o=e(1767);s({target:"Iterator",proto:!0,real:!0},{some:function(c){a(this),r(c);var h=o(this),u=0;return n(h,function(d,f){if(c(d,u++))return f()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),1689:((i,t,e)=>{var s=e(6518),n=e(4576),r=e(8745),a=e(7680),o=e(6043),l=e(9306),c=e(1103),h=n.Promise,u=!1,d=!h||!h.try||c(function(){h.try(function(f){u=f===8},8)}).error||!u;s({target:"Promise",stat:!0,forced:d},{try:function(f){var p=arguments.length>1?a(arguments,1):[],g=o.f(this),m=c(function(){return r(l(f),void 0,p)});return(m.error?g.reject:g.resolve)(m.value),g.promise}})}),4628:((i,t,e)=>{var s=e(6518),n=e(6043);s({target:"Promise",stat:!0},{withResolvers:function(){var a=n.f(this);return{promise:a.promise,resolve:a.resolve,reject:a.reject}}})}),7642:((i,t,e)=>{var s=e(6518),n=e(3440),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("difference")},{difference:n})}),8004:((i,t,e)=>{var s=e(6518),n=e(9039),r=e(8750),a=e(4916),o=!a("intersection")||n(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});s({target:"Set",proto:!0,real:!0,forced:o},{intersection:r})}),3853:((i,t,e)=>{var s=e(6518),n=e(4449),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("isDisjointFrom")},{isDisjointFrom:n})}),5876:((i,t,e)=>{var s=e(6518),n=e(3838),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("isSubsetOf")},{isSubsetOf:n})}),2475:((i,t,e)=>{var s=e(6518),n=e(8527),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("isSupersetOf")},{isSupersetOf:n})}),5024:((i,t,e)=>{var s=e(6518),n=e(3650),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("symmetricDifference")},{symmetricDifference:n})}),1698:((i,t,e)=>{var s=e(6518),n=e(4204),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("union")},{union:n})}),7467:((i,t,e)=>{var s=e(7628),n=e(4644),r=n.aTypedArray,a=n.exportTypedArrayMethod,o=n.getTypedArrayConstructor;a("toReversed",function(){return s(r(this),o(this))})}),4732:((i,t,e)=>{var s=e(4644),n=e(9504),r=e(9306),a=e(5370),o=s.aTypedArray,l=s.getTypedArrayConstructor,c=s.exportTypedArrayMethod,h=n(s.TypedArrayPrototype.sort);c("toSorted",function(d){d!==void 0&&r(d);var f=o(this),p=a(l(f),f);return h(p,d)})}),9577:((i,t,e)=>{var s=e(9928),n=e(4644),r=e(1108),a=e(1291),o=e(5854),l=n.aTypedArray,c=n.getTypedArrayConstructor,h=n.exportTypedArrayMethod,u=!!(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(d){return d===8}})();h("with",function(d,f){var p=l(this),g=a(d),m=r(p)?o(f):+f;return s(p,c(p),g,m)},!u)}),8992:((i,t,e)=>{e(8111)}),4743:((i,t,e)=>{e(9314)}),3215:((i,t,e)=>{e(1148)}),4520:((i,t,e)=>{e(2489)}),670:((i,t,e)=>{e(531)}),1454:((i,t,e)=>{e(1701)}),7550:((i,t,e)=>{e(3579)}),8335:((i,t,e)=>{var s=e(6518),n=e(3724),r=e(4576),a=e(7751),o=e(9504),l=e(9565),c=e(4901),h=e(34),u=e(4376),d=e(9297),f=e(655),p=e(6198),g=e(4659),m=e(9039),v=e(8235),y=e(4495),w=r.JSON,b=r.Number,A=r.SyntaxError,S=w&&w.parse,T=a("Object","keys"),R=Object.getOwnPropertyDescriptor,x=o("".charAt),I=o("".slice),M=o(/./.exec),H=o([].push),B=/^\d$/,W=/^[1-9]$/,et=/^[\d-]$/,F=/^[\t\n\r ]$/,_=0,Y=1,nt=function(N,C){N=f(N);var L=new xt(N,0),K=L.parse(),tt=K.value,z=L.skip(F,K.end);if(z<N.length)throw new A('Unexpected extra character: "'+x(N,z)+'" after the parsed data at: '+z);return c(C)?mt({"":tt},"",C,K):tt},mt=function(N,C,L,K){var tt=N[C],z=K&&tt===K.value,E=z&&typeof K.source=="string"?{source:K.source}:{},P,O,k,D,$;if(h(tt)){var J=u(tt),G=z?K.nodes:J?[]:{};if(J)for(P=G.length,k=p(tt),D=0;D<k;D++)wt(tt,D,mt(tt,""+D,L,D<P?G[D]:void 0));else for(O=T(tt),k=p(O),D=0;D<k;D++)$=O[D],wt(tt,$,mt(tt,$,L,d(G,$)?G[$]:void 0))}return l(L,N,C,tt,E)},wt=function(N,C,L){if(n){var K=R(N,C);if(K&&!K.configurable)return}L===void 0?delete N[C]:g(N,C,L)},rt=function(N,C,L,K){this.value=N,this.end=C,this.source=L,this.nodes=K},xt=function(N,C){this.source=N,this.index=C};xt.prototype={fork:function(N){return new xt(this.source,N)},parse:function(){var N=this.source,C=this.skip(F,this.index),L=this.fork(C),K=x(N,C);if(M(et,K))return L.number();switch(K){case"{":return L.object();case"[":return L.array();case'"':return L.string();case"t":return L.keyword(!0);case"f":return L.keyword(!1);case"n":return L.keyword(null)}throw new A('Unexpected character: "'+K+'" at: '+C)},node:function(N,C,L,K,tt){return new rt(C,K,N?null:I(this.source,L,K),tt)},object:function(){for(var N=this.source,C=this.index+1,L=!1,K={},tt={};C<N.length;){if(C=this.until(['"',"}"],C),x(N,C)==="}"&&!L){C++;break}var z=this.fork(C).string(),E=z.value;C=z.end,C=this.until([":"],C)+1,C=this.skip(F,C),z=this.fork(C).parse(),g(tt,E,z),g(K,E,z.value),C=this.until([",","}"],z.end);var P=x(N,C);if(P===",")L=!0,C++;else if(P==="}"){C++;break}}return this.node(Y,K,this.index,C,tt)},array:function(){for(var N=this.source,C=this.index+1,L=!1,K=[],tt=[];C<N.length;){if(C=this.skip(F,C),x(N,C)==="]"&&!L){C++;break}var z=this.fork(C).parse();if(H(tt,z),H(K,z.value),C=this.until([",","]"],z.end),x(N,C)===",")L=!0,C++;else if(x(N,C)==="]"){C++;break}}return this.node(Y,K,this.index,C,tt)},string:function(){var N=this.index,C=v(this.source,this.index+1);return this.node(_,C.value,N,C.end)},number:function(){var N=this.source,C=this.index,L=C;if(x(N,L)==="-"&&L++,x(N,L)==="0")L++;else if(M(W,x(N,L)))L=this.skip(B,L+1);else throw new A("Failed to parse number at: "+L);if(x(N,L)==="."&&(L=this.skip(B,L+1)),x(N,L)==="e"||x(N,L)==="E"){L++,(x(N,L)==="+"||x(N,L)==="-")&&L++;var K=L;if(L=this.skip(B,L),K===L)throw new A("Failed to parse number's exponent value at: "+L)}return this.node(_,b(I(N,C,L)),C,L)},keyword:function(N){var C=""+N,L=this.index,K=L+C.length;if(I(this.source,L,K)!==C)throw new A("Failed to parse value at: "+L);return this.node(_,N,L,K)},skip:function(N,C){for(var L=this.source;C<L.length&&M(N,x(L,C));C++);return C},until:function(N,C){C=this.skip(F,C);for(var L=x(this.source,C),K=0;K<N.length;K++)if(N[K]===L)return C;throw new A('Unexpected character: "'+L+'" at: '+C)}};var ne=m(function(){var N="9007199254740993",C;return S(N,function(L,K,tt){C=tt.source}),C!==N}),te=y&&!m(function(){return 1/S("-0 	")!==-1/0});s({target:"JSON",stat:!0,forced:ne},{parse:function(C,L){return te&&!c(L)?S(C):nt(C,L)}})}),5247:((i,t,e)=>{e(1689)}),4979:((i,t,e)=>{var s=e(6518),n=e(4576),r=e(7751),a=e(6980),o=e(4913).f,l=e(9297),c=e(679),h=e(3167),u=e(2603),d=e(5002),f=e(8574),p=e(3724),g=e(6395),m="DOMException",v=r("Error"),y=r(m),w=function(){c(this,b);var F=arguments.length,_=u(F<1?void 0:arguments[0]),Y=u(F<2?void 0:arguments[1],"Error"),nt=new y(_,Y),mt=new v(_);return mt.name=m,o(nt,"stack",a(1,f(mt.stack,1))),h(nt,this,w),nt},b=w.prototype=y.prototype,A="stack"in new v(m),S="stack"in new y(1,2),T=y&&p&&Object.getOwnPropertyDescriptor(n,m),R=!!T&&!(T.writable&&T.configurable),x=A&&!R&&!S;s({global:!0,constructor:!0,forced:g||x},{DOMException:x?w:y});var I=r(m),M=I.prototype;if(M.constructor!==I){g||o(M,"constructor",a(1,I));for(var H in d)if(l(d,H)){var B=d[H],W=B.s;l(I,W)||o(I,W,a(6,B.c))}}}),4603:((i,t,e)=>{var s=e(6840),n=e(9504),r=e(655),a=e(2812),o=URLSearchParams,l=o.prototype,c=n(l.append),h=n(l.delete),u=n(l.forEach),d=n([].push),f=new o("a=1&a=2&b=3");f.delete("a",1),f.delete("b",void 0),f+""!="a=2"&&s(l,"delete",function(p){var g=arguments.length,m=g<2?void 0:arguments[1];if(g&&m===void 0)return h(this,p);var v=[];u(this,function(x,I){d(v,{key:I,value:x})}),a(g,1);for(var y=r(p),w=r(m),b=0,A=0,S=!1,T=v.length,R;b<T;)R=v[b++],S||R.key===y?(S=!0,h(this,R.key)):A++;for(;A<T;)R=v[A++],R.key===y&&R.value===w||c(this,R.key,R.value)},{enumerable:!0,unsafe:!0})}),7566:((i,t,e)=>{var s=e(6840),n=e(9504),r=e(655),a=e(2812),o=URLSearchParams,l=o.prototype,c=n(l.getAll),h=n(l.has),u=new o("a=1");(u.has("a",2)||!u.has("a",void 0))&&s(l,"has",function(f){var p=arguments.length,g=p<2?void 0:arguments[1];if(p&&g===void 0)return h(this,f);var m=c(this,f);a(p,1);for(var v=r(g),y=0;y<m.length;)if(m[y++]===v)return!0;return!1},{enumerable:!0,unsafe:!0})}),8721:((i,t,e)=>{var s=e(3724),n=e(9504),r=e(2106),a=URLSearchParams.prototype,o=n(a.forEach);s&&!("size"in a)&&r(a,"size",{get:function(){var c=0;return o(this,function(){c++}),c},configurable:!0,enumerable:!0})})},Ho={};function Ct(i){var t=Ho[i];if(t!==void 0)return t.exports;var e=Ho[i]={exports:{}};return Uf[i].call(e.exports,e,e.exports,Ct),e.exports}Ct.d=(i,t)=>{for(var e in t)Ct.o(t,e)&&!Ct.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:t[e]})};Ct.o=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var dt=globalThis.pdfjsLib={};Ct.d(dt,{AbortException:()=>Rs,AnnotationEditorLayer:()=>Ug,AnnotationEditorParamsType:()=>St,AnnotationEditorType:()=>At,AnnotationEditorUIManager:()=>Kn,AnnotationLayer:()=>jg,AnnotationMode:()=>Ss,ColorPicker:()=>Oh,DOMSVGFactory:()=>Ya,DrawLayer:()=>zg,FeatureTest:()=>ge,GlobalWorkerOptions:()=>Fn,ImageKind:()=>xi,InvalidPDFException:()=>na,MissingPDFException:()=>Xn,OPS:()=>$e,OutputScale:()=>ia,PDFDataRangeTransport:()=>xh,PDFDateString:()=>ih,PDFWorker:()=>Ei,PasswordResponses:()=>Xf,PermissionFlag:()=>Gf,PixelsPerInch:()=>un,RenderingCancelledException:()=>Ba,TextLayer:()=>la,TouchManager:()=>rh,UnexpectedResponseException:()=>_i,Util:()=>st,VerbosityLevel:()=>ir,XfaLayer:()=>Sh,build:()=>yg,createValidAbsoluteUrl:()=>Zf,fetchData:()=>lr,getDocument:()=>cg,getFilenameFromUrl:()=>ap,getPdfFilenameFromUrl:()=>op,getXfaPageViewport:()=>lp,isDataScheme:()=>cr,isPdfFile:()=>Ha,noContextMenu:()=>Ve,normalizeUnicode:()=>np,setLayerDimensions:()=>Vs,shadow:()=>Et,stopEvent:()=>Le,version:()=>vg});Ct(4114);Ct(6573);Ct(8100);Ct(7936);Ct(7467);Ct(4732);Ct(9577);Ct(5247);Ct(4979);Ct(4603);Ct(7566);Ct(8721);const he=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),sh=[1,0,0,1,0,0],sa=[.001,0,0,.001,0,0],zf=1e7,Rr=1.35,Me={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ss={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Wf="pdfjs_internal_editor_",At={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},St={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},Gf={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},re={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},xi={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},yn={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ir={ERRORS:0,WARNINGS:1,INFOS:5},$e={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Xf={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let rr=ir.WARNINGS;function Kf(i){Number.isInteger(i)&&(rr=i)}function Yf(){return rr}function ar(i){rr>=ir.INFOS&&console.log(`Info: ${i}`)}function pt(i){rr>=ir.WARNINGS&&console.log(`Warning: ${i}`)}function _t(i){throw new Error(i)}function Yt(i,t){i||_t(t)}function Jf(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Zf(i,t=null,e=null){if(!i)return null;try{if(e&&typeof i=="string"&&(e.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),e.tryConvertEncoding))try{i=sp(i)}catch{}const s=t?new URL(i,t):new URL(i);if(Jf(s))return s}catch{}return null}function Et(i,t,e,s=!1){return Object.defineProperty(i,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const Ms=(function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Vo extends Ms{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Mr extends Ms{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}let na=class extends Ms{constructor(t){super(t,"InvalidPDFException")}},Xn=class extends Ms{constructor(t){super(t,"MissingPDFException")}},_i=class extends Ms{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}};class Qf extends Ms{constructor(t){super(t,"FormatError")}}let Rs=class extends Ms{constructor(t){super(t,"AbortException")}};function nh(i){(typeof i!="object"||i?.length===void 0)&&_t("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const s=[];for(let n=0;n<t;n+=e){const r=Math.min(n+e,t),a=i.subarray(n,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function or(i){typeof i!="string"&&_t("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=i.charCodeAt(s)&255;return e}function qf(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function ja(i){const t=Object.create(null);for(const[e,s]of i)t[e]=s;return t}function tp(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function ep(){try{return new Function(""),!0}catch{return!1}}class ge{static get isLittleEndian(){return Et(this,"isLittleEndian",tp())}static get isEvalSupported(){return Et(this,"isEvalSupported",ep())}static get isOffscreenCanvasSupported(){return Et(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Et(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Et(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Et(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Et(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Lr=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));let st=class{static makeHexColor(t,e,s){return`#${Lr[t]}${Lr[e]}${Lr[s]}`}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const s=t[0]*e[0]+t[1]*e[2]+e[4],n=t[0]*e[1]+t[1]*e[3]+e[5];return[s,n]}static applyInverseTransform(t,e){const s=e[0]*e[3]-e[1]*e[2],n=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/s,r=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/s;return[n,r]}static getAxialAlignedBoundingBox(t,e){const s=this.applyTransform(t,e),n=this.applyTransform(t.slice(2,4),e),r=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(s[0],n[0],r[0],a[0]),Math.min(s[1],n[1],r[1],a[1]),Math.max(s[0],n[0],r[0],a[0]),Math.max(s[1],n[1],r[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],s=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(s+a)/2,l=Math.sqrt((s+a)**2-4*(s*a-r*n))/2,c=o+l||1,h=o-l||1;return[Math.sqrt(c),Math.sqrt(h)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>n)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[s,r,n,a]}static#t(t,e,s,n,r,a,o,l,c,h){if(c<=0||c>=1)return;const u=1-c,d=c*c,f=d*c,p=u*(u*(u*t+3*c*e)+3*d*s)+f*n,g=u*(u*(u*r+3*c*a)+3*d*o)+f*l;h[0]=Math.min(h[0],p),h[1]=Math.min(h[1],g),h[2]=Math.max(h[2],p),h[3]=Math.max(h[3],g)}static#e(t,e,s,n,r,a,o,l,c,h,u,d){if(Math.abs(c)<1e-12){Math.abs(h)>=1e-12&&this.#t(t,e,s,n,r,a,o,l,-u/h,d);return}const f=h**2-4*u*c;if(f<0)return;const p=Math.sqrt(f),g=2*c;this.#t(t,e,s,n,r,a,o,l,(-h+p)/g,d),this.#t(t,e,s,n,r,a,o,l,(-h-p)/g,d)}static bezierBoundingBox(t,e,s,n,r,a,o,l,c){return c?(c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,l),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,l)):c=[Math.min(t,o),Math.min(e,l),Math.max(t,o),Math.max(e,l)],this.#e(t,s,r,o,e,n,a,l,3*(-t+3*(s-r)+o),6*(t-2*s+r),3*(s-t),c),this.#e(t,s,r,o,e,n,a,l,3*(-e+3*(n-a)+l),6*(e-2*n+a),3*(n-e),c),c}};function sp(i){return decodeURIComponent(escape(i))}let Or=null,Uo=null;function np(i){return Or||(Or=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Uo=new Map([["","t"]])),i.replaceAll(Or,(t,e,s)=>e?e.normalize("NFKC"):Uo.get(s))}function ip(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),nh(i)}const $a="pdfjs_internal_id_";function rp(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(nh(i))}Ct(4628);Ct(7642);Ct(8004);Ct(3853);Ct(5876);Ct(2475);Ct(5024);Ct(1698);Ct(1454);Ct(8992);Ct(4743);Ct(3215);Ct(7550);Ct(8335);const rs="http://www.w3.org/2000/svg";let un=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};async function lr(i,t="text"){if(Pn(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class ti{constructor({viewBox:t,userUnit:e,scale:s,rotation:n,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=n,this.offsetX=r,this.offsetY=a,s*=e;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let h,u,d,f;switch(n%=360,n<0&&(n+=360),n){case 180:h=-1,u=0,d=0,f=1;break;case 90:h=0,u=1,d=1,f=0;break;case 270:h=0,u=-1,d=-1,f=0;break;case 0:h=1,u=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(d=-d,f=-f);let p,g,m,v;h===0?(p=Math.abs(c-t[1])*s+r,g=Math.abs(l-t[0])*s+a,m=(t[3]-t[1])*s,v=(t[2]-t[0])*s):(p=Math.abs(l-t[0])*s+r,g=Math.abs(c-t[1])*s+a,m=(t[2]-t[0])*s,v=(t[3]-t[1])*s),this.transform=[h*s,u*s,d*s,f*s,p-h*s*l-d*s*c,g-u*s*l-f*s*c],this.width=m,this.height=v}get rawDims(){const{userUnit:t,viewBox:e}=this,s=e.map(n=>n*t);return Et(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:r=!1}={}){return new ti({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:r})}convertToViewportPoint(t,e){return st.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=st.applyTransform([t[0],t[1]],this.transform),s=st.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){return st.applyInverseTransform([t,e],this.transform)}}let Ba=class extends Ms{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}};function cr(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function Ha(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function ap(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function op(i,t="document.pdf"){if(typeof i!="string")return t;if(cr(i))return pt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=e.exec(i);let r=s.exec(n[1])||s.exec(n[2])||s.exec(n[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||t}class zo{started=Object.create(null);times=[];time(t){t in this.started&&pt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||pt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:n,end:r}of this.times)t.push(`${s.padEnd(e)} ${r-n}ms
`);return t.join("")}}function Pn(i,t){try{const{protocol:e}=t?new URL(i,t):new URL(i);return e==="http:"||e==="https:"}catch{return!1}}function Ve(i){i.preventDefault()}function Le(i){i.preventDefault(),i.stopPropagation()}let ih=class{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const s=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const c=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let u=parseInt(e[9],10)||0;return u=u>=0&&u<=59?u:0,c==="-"?(a+=h,o+=u):c==="+"&&(a-=h,o-=u),new Date(Date.UTC(s,n,r,a,o,l))}};function lp(i,{scale:t=1,rotation:e=0}){const{width:s,height:n}=i.attributes.style,r=[0,0,parseInt(s),parseInt(n)];return new ti({viewBox:r,userUnit:1,scale:t,rotation:e})}function Va(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(pt(`Not a valid color format: "${i}"`),[0,0,0])}function cp(i){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of i.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;i.set(e,Va(s))}t.remove()}function $t(i){const{a:t,b:e,c:s,d:n,e:r,f:a}=i.getTransform();return[t,e,s,n,r,a]}function Xe(i){const{a:t,b:e,c:s,d:n,e:r,f:a}=i.getTransform().invertSelf();return[t,e,s,n,r,a]}function Vs(i,t,e=!1,s=!0){if(t instanceof ti){const{pageWidth:n,pageHeight:r}=t.rawDims,{style:a}=i,o=ge.isCSSRoundSupported,l=`var(--scale-factor) * ${n}px`,c=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,u=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!e||t.rotation%180===0?(a.width=h,a.height=u):(a.width=u,a.height=h)}s&&i.setAttribute("data-main-rotation",t.rotation)}let ia=class{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}};class _n{#t=null;#e=null;#s;#n=null;#r=null;static#i=null;constructor(t){this.#s=t,_n.#i||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#s._uiManager._signal;t.addEventListener("contextmenu",Ve,{signal:e}),t.addEventListener("pointerdown",_n.#a,{signal:e});const s=this.#n=document.createElement("div");s.className="buttons",t.append(s);const n=this.#s.toolbarPosition;if(n){const{style:r}=t,a=this.#s._uiManager.direction==="ltr"?1-n[0]:n[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),t}get div(){return this.#t}static#a(t){t.stopPropagation()}#l(t){this.#s._focusEventsAllowed=!1,Le(t)}#h(t){this.#s._focusEventsAllowed=!0,Le(t)}#c(t){const e=this.#s._uiManager._signal;t.addEventListener("focusin",this.#l.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ve,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown()}#d(){const{editorType:t,_uiManager:e}=this.#s,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",_n.#i[t]),this.#c(s),s.addEventListener("click",n=>{e.delete()},{signal:e._signal}),this.#n.append(s)}get#u(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#c(e),this.#n.prepend(e,this.#u),this.#r=t}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#c(e),this.#n.prepend(e,this.#u)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class hp{#t=null;#e=null;#s;constructor(t){this.#s=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ve,{signal:this.#s._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#i(),t}#r(t,e){let s=0,n=0;for(const r of t){const a=r.y+r.height;if(a<s)continue;const o=r.x+(e?r.width:0);if(a>s){n=o,s=a;continue}e?o>n&&(n=o):o<n&&(n=o)}return[e?1-n:n,s]}show(t,e,s){const[n,r]=this.#r(e,s),{style:a}=this.#e||=this.#n();t.append(this.#e),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#i(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#s._signal;t.addEventListener("contextmenu",Ve,{signal:s}),t.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:s}),this.#t.append(t)}}function Fi(i,t,e){for(const s of e)t.addEventListener(s,i[s].bind(i))}class up{#t=0;get id(){return`${Wf}${this.#t++}`}}class Ua{#t=ip();#e=0;#s=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const r=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Et(this,"_isSVGFittingCanvas",r)}async#n(t,e){this.#s||=new Map;let s=this.#s.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let n;if(typeof e=="string"?(s.url=e,n=await lr(e,"blob")):e instanceof File?n=s.file=e:e instanceof Blob&&(n=e),n.type==="image/svg+xml"){const r=Ua._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,c()},a.onload=async()=>{const u=s.svgUrl=a.result;o.src=await r?`${u}#svgView(preserveAspectRatio(none))`:u},o.onerror=a.onerror=h});a.readAsDataURL(n),await l}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){pt(n),s=null}return this.#s.set(t,s),s&&this.#s.set(s.id,s),s}async getFromFile(t){const{lastModified:e,name:s,size:n,type:r}=t;return this.#n(`${e}_${s}_${n}_${r}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const s=await e;return this.#n(t,s)}async getFromId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#s||=new Map;let s=this.#s.get(t);if(s?.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#s.set(t,s),this.#s.set(s.id,s),s}getSvgUrl(t){const e=this.#s.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#s||=new Map;const e=this.#s.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const n=new OffscreenCanvas(s.width,s.height);n.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=n.convertToBlob()}s.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class dp{#t=[];#e=!1;#s;#n=-1;constructor(t=128){this.#s=t}add({cmd:t,undo:e,post:s,mustExec:n,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(n&&t(),this.#e)return;const l={cmd:t,undo:e,post:s,type:r};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(l);return}if(a&&this.#t[this.#n].type===r){o&&(l.undo=this.#t[this.#n].undo),this.#t[this.#n]=l;return}const c=this.#n+1;c===this.#s?this.#t.splice(0,1):(this.#n=c,c<this.#t.length&&this.#t.splice(c)),this.#t.push(l)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class ei{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ge.platform;for(const[s,n,r={}]of t)for(const a of s){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(this.#t(e));if(!s)return;const{callback:n,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(t,e)||(n.bind(t,...a,e)(),r||Le(e))}}class za{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return cp(t),Et(this,"_colors",t)}convert(t){const e=Va(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,n]of this._colors)if(n.every((r,a)=>r===e[a]))return za._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?st.makeHexColor(...e):t}}let Kn=class ra{#t=new AbortController;#e=null;#s=new Map;#n=new Map;#r=null;#i=null;#a=null;#l=new dp;#h=null;#c=null;#d=0;#u=new Set;#f=null;#o=null;#p=new Set;_editorUndoBar=null;#m=!1;#g=!1;#v=!1;#y=null;#b=null;#A=null;#x=null;#S=!1;#T=null;#R=new up;#E=!1;#I=!1;#P=null;#L=null;#O=null;#_=null;#C=At.NONE;#w=new Set;#F=null;#N=null;#B=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#$=[0,0];#k=null;#j=null;#z=null;#M=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=ra.prototype,e=a=>a.#j.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Et(this,"_keyboardManager",new ei([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#j.contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&a.#j.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,s,n,r,a,o,l,c,h,u,d,f){const p=this._signal=this.#t.signal;this.#j=t,this.#z=e,this.#r=s,this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:p}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),n._on("setpreference",this.onSetPreference.bind(this),{signal:p}),n._on("switchannotationeditorparams",g=>this.updateParams(g.type,g.value),{signal:p}),this.#et(),this.#rt(),this.#K(),this.#i=r.annotationStorage,this.#y=r.filterFactory,this.#N=a,this.#x=o||null,this.#m=l,this.#g=c,this.#v=h,this.#_=u||null,this.viewParameters={realScale:un.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=d||null,this._supportsPinchToZoom=f!==!1}destroy(){this.#M?.resolve(),this.#M=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#n.values())t.destroy();this.#n.clear(),this.#s.clear(),this.#p.clear(),this.#e=null,this.#w.clear(),this.#l.destroy(),this.#r?.destroy(),this.#T?.hide(),this.#T=null,this.#b&&(clearTimeout(this.#b),this.#b=null),this.#k&&(clearTimeout(this.#k),this.#k=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#_}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Et(this,"hcmFilter",this.#N?this.#y.addHCMFilter(this.#N.foreground,this.#N.background):"none")}get direction(){return Et(this,"direction",getComputedStyle(this.#j).direction)}get highlightColors(){return Et(this,"highlightColors",this.#x?new Map(this.#x.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Et(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#O=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#v=e)}onPageChanging({pageNumber:t}){this.#d=t-1}focusMainContainer(){this.#j.focus()}findParent(t,e){for(const s of this.#n.values()){const{x:n,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(t>=n&&t<=n+a&&e>=r&&e<=r+o)return s}return null}disableUserSelect(t=!1){this.#z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*un.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#H({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#X(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of this.#n.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:s,anchorOffset:n,focusNode:r,focusOffset:a}=e,o=e.toString(),c=this.#H(e).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;e.empty();const u=this.#X(c),d=this.#C===At.NONE,f=()=>{u?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:s,anchorOffset:n,focusNode:r,focusOffset:a,text:o}),d&&this.showAllEditors("highlight",!0,!0)};if(d){this.switchToMode(At.HIGHLIGHT,f);return}f()}#q(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#H(t).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(this.#T||=new hp(this),this.#T.show(s,n,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#i&&!this.#i.has(t.id)&&this.#i.setValue(t.id,t)}#tt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#F&&(this.#T?.hide(),this.#F=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#F)return;const n=this.#H(t).closest(".textLayer");if(!n){this.#F&&(this.#T?.hide(),this.#F=null,this.#D({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#F=e,this.#D({hasSelectedText:!0}),!(this.#C!==At.HIGHLIGHT&&this.#C!==At.NONE)&&(this.#C===At.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const r=this.#C===At.HIGHLIGHT?this.#X(n):null;r?.toggleDrawing();const a=new AbortController,o=this.combinedSignal(a),l=c=>{c.type==="pointerup"&&c.button!==0||(a.abort(),r?.toggleDrawing(!0),c.type==="pointerup"&&this.#G("main_toolbar"))};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}}#G(t=""){this.#C===At.HIGHLIGHT?this.highlightSelection(t):this.#m&&this.#q()}#et(){document.addEventListener("selectionchange",this.#tt.bind(this),{signal:this._signal})}#st(){if(this.#A)return;this.#A=new AbortController;const t=this.combinedSignal(this.#A);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#nt(){this.#A?.abort(),this.#A=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#G("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#w)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#K(){if(this.#P)return;this.#P=new AbortController;const t=this.combinedSignal(this.#P);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#it(){this.#P?.abort(),this.#P=null}#Y(){if(this.#h)return;this.#h=new AbortController;const t=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#J(){this.#h?.abort(),this.#h=null}#rt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#K(),this.#Y()}removeEditListeners(){this.#it(),this.#J()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of this.#o)if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of this.#o)if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of this.#w){const n=s.serialize(!0);n&&e.push(n)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const a of this.#o)if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){pt(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const r=[];for(const l of s){const c=await n.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)this.#Z(l);this.#Q(r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){pt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==At.NONE&&!this.isEditorHandlingKeyboard&&ra._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#G("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#D(t){Object.entries(t).some(([s,n])=>this.#U[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,t)}),this.#C===At.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#V([[St.HIGHLIGHT_FREE,!0]]))}#V(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#st(),this.#Y(),this.#D({isEditing:this.#C!==At.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#nt(),this.#J(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#o){this.#o=t;for(const e of this.#o)this.#V(e.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#n.get(this.#d)}getLayer(t){return this.#n.get(t)}get currentPageIndex(){return this.#d}addLayer(t){this.#n.set(t.pageIndex,t),this.#E?t.enable():t.disable()}removeLayer(t){this.#n.delete(t.pageIndex)}async updateMode(t,e=null,s=!1){if(this.#C!==t&&!(this.#M&&(await this.#M.promise,!this.#M))){if(this.#M=Promise.withResolvers(),this.#C=t,t===At.NONE){this.setEditingState(!1),this.#ot(),this._editorUndoBar?.hide(),this.#M.resolve();return}this.setEditingState(!0),await this.#at(),this.unselectAll();for(const n of this.#n.values())n.updateMode(t);if(!e){s&&this.addNewEditorFromKeyboard(),this.#M.resolve();return}for(const n of this.#s.values())n.annotationElementId===e?(this.setSelected(n),n.enterInEditMode()):n.unselect();this.#M.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#o){switch(t){case St.CREATE:this.currentLayer.addNewEditor();return;case St.HIGHLIGHT_DEFAULT_COLOR:this.#O?.updateColor(e);break;case St.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#B||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const s of this.#w)s.updateParams(t,e);for(const s of this.#o)s.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){for(const r of this.#s.values())r.editorType===t&&r.show(e);(this.#B?.get(St.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#V([[St.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#I!==t){this.#I=t;for(const e of this.#n.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#at(){if(!this.#E){this.#E=!0;const t=[];for(const e of this.#n.values())t.push(e.enable());await Promise.all(t);for(const e of this.#s.values())e.enable()}}#ot(){if(this.unselectAll(),this.#E){this.#E=!1;for(const t of this.#n.values())t.disable();for(const t of this.#s.values())t.disable()}}getEditors(t){const e=[];for(const s of this.#s.values())s.pageIndex===t&&e.push(s);return e}getEditor(t){return this.#s.get(t)}addEditor(t){this.#s.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.focusMainContainer(),this.#b=null},0)),this.#s.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#u.has(t.annotationElementId))&&this.#i?.remove(t.id)}addDeletedAnnotationElement(t){this.#u.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#u.has(t)}removeDeletedAnnotationElement(t){this.#u.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Z(t){const e=this.#n.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#V(t.propertiesToUpdate))}get#lt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#lt===t&&this.#V(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#V(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#V(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(const e of this.#w)e!==t&&e.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#V(t.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#D({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#l.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#l.add(t),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#l.cleanType(t)}#W(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const t of this.#s.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#w],s=()=>{this._editorUndoBar?.show(n,e.length===1?e[0].editorType:e.length);for(const r of e)r.remove()},n=()=>{for(const r of e)this.#Z(r)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#Q(t){for(const e of this.#w)e.unselect();this.#w.clear();for(const e of t)e.isEmpty()||(this.#w.add(e),e.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#Q(this.#s.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==At.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#$[0]+=t,this.#$[1]+=e;const[n,r]=this.#$,a=[...this.#w],o=1e3;this.#k&&clearTimeout(this.#k),this.#k=setTimeout(()=>{this.#k=null,this.#$[0]=this.#$[1]=0,this.addCommands({cmd:()=>{for(const l of a)this.#s.has(l.id)&&l.translateInPage(n,r)},undo:()=>{for(const l of a)this.#s.has(l.id)&&l.translateInPage(-n,-r)},mustExec:!1})},o);for(const l of a)l.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const t of this.#w)this.#f.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const t=this.#f;this.#f=null;let e=!1;for(const[{x:n,y:r,pageIndex:a},o]of t)o.newX=n,o.newY=r,o.newPageIndex=a,e||=n!==o.savedX||r!==o.savedY||a!==o.savedPageIndex;if(!e)return!1;const s=(n,r,a,o)=>{if(this.#s.has(n.id)){const l=this.#n.get(o);l?n._setParentAndPosition(l,r,a):(n.pageIndex=o,n.x=r,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:r,newY:a,newPageIndex:o}]of t)s(n,r,a,o)},undo:()=>{for(const[n,{savedX:r,savedY:a,savedPageIndex:o}]of t)s(n,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#f)for(const s of this.#f.keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}get imageManager(){return Et(this,"imageManager",new Ua)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,h=e.rangeCount;c<h;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:n,width:r,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,h,u,d)=>({x:(h-n)/a,y:1-(c+u-s)/r,width:d/a,height:u/r});break;case"180":o=(c,h,u,d)=>({x:1-(c+u-s)/r,y:1-(h+d-n)/a,width:u/r,height:d/a});break;case"270":o=(c,h,u,d)=>({x:1-(h+d-n)/a,y:(c-s)/r,width:d/a,height:u/r});break;default:o=(c,h,u,d)=>({x:(c-s)/r,y:(h-n)/a,width:u/r,height:d/a});break}const l=[];for(let c=0,h=e.rangeCount;c<h;c++){const u=e.getRangeAt(c);if(!u.collapsed)for(const{x:d,y:f,width:p,height:g}of u.getClientRects())p===0||g===0||l.push(o(d,f,p,g))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#a||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#a?.delete(t)}renderAnnotationElement(t){const e=this.#a?.get(t.data.id);if(!e)return;const s=this.#i.getRawValue(e);s&&(this.#C===At.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}};class Qe{#t=null;#e=!1;#s=null;#n=null;#r=null;#i=null;#a=!1;#l=null;#h=null;#c=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(t){this.#h=t,this.#u=t._uiManager.useNewAltTextFlow,Qe.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Qe._l10n??=t}async render(){const t=this.#s=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",Qe.#f.missing),e.setAttribute("data-l10n-id",Qe.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#h._uiManager._signal;t.addEventListener("contextmenu",Ve,{signal:s}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const n=r=>{r.preventDefault(),this.#h._uiManager.editAltText(this.#h),this.#u&&this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#o}})};return t.addEventListener("click",n,{capture:!0,signal:s}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#a=!0,n(r))},{signal:s}),await this.#p(),t}get#o(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#d=await Qe._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#l?.remove(),this.#l=null;return}if(!this.#l){const e=this.#l=document.createElement("div");e.className="noAltTextBadge",this.#h.div.append(e)}this.#l.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:n,cancel:r=!1}){s&&(this.#c=s,this.#d=n),!(this.#t===t&&this.#e===e)&&(r||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#s&&(!t&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#s.disabled=!t)}shown(){this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#o}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#r=null,this.#l?.remove(),this.#l=null}async#p(){const t=this.#s;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Qe.#f[this.#o]),this.#n?.setAttribute("data-l10n-id",Qe.#f[`${this.#o}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#h.id}`;const n=100,r=this.#h._uiManager._signal;r.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#r.classList.add("show"),this.#h._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:r}),t.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#r?.classList.remove("show")},{signal:r})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#h.getImageForAltText()?.setAttribute("aria-describedby",e.id)}}let rh=class ah{#t;#e=!1;#s=null;#n;#r;#i;#a;#l;#h=null;#c;#d=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:n=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){this.#t=t,this.#s=s,this.#n=e,this.#r=n,this.#i=r,this.#a=a,this.#c=new AbortController,this.#l=AbortSignal.any([o,this.#c.signal]),t.addEventListener("touchstart",this.#u.bind(this),{passive:!1,signal:this.#l})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Et(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#u(t){if(this.#n?.()||t.touches.length<2)return;if(!this.#d){this.#d=new AbortController;const n=AbortSignal.any([this.#l,this.#d.signal]),r=this.#t,a={signal:n,passive:!1};r.addEventListener("touchmove",this.#f.bind(this),a),r.addEventListener("touchend",this.#o.bind(this),a),r.addEventListener("touchcancel",this.#o.bind(this),a),this.#r?.()}if(Le(t),t.touches.length!==2||this.#s?.()){this.#h=null;return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),this.#h={touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#f(t){if(!this.#h||t.touches.length!==2)return;let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:n,screenY:r}=e,{screenX:a,screenY:o}=s,l=this.#h,{touch0X:c,touch0Y:h,touch1X:u,touch1Y:d}=l,f=u-c,p=d-h,g=a-n,m=o-r,v=Math.hypot(g,m)||1,y=Math.hypot(f,p)||1;if(!this.#e&&Math.abs(y-v)<=ah.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=n,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,t.preventDefault(),!this.#e){this.#e=!0;return}const w=[(n+a)/2,(r+o)/2];this.#i?.(w,y,v)}#o(t){this.#d.abort(),this.#d=null,this.#a?.(),this.#h&&(t.preventDefault(),this.#h=null,this.#e=!1)}destroy(){this.#c?.abort(),this.#c=null}};class lt{#t=null;#e=null;#s=null;#n=!1;#r=null;#i="";#a=!1;#l=null;#h=null;#c=null;#d=null;#u="";#f=!1;#o=null;#p=!1;#m=!1;#g=!1;#v=null;#y=0;#b=0;#A=null;#x=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#T=lt._zIndex++;static _borderLineWidth=-1;static _colorManager=new za;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=lt.prototype._resizeWithKeyboard,e=Kn.TRANSLATE_SMALL,s=Kn.TRANSLATE_BIG;return Et(this,"_resizerKeyboardManager",new ei([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],lt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:s,pageHeight:n,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=t.x/o,this.y=t.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Et(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new fp({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(lt._l10n??=t,lt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),lt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);lt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){_t("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#H(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,n){const[r,a]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(t+s)/r,this.y=(e+n)/a,this.fixAndSetPosition()}#R([t,e],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#R(this.parentDimensions,t,e)}translateInPage(t,e){this.#o||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#o||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[n,r]}=this;if(this.x+=t/n,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:u,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#o&&(this.#o[0]!==this.x||this.#o[1]!==this.y)}get _hasBeenResized(){return!!this.#o&&(this.#o[2]!==this.width||this.#o[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=lt,n=s/t,r=s/e;switch(this.rotation){case 90:return[-n,r];case 180:return[n,r];case 270:return[n,-r];default:return[-n,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,n]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=s,l*=n,r*=s,a*=n,this._mustFixPosition)switch(t){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(n-l,a));break;case 90:r=Math.max(0,Math.min(s-l,r)),a=Math.min(n,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(n,Math.max(l,a));break;case 270:r=Math.min(s,Math.max(l,r)),a=Math.max(0,Math.min(n-o,a));break}this.x=r/=s,this.y=a/=n;const[c,h]=this.getBaseTranslation();r+=c,a+=h,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#E(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return lt.#E(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return lt.#E(t,e,360-this.parentRotation)}#I(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(t,e){const[s,n]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*t/s).toFixed(2)}%`,this.#a||(r.height=`${(100*e/n).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:s}=t,n=s.endsWith("%"),r=!this.#a&&e.endsWith("%");if(n&&r)return;const[a,o]=this.parentDimensions;n||(t.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!this.#a&&!r&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#P(){if(this.#l)return;this.#l=document.createElement("div"),this.#l.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const n=document.createElement("div");this.#l.append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",this.#L.bind(this,s),{signal:e}),n.addEventListener("contextmenu",Ve,{signal:e}),n.tabIndex=-1}this.div.prepend(this.#l)}#L(t,e){e.preventDefault();const{isMac:s}=ge.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#s?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#h=[e.screenX,e.screenY];const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#C.bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Le,{passive:!1,signal:a}),window.addEventListener("contextmenu",Ve,{signal:a}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const c=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=o,this.div.style.cursor=l,this.#_()};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})}#O(t,e,s,n){this.width=s,this.height=n,this.x=t,this.y=e;const[r,a]=this.parentDimensions;this.setDims(r*s,a*n),this.fixAndSetPosition(),this._onResized()}_onResized(){}#_(){if(!this.#c)return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:n}=this.#c;this.#c=null;const r=this.x,a=this.y,o=this.width,l=this.height;r===t&&a===e&&o===s&&l===n||this.addCommands({cmd:this.#O.bind(this,r,a,o,l),undo:this.#O.bind(this,t,e,s,n),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#C(t,e){const[s,n]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,c=lt.MIN_SIZE/s,h=lt.MIN_SIZE/n,u=this.#I(this.rotation),d=(F,_)=>[u[0]*F+u[2]*_,u[1]*F+u[3]*_],f=this.#I(360-this.rotation),p=(F,_)=>[f[0]*F+f[2]*_,f[1]*F+f[3]*_];let g,m,v=!1,y=!1;switch(t){case"topLeft":v=!0,g=(F,_)=>[0,0],m=(F,_)=>[F,_];break;case"topMiddle":g=(F,_)=>[F/2,0],m=(F,_)=>[F/2,_];break;case"topRight":v=!0,g=(F,_)=>[F,0],m=(F,_)=>[0,_];break;case"middleRight":y=!0,g=(F,_)=>[F,_/2],m=(F,_)=>[0,_/2];break;case"bottomRight":v=!0,g=(F,_)=>[F,_],m=(F,_)=>[0,0];break;case"bottomMiddle":g=(F,_)=>[F/2,_],m=(F,_)=>[F/2,0];break;case"bottomLeft":v=!0,g=(F,_)=>[0,_],m=(F,_)=>[F,0];break;case"middleLeft":y=!0,g=(F,_)=>[0,_/2],m=(F,_)=>[F,_/2];break}const w=g(o,l),b=m(o,l);let A=d(...b);const S=lt._round(r+A[0]),T=lt._round(a+A[1]);let R=1,x=1,I,M;if(e.fromKeyboard)({deltaX:I,deltaY:M}=e);else{const{screenX:F,screenY:_}=e,[Y,nt]=this.#h;[I,M]=this.screenToPageTranslation(F-Y,_-nt),this.#h[0]=F,this.#h[1]=_}if([I,M]=p(I/s,M/n),v){const F=Math.hypot(o,l);R=x=Math.max(Math.min(Math.hypot(b[0]-w[0]-I,b[1]-w[1]-M)/F,1/o,1/l),c/o,h/l)}else y?R=Math.max(c,Math.min(1,Math.abs(b[0]-w[0]-I)))/o:x=Math.max(h,Math.min(1,Math.abs(b[1]-w[1]-M)))/l;const H=lt._round(o*R),B=lt._round(l*x);A=d(...m(H,B));const W=S-A[0],et=T-A[1];this.#o||=[this.x,this.y,this.width,this.height],this.width=H,this.height=B,this.x=W,this.y=et,this.setDims(s*H,n*B),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}async addEditToolbar(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new _n(this),this.div.append(this._editToolbar.render()),this.#s&&await this._editToolbar.addAltText(this.#s),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#s||(Qe.initialize(lt._l10n),this.#s=new Qe(this),this.#t&&(this.#s.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#s?.data}set altTextData(t){this.#s&&(this.#s.data=t)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(t){await this.#s?.setGuessedText(t)}serializeAltText(t){return this.#s?.serialize(t)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#n?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#$();const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[s,n]=this.getInitialTranslation();return this.translate(s,n),Fi(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#x||=new rh({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#w.bind(this),onPinching:this.#F.bind(this),onPinchEnd:this.#N.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#w(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#F(t,e,s){let r=.7*(s/e)+1-.7;if(r===1)return;const a=this.#I(this.rotation),o=(S,T)=>[a[0]*S+a[2]*T,a[1]*S+a[3]*T],[l,c]=this.parentDimensions,h=this.x,u=this.y,d=this.width,f=this.height,p=lt.MIN_SIZE/l,g=lt.MIN_SIZE/c;r=Math.max(Math.min(r,1/d,1/f),p/d,g/f);const m=lt._round(d*r),v=lt._round(f*r);if(m===d&&v===f)return;this.#o||=[h,u,d,f];const y=o(d/2,f/2),w=lt._round(h+y[0]),b=lt._round(u+y[1]),A=o(m/2,v/2);this.x=w-A[0],this.y=b-A[1],this.width=m,this.height=v,this.setDims(l*m,c*v),this.fixAndSetPosition(),this._onResizing()}#N(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#_()}pointerdown(t){const{isMac:e}=ge.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#U(t);return}this.#B(t)}get isSelected(){return this._uiManager.isSelected(this)}#B(t){const{isMac:e}=ge.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const n=new AbortController,r=this._uiManager.combinedSignal(n),a={capture:!0,passive:!1,signal:r},o=c=>{n.abort(),this.#r=null,this.#f=!1,this._uiManager.endDragSession()||this.#B(c),s&&this._onStopDragging()};e&&(this.#y=t.clientX,this.#b=t.clientY,this.#r=t.pointerId,this.#i=t.pointerType,window.addEventListener("pointermove",c=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:u,pointerId:d}=c;if(d!==this.#r){Le(c);return}const[f,p]=this.screenToPageTranslation(h-this.#y,u-this.#b);this.#y=h,this.#b=u,this._uiManager.dragSelectedEditors(f,p)},a),window.addEventListener("touchmove",Le,a),window.addEventListener("pointerdown",c=>{c.pointerType===this.#i&&(this.#x||c.isPrimary)&&o(c),Le(c)},a));const l=c=>{if(!this.#r||this.#r===c.pointerId){o(c);return}Le(c)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const n=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=t/n,h=e/n,u=this.x*r,d=this.y*a,f=this.width*r,p=this.height*a;switch(s){case 0:return[u+c+o,a-d-h-p+l,u+c+f+o,a-d-h+l];case 90:return[u+h+o,a-d+c+l,u+h+p+o,a-d+c+f+l];case 180:return[u-c-f+o,a-d+h+l,u-c+o,a-d+h+p+l];case 270:return[u-h-p+o,a-d-c-f+l,u-h+o,a-d-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,n,r,a]=t,o=r-s,l=a-n;switch(this.rotation){case 0:return[s,e-a,o,l];case 90:return[s,e-n,l,o];case 180:return[r,e-n,o,l];case 270:return[r,e-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){this.#m=!0}disableEditMode(){this.#m=!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return e<a&&n>0&&t<r&&s>0}#$(){if(this.#d||!this.div)return;this.#d=new AbortController;const t=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#$()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){_t("An editor must be serializable")}static async deserialize(t,e,s){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s});n.rotation=t.rotation,n.#t=t.accessibilityData;const[r,a]=n.pageDimensions,[o,l,c,h]=n.getRectInCurrentCoords(t.rect,a);return n.x=o/r,n.y=l/a,n.width=c/r,n.height=h/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#H(),this.removeEditToolbar(),this.#A){for(const t of this.#A.values())clearTimeout(t);this.#A=null}this.parent=null,this.#x?.destroy(),this.#x=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#l.classList.remove("hidden"),Fi(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#l.children;if(!this.#e){this.#e=Array.from(e);const a=this.#k.bind(this),o=this.#j.bind(this),l=this._uiManager._signal;for(const c of this.#e){const h=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",this.#z.bind(this,h),{signal:l}),c.setAttribute("data-l10n-id",lt._l10nResizer[h])}}const s=this.#e[0];let n=0;for(const a of e){if(a===s)break;n++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(r!==n){if(r<n)for(let o=0;o<n-r;o++)this.#l.append(this.#l.firstChild);else if(r>n)for(let o=0;o<r-n;o++)this.#l.firstChild.before(this.#l.lastChild);let a=0;for(const o of e){const c=this.#e[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",lt._l10nResizer[c])}}this.#M(0),this.#g=!0,this.#l.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#k(t){lt._resizerKeyboardManager.exec(this,t)}#j(t){this.#g&&t.relatedTarget?.parentNode!==this.#l&&this.#H()}#z(t){this.#u=this.#g?t:""}#M(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#g&&this.#C(this.#u,{deltaX:t,deltaY:e,fromKeyboard:!0})}#H(){this.#g=!1,this.#M(-1),this.#_()}_stopResizingWithKeyboard(){this.#H(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}unselect(){this.#l?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#a=!0;const s=t/e,{style:n}=this.div;n.aspectRatio=s,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#A||=new Map;const{action:s}=t;let n=this.#A.get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),this.#A.delete(s),this.#A.size===0&&(this.#A=null)},lt._telemetryTimeout),this.#A.set(s,n);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class fp extends lt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Wo=3285377520,Ne=4294901760,Ke=65535;class oh{constructor(t){this.h1=t?t&4294967295:Wo,this.h2=t?t&4294967295:Wo}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let g=0,m=t.length;g<m;g++){const v=t.charCodeAt(g);v<=255?e[s++]=v:(e[s++]=v>>>8,e[s++]=v&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,r=s-n*4,a=new Uint32Array(e.buffer,0,n);let o=0,l=0,c=this.h1,h=this.h2;const u=3432918353,d=461845907,f=u&Ke,p=d&Ke;for(let g=0;g<n;g++)g&1?(o=a[g],o=o*u&Ne|o*f&Ke,o=o<<15|o>>>17,o=o*d&Ne|o*p&Ke,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[g],l=l*u&Ne|l*f&Ke,l=l<<15|l>>>17,l=l*d&Ne|l*p&Ke,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=e[n*4+2]<<16;case 2:o^=e[n*4+1]<<8;case 1:o^=e[n*4],o=o*u&Ne|o*f&Ke,o=o<<15|o>>>17,o=o*d&Ne|o*p&Ke,n&1?c^=o:h^=o}this.h1=c,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ne|t*36045&Ke,e=e*4283543511&Ne|((e<<16|t>>>16)*2950163797&Ne)>>>16,t^=e>>>1,t=t*444984403&Ne|t*60499&Ke,e=e*3301882366&Ne|((e<<16|t>>>16)*3120437893&Ne)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const aa=Object.freeze({map:null,hash:"",transfer:void 0});class Wa{#t=!1;#e=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=this.#s.get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return this.#s.get(t)}remove(t){if(this.#s.delete(t),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#s.values())if(e instanceof lt)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=this.#s.get(t);let n=!1;if(s!==void 0)for(const[r,a]of Object.entries(e))s[r]!==a&&(n=!0,s[r]=a);else n=!0,this.#s.set(t,e);n&&this.#n(),e instanceof lt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#s.has(t)}getAll(){return this.#s.size>0?ja(this.#s):null}setAll(t){for(const[e,s]of Object.entries(t))this.setValue(e,s)}get size(){return this.#s.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new lh(this)}get serializable(){if(this.#s.size===0)return aa;const t=new Map,e=new oh,s=[],n=Object.create(null);let r=!1;for(const[a,o]of this.#s){const l=o instanceof lt?o.serialize(!1,n):o;l&&(t.set(a,l),e.update(`${a}:${JSON.stringify(l)}`),r||=!!l.bitmap)}if(r)for(const a of t.values())a.bitmap&&s.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:aa}get editorStats(){let t=null;const e=new Map;for(const s of this.#s.values()){if(!(s instanceof lt))continue;const n=s.telemetryFinalData;if(!n)continue;const{type:r}=n;e.has(r)||e.set(r,Object.getPrototypeOf(s).constructor),t||=Object.create(null);const a=t[r]||=new Map;for(const[o,l]of Object.entries(n)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const h=c.get(l)??0;c.set(l,h+1)}}for(const[s,n]of e)t[s]=n.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#s.values())!(e instanceof lt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}}class lh extends Wa{#t;constructor(t){super();const{map:e,hash:s,transfer:n}=t.serializable,r=structuredClone(e,n?{transfer:n}:null);this.#t={map:r,hash:s,transfer:n}}get print(){_t("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Et(this,"modifiedIds",{ids:new Set,hash:""})}}class pp{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||this.#t.has(t.loadedName))){if(Yt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:n,style:r}=t,a=new FontFace(s,n,r);this.addNativeFontFace(a);try{await a.load(),this.#t.add(s),e?.(t)}catch{pt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}_t("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw pt(`Failed to load font '${s.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Et(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(he||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Et(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Yt(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:e,callback:t};return s.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Et(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(b,A){return b.charCodeAt(A)<<24|b.charCodeAt(A+1)<<16|b.charCodeAt(A+2)<<8|b.charCodeAt(A+3)&255}function n(b,A,S,T){const R=b.substring(0,A),x=b.substring(A+S);return R+T+x}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function h(b,A){if(++c>30){pt("Load test font never loaded."),A();return}if(l.font="30px "+b,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){A();return}setTimeout(h.bind(null,b,A))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=n(d,976,u.length,u);const p=16,g=1482184792;let m=s(d,p);for(r=0,a=u.length-3;r<a;r+=4)m=m-g+s(u,r)|0;r<u.length&&(m=m-g+s(u+"XXX",r)|0),d=n(d,p,4,qf(m));const v=`url(data:font/opentype;base64,${btoa(d)});`,y=`@font-face {font-family:"${u}";src:${v}}`;this.insertRule(y);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const b of[t.loadedName,u]){const A=this._document.createElement("span");A.textContent="Hi",A.style.fontFamily=b,w.append(A)}this._document.body.append(w),h(u,()=>{w.remove(),e.complete()})}}class gp{constructor(t,{disableFontFace:e=!1,fontExtraProperties:s=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const r in t)this[r]=t[r];this.disableFontFace=e===!0,this.fontExtraProperties=s===!0,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${rp(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let n;try{n=t.get(s)}catch(a){pt(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(n||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=r}}const oi={DATA:1,ERROR:2},Kt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Go(){}function we(i){if(i instanceof Rs||i instanceof na||i instanceof Xn||i instanceof Vo||i instanceof _i||i instanceof Mr)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||_t('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new Rs(i.message);case"InvalidPDFException":return new na(i.message);case"MissingPDFException":return new Xn(i.message);case"PasswordException":return new Vo(i.message,i.code);case"UnexpectedResponseException":return new _i(i.message,i.status);case"UnknownErrorException":return new Mr(i.message,i.details)}return new Mr(i.message,i.toString())}class Cn{#t=new AbortController;constructor(t,e,s){this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const s=t.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===oi.DATA)n.resolve(t.data);else if(t.callback===oi.ERROR)n.reject(we(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,n=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(a){r.postMessage({sourceName:s,targetName:n,callback:oi.DATA,callbackId:t.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:n,callback:oi.ERROR,callbackId:t.callbackId,reason:we(a)})});return}if(t.streamId){this.#s(t);return}e(t.data)}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const n=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[n]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(t,e,s,n){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:t,streamId:r,data:e,desiredSize:c.desiredSize},n),h.promise},pull:c=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:Kt.PULL,streamId:r,desiredSize:c.desiredSize}),h.promise},cancel:c=>{Yt(c instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Kt.CANCEL,streamId:r,reason:we(c)}),h.promise}},s)}#s(t){const e=t.streamId,s=this.sourceName,n=t.sourceName,r=this.comObj,a=this,o=this.actionHandler[t.action],l={enqueue(c,h=1,u){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=h,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:n,stream:Kt.ENQUEUE,streamId:e,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:Kt.CLOSE,streamId:e}),delete a.streamSinks[e])},error(c){Yt(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:Kt.ERROR,streamId:e,reason:we(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,Promise.try(o,t.data,l).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Kt.START_COMPLETE,streamId:e,success:!0})},function(c){r.postMessage({sourceName:s,targetName:n,stream:Kt.START_COMPLETE,streamId:e,reason:we(c)})})}#n(t){const e=t.streamId,s=this.sourceName,n=t.sourceName,r=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case Kt.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(we(t.reason));break;case Kt.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(we(t.reason));break;case Kt.PULL:if(!o){r.postMessage({sourceName:s,targetName:n,stream:Kt.PULL_COMPLETE,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,Promise.try(o.onPull||Go).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Kt.PULL_COMPLETE,streamId:e,success:!0})},function(c){r.postMessage({sourceName:s,targetName:n,stream:Kt.PULL_COMPLETE,streamId:e,reason:we(c)})});break;case Kt.ENQUEUE:if(Yt(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Kt.CLOSE:if(Yt(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#r(a,e);break;case Kt.ERROR:Yt(a,"error should have stream controller"),a.controller.error(we(t.reason)),this.#r(a,e);break;case Kt.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(we(t.reason)),this.#r(a,e);break;case Kt.CANCEL:if(!o)break;const l=we(t.reason);Promise.try(o.onCancel||Go,l).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Kt.CANCEL_COMPLETE,streamId:e,success:!0})},function(c){r.postMessage({sourceName:s,targetName:n,stream:Kt.CANCEL_COMPLETE,streamId:e,reason:we(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class ch{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){_t("Abstract method `_createCanvas` called.")}}class mp extends ch{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class hh{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){_t("Abstract method `_fetch` called.")}}class uh extends hh{async _fetch(t){const e=await lr(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):or(e)}}Ct(4520);class dh{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,n,r){return"none"}destroy(t=!1){}}class vp extends dh{#t;#e;#s;#n;#r;#i;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#r=e}get#l(){return this.#e||=new Map}get#h(){return this.#i||=new Map}get#c(){if(!this.#s){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const s=this.#r.createElementNS(rs,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#s=this.#r.createElementNS(rs,"defs"),t.append(s),s.append(this.#s),this.#r.body.append(t)}return this.#s}#d(t){if(t.length===1){const l=t[0],c=new Array(256);for(let u=0;u<256;u++)c[u]=l[u]/255;const h=c.join(",");return[h,h,h]}const[e,s,n]=t,r=new Array(256),a=new Array(256),o=new Array(256);for(let l=0;l<256;l++)r[l]=e[l]/255,a[l]=s[l]/255,o[l]=n[l]/255;return[r.join(","),a.join(","),o.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(cr(e)?pt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=e.split("#",1)[0])}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#l.get(t);if(e)return e;const[s,n,r]=this.#d(t),a=t.length===1?s:`${s}${n}${r}`;if(e=this.#l.get(a),e)return this.#l.set(t,e),e;const o=`g_${this.#n}_transfer_map_${this.#a++}`,l=this.#u(o);this.#l.set(t,l),this.#l.set(a,l);const c=this.#p(o);return this.#g(s,n,r,c),l}addHCMFilter(t,e){const s=`${t}-${e}`,n="base";let r=this.#h.get(n);if(r?.key===s||(r?(r.filter?.remove(),r.key=s,r.url="none",r.filter=null):(r={key:s,url:"none",filter:null},this.#h.set(n,r)),!t||!e))return r.url;const a=this.#y(t);t=st.makeHexColor(...a);const o=this.#y(e);if(e=st.makeHexColor(...o),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return r.url;const l=new Array(256);for(let f=0;f<=255;f++){const p=f/255;l[f]=p<=.03928?p/12.92:((p+.055)/1.055)**2.4}const c=l.join(","),h=`g_${this.#n}_hcm_filter`,u=r.filter=this.#p(h);this.#g(c,c,c,u),this.#o(u);const d=(f,p)=>{const g=a[f]/255,m=o[f]/255,v=new Array(p+1);for(let y=0;y<=p;y++)v[y]=g+y/p*(m-g);return v.join(",")};return this.#g(d(0,5),d(1,5),d(2,5),u),r.url=this.#u(h),r.url}addAlphaFilter(t){let e=this.#l.get(t);if(e)return e;const[s]=this.#d([t]),n=`alpha_${s}`;if(e=this.#l.get(n),e)return this.#l.set(t,e),e;const r=`g_${this.#n}_alpha_map_${this.#a++}`,a=this.#u(r);this.#l.set(t,a),this.#l.set(n,a);const o=this.#p(r);return this.#v(s,o),a}addLuminosityFilter(t){let e=this.#l.get(t||"luminosity");if(e)return e;let s,n;if(t?([s]=this.#d([t]),n=`luminosity_${s}`):n="luminosity",e=this.#l.get(n),e)return this.#l.set(t,e),e;const r=`g_${this.#n}_luminosity_map_${this.#a++}`,a=this.#u(r);this.#l.set(t,a),this.#l.set(n,a);const o=this.#p(r);return this.#f(o),t&&this.#v(s,o),a}addHighlightHCMFilter(t,e,s,n,r){const a=`${e}-${s}-${n}-${r}`;let o=this.#h.get(t);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},this.#h.set(t,o)),!e||!s))return o.url;const[l,c]=[e,s].map(this.#y.bind(this));let h=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[d,f]=[n,r].map(this.#y.bind(this));u<h&&([h,u,d,f]=[u,h,f,d]),this.#c.style.color="";const p=(v,y,w)=>{const b=new Array(256),A=(u-h)/w,S=v/255,T=(y-v)/(255*w);let R=0;for(let x=0;x<=w;x++){const I=Math.round(h+x*A),M=S+x*T;for(let H=R;H<=I;H++)b[H]=M;R=I+1}for(let x=R;x<256;x++)b[x]=b[R-1];return b.join(",")},g=`g_${this.#n}_hcm_${t}_filter`,m=o.filter=this.#p(g);return this.#o(m),this.#g(p(d[0],f[0],5),p(d[1],f[1],5),p(d[2],f[2],5),m),o.url=this.#u(g),o.url}destroy(t=!1){t&&this.#i?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#e?.clear(),this.#e=null,this.#i?.clear(),this.#i=null,this.#a=0)}#f(t){const e=this.#r.createElementNS(rs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#o(t){const e=this.#r.createElementNS(rs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#r.createElementNS(rs,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#m(t,e,s){const n=this.#r.createElementNS(rs,e);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),t.append(n)}#g(t,e,s,n){const r=this.#r.createElementNS(rs,"feComponentTransfer");n.append(r),this.#m(r,"feFuncR",t),this.#m(r,"feFuncG",e),this.#m(r,"feFuncB",s)}#v(t,e){const s=this.#r.createElementNS(rs,"feComponentTransfer");e.append(s),this.#m(s,"feFuncA",t)}#y(t){return this.#c.style.color=t,Va(getComputedStyle(this.#c).getPropertyValue("color"))}}class fh{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){_t("Abstract method `_fetch` called.")}}class ph extends fh{async _fetch(t){const e=await lr(t,"arraybuffer");return new Uint8Array(e)}}if(he){let i;try{const t=process.getBuiltinModule("module").createRequire(import.meta.url);try{i=t("@napi-rs/canvas")}catch(e){pt(`Cannot load "@napi-rs/canvas" package: "${e}".`)}}catch(t){pt(`Cannot access the \`require\` function: "${t}".`)}globalThis.DOMMatrix||(i?.DOMMatrix?globalThis.DOMMatrix=i.DOMMatrix:pt("Cannot polyfill `DOMMatrix`, rendering may be broken.")),globalThis.ImageData||(i?.ImageData?globalThis.ImageData=i.ImageData:pt("Cannot polyfill `ImageData`, rendering may be broken.")),globalThis.Path2D||(i?.Path2D?globalThis.Path2D=i.Path2D:pt("Cannot polyfill `Path2D`, rendering may be broken."))}async function gh(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class yp extends dh{}class bp extends ch{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class Ap extends hh{async _fetch(t){return gh(t)}}class wp extends fh{async _fetch(t){return gh(t)}}const oe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function oa(i,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,s),i.clip(n)}class Ga{getPattern(){_t("Abstract method `getPattern` called.")}}class xp extends Ga{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,n){let r;if(n===oe.STROKE||n===oe.FILL){const a=e.current.getClippedPathBoundingBox(n,$t(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,l),h=c.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=st.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),oa(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=t.createPattern(c.canvas,"no-repeat");const u=new DOMMatrix(s);r.setTransform(u)}else oa(t,this._bbox),r=this._createGradient(t);return r}}function Nr(i,t,e,s,n,r,a,o){const l=t.coords,c=t.colors,h=i.data,u=i.width*4;let d;l[e+1]>l[s+1]&&(d=e,e=s,s=d,d=r,r=a,a=d),l[s+1]>l[n+1]&&(d=s,s=n,n=d,d=a,a=o,o=d),l[e+1]>l[s+1]&&(d=e,e=s,s=d,d=r,r=a,a=d);const f=(l[e]+t.offsetX)*t.scaleX,p=(l[e+1]+t.offsetY)*t.scaleY,g=(l[s]+t.offsetX)*t.scaleX,m=(l[s+1]+t.offsetY)*t.scaleY,v=(l[n]+t.offsetX)*t.scaleX,y=(l[n+1]+t.offsetY)*t.scaleY;if(p>=y)return;const w=c[r],b=c[r+1],A=c[r+2],S=c[a],T=c[a+1],R=c[a+2],x=c[o],I=c[o+1],M=c[o+2],H=Math.round(p),B=Math.round(y);let W,et,F,_,Y,nt,mt,wt;for(let rt=H;rt<=B;rt++){if(rt<m){const C=rt<p?0:(p-rt)/(p-m);W=f-(f-g)*C,et=w-(w-S)*C,F=b-(b-T)*C,_=A-(A-R)*C}else{let C;rt>y?C=1:m===y?C=0:C=(m-rt)/(m-y),W=g-(g-v)*C,et=S-(S-x)*C,F=T-(T-I)*C,_=R-(R-M)*C}let xt;rt<p?xt=0:rt>y?xt=1:xt=(p-rt)/(p-y),Y=f-(f-v)*xt,nt=w-(w-x)*xt,mt=b-(b-I)*xt,wt=A-(A-M)*xt;const ne=Math.round(Math.min(W,Y)),te=Math.round(Math.max(W,Y));let N=u*rt+ne*4;for(let C=ne;C<=te;C++)xt=(W-C)/(W-Y),xt<0?xt=0:xt>1&&(xt=1),h[N++]=et-(et-nt)*xt|0,h[N++]=F-(F-mt)*xt|0,h[N++]=_-(_-wt)*xt|0,h[N++]=255}}function Ep(i,t,e){const s=t.coords,n=t.colors;let r,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(s.length/o)-1,c=o-1;for(r=0;r<l;r++){let h=r*o;for(let u=0;u<c;u++,h++)Nr(i,e,s[h],s[h+1],s[h+o],n[h],n[h+1],n[h+o]),Nr(i,e,s[h+o+1],s[h+1],s[h+o],n[h+o+1],n[h+1],n[h+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)Nr(i,e,s[r],s[r+1],s[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}class Sp extends Ga{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(h*t[1]*1.1)),3e3),f=c/u,p=h/d,g={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/p},m=u+4,v=d+4,y=s.getCanvas("mesh",m,v),w=y.context,b=w.createImageData(u,d);if(e){const S=b.data;for(let T=0,R=S.length;T<R;T+=4)S[T]=e[0],S[T+1]=e[1],S[T+2]=e[2],S[T+3]=255}for(const S of this._figures)Ep(b,S,g);return w.putImageData(b,2,2),{canvas:y.canvas,offsetX:o-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}getPattern(t,e,s,n){oa(t,this._bbox);let r;if(n===oe.SHADING)r=st.singularValueDecompose2dScale($t(t));else if(r=st.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=st.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,n===oe.SHADING?null:this._background,e.cachedCanvases);return n!==oe.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class Tp extends Ga{getPattern(){return"hotpink"}}function Pp(i){switch(i[0]){case"RadialAxial":return new xp(i);case"Mesh":return new Sp(i);case"Dummy":return new Tp}throw new Error(`Unknown IR type: ${i[0]}`)}const Xo={COLORED:1,UNCOLORED:2};class Xa{static MAX_PATTERN_SIZE=3e3;constructor(t,e,s,n,r){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=s,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:s,paintType:n,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),ar("TilingType: "+r);const h=e[0],u=e[1],d=e[2],f=e[3],p=d-h,g=f-u,m=st.singularValueDecompose2dScale(this.matrix),v=st.singularValueDecompose2dScale(this.baseTransform),y=m[0]*v[0],w=m[1]*v[1];let b=p,A=g,S=!1,T=!1;const R=Math.ceil(l*y),x=Math.ceil(c*w),I=Math.ceil(p*y),M=Math.ceil(g*w);R>=I?b=l:S=!0,x>=M?A=c:T=!0;const H=this.getSizeAndScale(b,this.ctx.canvas.width,y),B=this.getSizeAndScale(A,this.ctx.canvas.height,w),W=t.cachedCanvases.getCanvas("pattern",H.size,B.size),et=W.context,F=o.createCanvasGraphics(et);if(F.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(F,n,a),et.translate(-H.scale*h,-B.scale*u),F.transform(H.scale,0,0,B.scale,0,0),et.save(),this.clipBbox(F,h,u,d,f),F.baseTransform=$t(F.ctx),F.executeOperatorList(s),F.endDrawing(),et.restore(),S||T){const _=W.canvas;S&&(b=l),T&&(A=c);const Y=this.getSizeAndScale(b,this.ctx.canvas.width,y),nt=this.getSizeAndScale(A,this.ctx.canvas.height,w),mt=Y.size,wt=nt.size,rt=t.cachedCanvases.getCanvas("pattern-workaround",mt,wt),xt=rt.context,ne=S?Math.floor(p/l):0,te=T?Math.floor(g/c):0;for(let N=0;N<=ne;N++)for(let C=0;C<=te;C++)xt.drawImage(_,mt*N,wt*C,mt,wt,0,0,mt,wt);return{canvas:rt.canvas,scaleX:Y.scale,scaleY:nt.scale,offsetX:h,offsetY:u}}return{canvas:W.canvas,scaleX:H.scale,scaleY:B.scale,offsetX:h,offsetY:u}}getSizeAndScale(t,e,s){const n=Math.max(Xa.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*s);return r>=n?r=n:s=r/t,{scale:s,size:r}}clipBbox(t,e,s,n,r){const a=n-e,o=r-s;t.ctx.rect(e,s,a,o),t.current.updateRectMinMax($t(t.ctx),[e,s,n,r]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const n=t.ctx,r=t.current;switch(e){case Xo.COLORED:const a=this.ctx;n.fillStyle=a.fillStyle,n.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Xo.UNCOLORED:const o=st.makeHexColor(s[0],s[1],s[2]);n.fillStyle=o,n.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new Qf(`Unsupported paint type: ${e}`)}}getPattern(t,e,s,n){let r=s;n!==oe.SHADING&&(r=st.transform(r,e.baseTransform),this.matrix&&(r=st.transform(r,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}}function Cp({src:i,srcPos:t=0,dest:e,width:s,height:n,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=ge.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=s>>3,u=s&7,d=i.length;e=new Uint32Array(e.buffer);let f=0;for(let p=0;p<n;p++){for(const m=t+h;t<m;t++){const v=t<d?i[t]:255;e[f++]=v&128?c:l,e[f++]=v&64?c:l,e[f++]=v&32?c:l,e[f++]=v&16?c:l,e[f++]=v&8?c:l,e[f++]=v&4?c:l,e[f++]=v&2?c:l,e[f++]=v&1?c:l}if(u===0)continue;const g=t<d?i[t++]:255;for(let m=0;m<u;m++)e[f++]=g&1<<7-m?c:l}return{srcPos:t,destPos:f}}const Ko=16,Yo=100,Ip=15,Jo=10,Zo=1e3,Ee=16;function Rp(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(s,n){t.translate(s,n),this.__originalTranslate(s,n)},i.scale=function(s,n){t.scale(s,n),this.__originalScale(s,n)},i.transform=function(s,n,r,a,o,l){t.transform(s,n,r,a,o,l),this.__originalTransform(s,n,r,a,o,l)},i.setTransform=function(s,n,r,a,o,l){t.setTransform(s,n,r,a,o,l),this.__originalSetTransform(s,n,r,a,o,l)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(s){t.rotate(s),this.__originalRotate(s)},i.clip=function(s){t.clip(s),this.__originalClip(s)},i.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},i.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},i.bezierCurveTo=function(e,s,n,r,a,o){t.bezierCurveTo(e,s,n,r,a,o),this.__originalBezierCurveTo(e,s,n,r,a,o)},i.rect=function(e,s,n,r){t.rect(e,s,n,r),this.__originalRect(e,s,n,r)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Mp{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,s)):(n=this.canvasFactory.create(e,s),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function li(i,t,e,s,n,r,a,o,l,c){const[h,u,d,f,p,g]=$t(i);if(u===0&&d===0){const y=a*h+p,w=Math.round(y),b=o*f+g,A=Math.round(b),S=(a+l)*h+p,T=Math.abs(Math.round(S)-w)||1,R=(o+c)*f+g,x=Math.abs(Math.round(R)-A)||1;return i.setTransform(Math.sign(h),0,0,Math.sign(f),w,A),i.drawImage(t,e,s,n,r,0,0,T,x),i.setTransform(h,u,d,f,p,g),[T,x]}if(h===0&&f===0){const y=o*d+p,w=Math.round(y),b=a*u+g,A=Math.round(b),S=(o+c)*d+p,T=Math.abs(Math.round(S)-w)||1,R=(a+l)*u+g,x=Math.abs(Math.round(R)-A)||1;return i.setTransform(0,Math.sign(u),Math.sign(d),0,w,A),i.drawImage(t,e,s,n,r,0,0,x,T),i.setTransform(h,u,d,f,p,g),[x,T]}i.drawImage(t,e,s,n,r,a,o,l,c);const m=Math.hypot(h,u),v=Math.hypot(d,f);return[m*l,v*c]}function Lp(i){const{width:t,height:e}=i;if(t>Zo||e>Zo)return null;const s=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=t+1;let a=new Uint8Array(r*(e+1)),o,l,c;const h=t+7&-8;let u=new Uint8Array(h*e),d=0;for(const v of i.data){let y=128;for(;y>0;)u[d++]=v&y?0:255,y>>=1}let f=0;for(d=0,u[d]!==0&&(a[0]=1,++f),l=1;l<t;l++)u[d]!==u[d+1]&&(a[l]=u[d]?2:1,++f),d++;for(u[d]!==0&&(a[l]=2,++f),o=1;o<e;o++){d=o*h,c=o*r,u[d-h]!==u[d]&&(a[c]=u[d]?1:8,++f);let v=(u[d]?4:0)+(u[d-h]?8:0);for(l=1;l<t;l++)v=(v>>2)+(u[d+1]?4:0)+(u[d-h+1]?8:0),n[v]&&(a[c+l]=n[v],++f),d++;if(u[d-h]!==u[d]&&(a[c+l]=u[d]?2:4,++f),f>s)return null}for(d=h*(e-1),c=o*r,u[d]!==0&&(a[c]=8,++f),l=1;l<t;l++)u[d]!==u[d+1]&&(a[c+l]=u[d]?4:8,++f),d++;if(u[d]!==0&&(a[c+l]=4,++f),f>s)return null;const p=new Int32Array([0,r,-1,0,-r,0,0,0,1]),g=new Path2D;for(o=0;f&&o<=e;o++){let v=o*r;const y=v+t;for(;v<y&&!a[v];)v++;if(v===y)continue;g.moveTo(v%r,o);const w=v;let b=a[v];do{const A=p[b];do v+=A;while(!a[v]);const S=a[v];S!==5&&S!==10?(b=S,a[v]=0):(b=S&51*b>>4,a[v]&=b>>2|b<<2),g.lineTo(v%r,v/r|0),a[v]||--f}while(w!==v);--o}return u=null,a=null,function(v){v.save(),v.scale(1/t,-1/e),v.translate(0,-e),v.fill(g),v.beginPath(),v.restore()}}class Qo{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=sh,this.textMatrixScale=1,this.fontMatrix=sa,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=re.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,s){[e,s]=st.applyTransform([e,s],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(t,e){const s=st.applyTransform(e,t),n=st.applyTransform(e.slice(2),t),r=st.applyTransform([e[0],e[3]],t),a=st.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,s[0],n[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],n[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],n[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],n[1],r[1],a[1])}updateScalingPathMinMax(t,e){st.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,s,n,r,a,o,l,c,h){const u=st.bezierBoundingBox(e,s,n,r,a,o,l,c,h);h||this.updateRectMinMax(t,u)}getPathBoundingBox(t=oe.FILL,e=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(t===oe.STROKE){e||_t("Stroke bounding box must include transform.");const n=st.singularValueDecompose2dScale(e),r=n[0]*this.lineWidth/2,a=n[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const t=st.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=oe.FILL,e=null){return st.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function qo(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,s=t.width,n=e%Ee,r=(e-n)/Ee,a=n===0?r:r+1,o=i.createImageData(s,Ee);let l=0,c;const h=t.data,u=o.data;let d,f,p,g;if(t.kind===xi.GRAYSCALE_1BPP){const m=h.byteLength,v=new Uint32Array(u.buffer,0,u.byteLength>>2),y=v.length,w=s+7>>3,b=4294967295,A=ge.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(p=d<r?Ee:n,c=0,f=0;f<p;f++){const S=m-l;let T=0;const R=S>w?s:S*8-7,x=R&-8;let I=0,M=0;for(;T<x;T+=8)M=h[l++],v[c++]=M&128?b:A,v[c++]=M&64?b:A,v[c++]=M&32?b:A,v[c++]=M&16?b:A,v[c++]=M&8?b:A,v[c++]=M&4?b:A,v[c++]=M&2?b:A,v[c++]=M&1?b:A;for(;T<R;T++)I===0&&(M=h[l++],I=128),v[c++]=M&I?b:A,I>>=1}for(;c<y;)v[c++]=0;i.putImageData(o,0,d*Ee)}}else if(t.kind===xi.RGBA_32BPP){for(f=0,g=s*Ee*4,d=0;d<r;d++)u.set(h.subarray(l,l+g)),l+=g,i.putImageData(o,0,f),f+=Ee;d<a&&(g=s*n*4,u.set(h.subarray(l,l+g)),i.putImageData(o,0,f))}else if(t.kind===xi.RGB_24BPP)for(p=Ee,g=s*p,d=0;d<a;d++){for(d>=r&&(p=n,g=s*p),c=0,f=g;f--;)u[c++]=h[l++],u[c++]=h[l++],u[c++]=h[l++],u[c++]=255;i.putImageData(o,0,d*Ee)}else throw new Error(`bad image kind: ${t.kind}`)}function tl(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,n=e%Ee,r=(e-n)/Ee,a=n===0?r:r+1,o=i.createImageData(s,Ee);let l=0;const c=t.data,h=o.data;for(let u=0;u<a;u++){const d=u<r?Ee:n;({srcPos:l}=Cp({src:c,srcPos:l,dest:h,width:s,height:d,nonBlackColor:0})),i.putImageData(o,0,u*Ee)}}function bn(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)i[s]!==void 0&&(t[s]=i[s]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function ci(i){if(i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0),!he){const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}}function el(i,t){if(t)return!0;const e=st.singularValueDecompose2dScale(i);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*un.PDF_TO_CSS_UNITS);return e[0]<=s&&e[1]<=s}const Op=["butt","round","square"],Np=["miter","round","bevel"],Dp={},sl={};class sn{constructor(t,e,s,n,r,{optionalContentConfig:a,markedContentStack:o=null},l,c){this.ctx=t,this.current=new Qo(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=n,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new Mp(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:n=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...$t(this.compositeCtx))}this.ctx.save(),ci(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=$t(this.ctx)}executeOperatorList(t,e,s,n){const r=t.argsArray,a=t.fnArray;let o=e||0;const l=r.length;if(l===o)return o;const c=l-o>Jo&&typeof s=="function",h=c?Date.now()+Ip:0;let u=0;const d=this.commonObjs,f=this.objs;let p;for(;;){if(n!==void 0&&o===n.nextBreakPoint)return n.breakIt(o,s),o;if(p=a[o],p!==$e.dependency)this[p].apply(this,r[o]);else for(const g of r[o]){const m=g.startsWith("g_")?d:f;if(!m.has(g))return m.get(g,s),o}if(o++,o===l)return o;if(c&&++u>Jo){if(Date.now()>h)return s(),o;u=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const s=t.width??t.displayWidth,n=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=s,l=n,c="prescale1",h,u;for(;r>2&&o>1||a>2&&l>1;){let d=o,f=l;r>2&&o>1&&(d=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/d),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),h=this.cachedCanvases.getCanvas(c,d,f),u=h.context,u.clearRect(0,0,d,f),u.drawImage(t,0,0,o,l,0,0,d,f),t=h.canvas,o=d,l=f,c=c==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:l}}_createMaskCanvas(t){const e=this.ctx,{width:s,height:n}=t,r=this.current.fillColor,a=this.current.patternFill,o=$t(e);let l,c,h,u;if((t.bitmap||t.data)&&t.count>1){const R=t.bitmap||t.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(R),l||(l=new Map,this._cachedBitmapsMap.set(R,l));const x=l.get(c);if(x&&!a){const I=Math.round(Math.min(o[0],o[2])+o[4]),M=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:x,offsetX:I,offsetY:M}}h=x}h||(u=this.cachedCanvases.getCanvas("maskCanvas",s,n),tl(u.context,t));let d=st.transform(o,[1/s,0,0,-1/n,0,0]);d=st.transform(d,[1,0,0,1,0,-n]);const[f,p,g,m]=st.getAxialAlignedBoundingBox([0,0,s,n],d),v=Math.round(g-f)||1,y=Math.round(m-p)||1,w=this.cachedCanvases.getCanvas("fillCanvas",v,y),b=w.context,A=f,S=p;b.translate(-A,-S),b.transform(...d),h||(h=this._scaleImage(u.canvas,Xe(b)),h=h.img,l&&a&&l.set(c,h)),b.imageSmoothingEnabled=el($t(b),t.interpolate),li(b,h,0,0,h.width,h.height,0,0,s,n),b.globalCompositeOperation="source-in";const T=st.transform(Xe(b),[1,0,0,1,-A,-S]);return b.fillStyle=a?r.getPattern(e,this,T,oe.FILL):r,b.fillRect(0,0,s,n),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,w.canvas)),{canvas:w.canvas,offsetX:Math.round(A),offsetY:Math.round(S)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Op[t]}setLineJoin(t){this.ctx.lineJoin=Np[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,s]of t)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(s,t,e);this.suspendedCtx=this.ctx,this.ctx=n.context;const r=this.ctx;r.setTransform(...$t(this.suspendedCtx)),bn(this.suspendedCtx,r),Rp(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),bn(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,n){const r=n[0],a=n[1],o=n[2]-r,l=n[3]-a;o===0||l===0||(this.genericComposeSMask(e.context,s,o,l,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,n,r,a,o,l,c,h,u){let d=t.canvas,f=l-h,p=c-u;if(a){const m=st.makeHexColor(...a);if(f<0||p<0||f+s>d.width||p+n>d.height){const v=this.cachedCanvases.getCanvas("maskExtension",s,n),y=v.context;y.drawImage(d,-f,-p),y.globalCompositeOperation="destination-atop",y.fillStyle=m,y.fillRect(0,0,s,n),y.globalCompositeOperation="source-over",d=v.canvas,f=p=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(f,p,s,n),t.clip(v),t.globalCompositeOperation="destination-atop",t.fillStyle=m,t.fillRect(f,p,s,n),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?e.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(o));const g=new Path2D;g.rect(l,c,s,n),e.clip(g),e.globalCompositeOperation="destination-in",e.drawImage(d,f,p,s,n,l,c,s,n),e.restore()}save(){this.inSMaskMode?(bn(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),bn(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,s,n,r,a){this.ctx.transform(t,e,s,n,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s){const n=this.ctx,r=this.current;let a=r.x,o=r.y,l,c;const h=$t(n),u=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,d=u?s.slice(0):null;for(let f=0,p=0,g=t.length;f<g;f++)switch(t[f]|0){case $e.rectangle:a=e[p++],o=e[p++];const m=e[p++],v=e[p++],y=a+m,w=o+v;n.moveTo(a,o),m===0||v===0?n.lineTo(y,w):(n.lineTo(y,o),n.lineTo(y,w),n.lineTo(a,w)),u||r.updateRectMinMax(h,[a,o,y,w]),n.closePath();break;case $e.moveTo:a=e[p++],o=e[p++],n.moveTo(a,o),u||r.updatePathMinMax(h,a,o);break;case $e.lineTo:a=e[p++],o=e[p++],n.lineTo(a,o),u||r.updatePathMinMax(h,a,o);break;case $e.curveTo:l=a,c=o,a=e[p+4],o=e[p+5],n.bezierCurveTo(e[p],e[p+1],e[p+2],e[p+3],a,o),r.updateCurvePathMinMax(h,l,c,e[p],e[p+1],e[p+2],e[p+3],a,o,d),p+=6;break;case $e.curveTo2:l=a,c=o,n.bezierCurveTo(a,o,e[p],e[p+1],e[p+2],e[p+3]),r.updateCurvePathMinMax(h,l,c,a,o,e[p],e[p+1],e[p+2],e[p+3],d),a=e[p+2],o=e[p+3],p+=4;break;case $e.curveTo3:l=a,c=o,a=e[p+2],o=e[p+3],n.bezierCurveTo(e[p],e[p+1],a,o,a,o),r.updateCurvePathMinMax(h,l,c,e[p],e[p+1],a,o,a,o,d),p+=4;break;case $e.closePath:n.closePath();break}u&&r.updateScalingPathMinMax(h,d),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,s=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&s?.getPattern?(e.save(),e.strokeStyle=s.getPattern(e,this,Xe(e),oe.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,s=this.current.fillColor,n=this.current.patternFill;let r=!1;n&&(e.save(),e.fillStyle=s.getPattern(e,this,Xe(e),oe.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),r&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Dp}eoClip(){this.pendingClip=sl}beginText(){this.current.textMatrix=sh,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const s=new Path2D,n=e.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:l,path:c}of t)s.addPath(c,new DOMMatrix(r).preMultiplySelf(n).translate(a,o).scale(l,-l));e.clip(s),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const s=this.commonObjs.get(t),n=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(n.fontMatrix=s.fontMatrix||sa,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&pt("Invalid font matrix for font "+t),e<0?(e=-e,n.fontDirection=-1):n.fontDirection=1,this.current.font=s,this.current.fontSize=e,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=s.systemFontInfo?.css||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const l=s.italic?"italic":"normal";let c=e;e<Ko?c=Ko:e>Yo&&(c=Yo),this.current.fontSizeScale=e/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,s,n,r,a){this.current.textMatrix=[t,e,s,n,r,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#s(t,e,s){const n=new Path2D;return n.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),n}paintChar(t,e,s,n,r){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,u=c&re.FILL_STROKE_MASK,d=!!(c&re.ADD_TO_PATH_FLAG),f=o.patternFill&&!l.missingFile,p=o.patternStroke&&!l.missingFile;let g;if((l.disableFontFace||d||f||p)&&(g=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||f||p){if(a.save(),a.translate(e,s),a.scale(h,-h),u===re.FILL||u===re.FILL_STROKE)if(n){const m=a.getTransform();a.setTransform(...n),a.fill(this.#s(g,m,n))}else a.fill(g);if(u===re.STROKE||u===re.FILL_STROKE)if(r){const m=a.getTransform();a.setTransform(...r),a.stroke(this.#s(g,m,r))}else a.lineWidth/=h,a.stroke(g);a.restore()}else(u===re.FILL||u===re.FILL_STROKE)&&a.fillText(t,e,s),(u===re.STROKE||u===re.FILL_STROKE)&&a.strokeText(t,e,s);d&&(this.pendingTextPaths||=[]).push({transform:$t(a),x:e,y:s,fontSize:h,path:g})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){s=!0;break}return Et(this,"isFontSubpixelAAEnabled",s)}showText(t){const e=this.current,s=e.font;if(s.isType3Font)return this.showType3Text(t);const n=e.fontSize;if(n===0)return;const r=this.ctx,a=e.fontSizeScale,o=e.charSpacing,l=e.wordSpacing,c=e.fontDirection,h=e.textHScale*c,u=t.length,d=s.vertical,f=d?1:-1,p=s.defaultVMetrics,g=n*e.fontMatrix[0],m=e.textRenderingMode===re.FILL&&!s.disableFontFace&&!e.patternFill;r.save(),r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),c>0?r.scale(h,-1):r.scale(h,1);let v,y;if(e.patternFill){r.save();const T=e.fillColor.getPattern(r,this,Xe(r),oe.FILL);v=$t(r),r.restore(),r.fillStyle=T}if(e.patternStroke){r.save();const T=e.strokeColor.getPattern(r,this,Xe(r),oe.STROKE);y=$t(r),r.restore(),r.strokeStyle=T}let w=e.lineWidth;const b=e.textMatrixScale;if(b===0||w===0){const T=e.textRenderingMode&re.FILL_STROKE_MASK;(T===re.STROKE||T===re.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=b;if(a!==1&&(r.scale(a,a),w/=a),r.lineWidth=w,s.isInvalidPDFjsFont){const T=[];let R=0;for(const x of t)T.push(x.unicode),R+=x.width;r.fillText(T.join(""),0,0),e.x+=R*g*h,r.restore(),this.compose();return}let A=0,S;for(S=0;S<u;++S){const T=t[S];if(typeof T=="number"){A+=f*T*n/1e3;continue}let R=!1;const x=(T.isSpace?l:0)+o,I=T.fontChar,M=T.accent;let H,B,W=T.width;if(d){const F=T.vmetric||p,_=-(T.vmetric?F[1]:W*.5)*g,Y=F[2]*g;W=F?-F[0]:W,H=_/a,B=(A+Y)/a}else H=A/a,B=0;if(s.remeasure&&W>0){const F=r.measureText(I).width*1e3/n*a;if(W<F&&this.isFontSubpixelAAEnabled){const _=W/F;R=!0,r.save(),r.scale(_,1),H/=_}else W!==F&&(H+=(W-F)/2e3*n/a)}if(this.contentVisible&&(T.isInFont||s.missingFile)){if(m&&!M)r.fillText(I,H,B);else if(this.paintChar(I,H,B,v,y),M){const F=H+n*M.offset.x/a,_=B-n*M.offset.y/a;this.paintChar(M.fontChar,F,_,v,y)}}const et=d?W*g-x*c:W*g+x*c;A+=et,R&&r.restore()}d?e.y-=A:e.x+=A*h,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,s=this.current,n=s.font,r=s.fontSize,a=s.fontDirection,o=n.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,h=s.textHScale*a,u=s.fontMatrix||sa,d=t.length,f=s.textRenderingMode===re.INVISIBLE;let p,g,m,v;if(!(f||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...s.textMatrix),e.translate(s.x,s.y),e.scale(h,a),p=0;p<d;++p){if(g=t[p],typeof g=="number"){v=o*g*r/1e3,this.ctx.translate(v,0),s.x+=v*h;continue}const y=(g.isSpace?c:0)+l,w=n.charProcOperatorList[g.operatorListId];if(!w){pt(`Type3 character "${g.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=g,this.save(),e.scale(r,r),e.transform(...u),this.executeOperatorList(w),this.restore()),m=st.applyTransform([g.width,0],u)[0]*r+y,e.translate(m,0),s.x+=m*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,s,n,r,a){this.ctx.rect(s,n,r-s,a-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const s=t[1],n=this.baseTransform||$t(this.ctx),r={createCanvasGraphics:a=>new sn(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Xa(t,s,this.ctx,r,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,s){this.ctx.strokeStyle=this.current.strokeColor=st.makeHexColor(t,e,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,s){this.ctx.fillStyle=this.current.fillColor=st.makeHexColor(t,e,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=Pp(this.getObject(t)),this.cachedPatterns.set(t,s)),e&&(s.matrix=e),s}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const s=this._getPattern(t);e.fillStyle=s.getPattern(e,this,Xe(e),oe.SHADING);const n=Xe(e);if(n){const{width:r,height:a}=e.canvas,[o,l,c,h]=st.getAxialAlignedBoundingBox([0,0,r,a],n);this.ctx.fillRect(o,l,c-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){_t("Should not call beginInlineImage")}beginImageData(){_t("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=$t(this.ctx),e)){const s=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],s,n),this.current.updateRectMinMax($t(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||ar("TODO: Support non-isolated groups."),t.knockout&&pt("Knockout groups not supported.");const s=$t(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let n=st.getAxialAlignedBoundingBox(t.bbox,$t(e));const r=[0,0,e.canvas.width,e.canvas.height];n=st.intersect(n,r)||[0,0,0,0];const a=Math.floor(n[0]),o=Math.floor(n[1]),l=Math.max(Math.ceil(n[2])-a,1),c=Math.max(Math.ceil(n[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(h,l,c),d=u.context;d.translate(-a,-o),d.transform(...s),t.smask?this.smaskStack.push({canvas:u.canvas,context:d,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),bn(e,d),this.ctx=d,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=$t(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const r=st.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],n);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(t,e,s,n,r){if(this.#t(),ci(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=e[0],s[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=o;const[l,c]=st.singularValueDecompose2dScale($t(this.ctx)),{viewportScale:h}=this,u=Math.ceil(a*this.outputScaleX*h),d=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(u,d);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),ci(this.ctx)}else ci(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Qo(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const s=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=Lp(t)),n.compiled)){n.compiled(s);return}const r=this._createMaskCanvas(t),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s=0,n=0,r,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const l=$t(o);o.transform(e,s,n,r,0,0);const c=this._createMaskCanvas(t);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let h=0,u=a.length;h<u;h+=2){const d=st.transform(l,[e,s,n,r,a[h],a[h+1]]),[f,p]=st.applyTransform([0,0],d);o.drawImage(c.canvas,f,p)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(const r of t){const{data:a,width:o,height:l,transform:c}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),u=h.context;u.save();const d=this.getObject(a,r);tl(u,d),u.globalCompositeOperation="source-in",u.fillStyle=n?s.getPattern(u,this,Xe(e),oe.FILL):s,u.fillRect(0,0,o,l),u.restore(),e.save(),e.transform(...c),e.scale(1,-1),li(e,h.canvas,0,0,o,l,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){pt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,s,n){if(!this.contentVisible)return;const r=this.getObject(t);if(!r){pt("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let c=0,h=n.length;c<h;c+=2)l.push({transform:[e,0,0,s,n[c],n[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:n}=t,r=this.cachedCanvases.getCanvas("inlineImage",s,n),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,s=t.height,n=this.ctx;if(this.save(),!he){const{filter:o}=n;o!=="none"&&o!==""&&(n.filter="none")}n.scale(1/e,-1/s);let r;if(t.bitmap)r=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)r=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",e,s).context;qo(l,t),r=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(r,Xe(n));n.imageSmoothingEnabled=el($t(n),t.interpolate),li(n,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,e,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx;let n;if(t.bitmap)n=t.bitmap;else{const r=t.width,a=t.height,l=this.cachedCanvases.getCanvas("inlineImage",r,a).context;qo(l,t),n=this.applyTransferMapsToCanvas(l)}for(const r of e)s.save(),s.transform(...r.transform),s.scale(1,-1),li(s,n,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(e||(this.pendingClip===sl?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=$t(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:n,d:r}=this.ctx.getTransform();let a,o;if(s===0&&n===0){const l=Math.abs(e),c=Math.abs(r);if(l===c)if(t===0)a=o=1/l;else{const h=l*t;a=o=h<1?1/h:1}else if(t===0)a=1/l,o=1/c;else{const h=l*t,u=c*t;a=h<1?1/h:1,o=u<1?1/u:1}}else{const l=Math.abs(e*r-s*n),c=Math.hypot(e,s),h=Math.hypot(n,r);if(t===0)a=h/l,o=c/l;else{const u=t*l;a=h>u?h/u:1,o=c>u?c/u:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:s}=this.current,[n,r]=this.getScaleForStroking();if(e.lineWidth=s||1,n===1&&r===1){e.stroke();return}const a=e.getLineDash();if(t&&e.save(),e.scale(n,r),a.length>0){const o=Math.max(n,r);e.setLineDash(a.map(l=>l/o)),e.lineDashOffset/=o}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const i in $e)sn.prototype[i]!==void 0&&(sn.prototype[$e[i]]=sn.prototype[i]);let Fn=class{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}};class _p{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}getAll(){return ja(this.#t)}has(t){return this.#t.has(t)}}const Ys=Symbol("INTERNAL");class Fp{#t=!1;#e=!1;#s=!1;#n=!0;constructor(t,{name:e,intent:s,usage:n,rbGroups:r}){this.#t=!!(t&Me.DISPLAY),this.#e=!!(t&Me.PRINT),this.name=e,this.intent=s,this.usage=n,this.rbGroups=r}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,s=!1){t!==Ys&&_t("Internal method `_setVisible` called."),this.#s=s,this.#n=e}}class kp{#t=null;#e=new Map;#s=null;#n=null;constructor(t,e=Me.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const s of t.groups)this.#e.set(s.id,new Fp(e,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(Ys,!1);for(const s of t.on)this.#e.get(s)._setVisible(Ys,!0);for(const s of t.off)this.#e.get(s)._setVisible(Ys,!1);this.#s=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let n=1;n<e;n++){const r=t[n];let a;if(Array.isArray(r))a=this.#r(r);else if(this.#e.has(r))a=this.#e.get(r).visible;else return pt(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return ar("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(pt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return pt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return pt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return pt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return pt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return pt(`Unknown optional content policy ${t.policy}.`),!0}return pt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){const n=this.#e.get(t);if(!n){pt(`Optional content group not found: ${t}`);return}if(s&&e&&n.rbGroups.length)for(const r of n.rbGroups)for(const a of r)a!==t&&this.#e.get(a)?._setVisible(Ys,!1,!0);n._setVisible(Ys,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let s;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const r=this.#e.get(n);if(r)switch(s){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!r.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?ja(this.#e):null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new oh;for(const[e,s]of this.#e)t.update(`${e}:${s.visible}`);return this.#t=t.hexdigest()}}class jp{constructor(t,{disableRange:e=!1,disableStream:s=!1}){Yt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:r,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,r?.length>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),t.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),t.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(s),!0)});Yt(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Yt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new $p(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new Bp(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class $p{constructor(t,e,s=!1,n=null){this._stream=t,this._done=s||!1,this._filename=Ha(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Bp{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Hp(i){let t=!0,e=s("filename\\*","i").exec(i);if(e){e=e[1];let h=o(e);return h=unescape(h),h=l(h),h=c(h),r(h)}if(e=a(i),e){const h=c(e);return r(h)}if(e=s("filename","i").exec(i),e){e=e[1];let h=o(e);return h=c(h),r(h)}function s(h,u){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function n(h,u){if(h){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const d=new TextDecoder(h,{fatal:!0}),f=or(u);u=d.decode(f),t=!1}catch{}}return u}function r(h){return t&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),t&&(h=n("iso-8859-1",h))),h}function a(h){const u=[];let d;const f=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(h))!==null;){let[,g,m,v]=d;if(g=parseInt(g,10),g in u){if(g===0)break;continue}u[g]=[m,v]}const p=[];for(let g=0;g<u.length&&g in u;++g){let[m,v]=u[g];v=o(v),m&&(v=unescape(v),g===0&&(v=l(v))),p.push(v)}return p.join("")}function o(h){if(h.startsWith('"')){const u=h.slice(1).split('\\"');for(let d=0;d<u.length;++d){const f=u[d].indexOf('"');f!==-1&&(u[d]=u[d].slice(0,f),u.length=d+1),u[d]=u[d].replaceAll(/\\(.)/g,"$1")}h=u.join('"')}return h}function l(h){const u=h.indexOf("'");if(u===-1)return h;const d=h.slice(0,u),p=h.slice(u+1).replace(/^[^']*'/,"");return n(d,p)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,d,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,m){return String.fromCharCode(parseInt(m,16))}),n(d,p);try{p=atob(p)}catch{}return n(d,p)})}return""}function mh(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const s in t){const n=t[s];n!==void 0&&e.append(s,n)}return e}function hr(i){try{return new URL(i).origin}catch{}return null}function vh({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(i.get("Content-Length"),10);return!Number.isInteger(r)||(n.suggestedLength=r,r<=2*e)||s||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function yh(i){const t=i.get("Content-Disposition");if(t){let e=Hp(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Ha(e))return e}return null}function ur(i,t){return i===404||i===0&&t.startsWith("file:")?new Xn('Missing PDF "'+t+'".'):new _i(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i)}function bh(i){return i===200||i===206}function Ah(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function wh(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(pt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class nl{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=mh(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Yt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Vp(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new Up(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Vp{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),n=e.url;fetch(n,Ah(s,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=hr(r.url),!bh(r.status))throw ur(r.status,n);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=vh({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=yh(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Rs("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:wh(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Up{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${s-1}`);const a=n.url;fetch(a,Ah(r,this._withCredentials,this._abortController)).then(o=>{const l=hr(o.url);if(l!==t._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${t._responseOrigin}".`);if(!bh(o.status))throw ur(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:wh(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Dr=200,_r=206;function zp(i){const t=i.response;return typeof t!="string"?t:or(t).buffer}class Wp{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=mh(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,a]of this.headers)e.setRequestHeader(r,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=_r):n.expectedStatus=Dr,e.responseType="arraybuffer",Yt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){const s=this.pendingRequests[t];s&&s.onProgress?.(e)}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){s.onError(n.status);return}const r=n.status||Dr;if(!(r===Dr&&s.expectedStatus===_r)&&r!==s.expectedStatus){s.onError(n.status);return}const o=zp(n);if(r===_r){const l=n.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?s.onDone({begin:parseInt(c[1],10),chunk:o}):(pt('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Gp{constructor(t){this._source=t,this._manager=new Wp(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Yt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Xp(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new Kp(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Xp{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=hr(e.responseURL);const s=e.getAllResponseHeaders(),n=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=vh({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=yh(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=ur(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Kp{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=hr(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=ur(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Yp=/^[a-z][a-z0-9\-+.]+:/i;function Jp(i){if(Yp.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class Zp{constructor(t){this.source=t,this.url=Jp(t.url),Yt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Yt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Qp(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new qp(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Qp{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Xn(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Rs("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class qp{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const tg=1e5,be=30,eg=.8;let la=class _e{#t=Promise.withResolvers();#e=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#i=null;#a=0;#l=0;#h=null;#c=null;#d=0;#u=0;#f=Object.create(null);#o=[];#p=null;#m=[];#g=new WeakMap;#v=null;static#y=new Map;static#b=new Map;static#A=new WeakMap;static#x=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:s}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(l){l.enqueue(t),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=s.scale*(globalThis.devicePixelRatio||1),this.#d=s.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:r,pageX:a,pageY:o}=s.rawDims;this.#v=[1,0,0,-1,-a,o+r],this.#l=n,this.#a=r,_e.#L(),Vs(e,s),this.#t.promise.finally(()=>{_e.#S.delete(this),this.#i=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=ge.platform;return Et(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#h.read().then(({value:e,done:s})=>{if(s){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#f,e.styles),this.#T(e.items),t()},this.#t.reject)};return this.#h=this.#p.getReader(),_e.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const s=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==this.#d&&(e?.(),this.#d=n,Vs(this.#c,{rotation:n})),s!==this.#u){e?.(),this.#u=s;const r={div:null,properties:null,ctx:_e.#I(this.#r)};for(const a of this.#m)r.properties=this.#g.get(a),r.div=a,this.#E(r)}}cancel(){const t=new Rs("TextLayer task cancelled.");this.#h?.cancel(t).catch(()=>{}),this.#h=null,this.#t.reject(t)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#o}#T(t){if(this.#s)return;this.#i.ctx??=_e.#I(this.#r);const e=this.#m,s=this.#o;for(const n of t){if(e.length>tg){pt("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const r=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),n.id!==null&&this.#e.setAttribute("id",`${n.id}`),r.append(this.#e)}else n.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(n.str),this.#R(n)}}#R(t){const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#m.push(e);const n=st.transform(this.#v,t.transform);let r=Math.atan2(n[1],n[0]);const a=this.#f[t.fontName];a.vertical&&(r+=Math.PI/2);let o=this.#n&&a.fontSubstitution||a.fontFamily;o=_e.fontFamilyMap.get(o)||o;const l=Math.hypot(n[2],n[3]),c=l*_e.#O(o,this.#r);let h,u;r===0?(h=n[4],u=n[5]-c):(h=n[4]+c*Math.sin(r),u=n[5]-c*Math.cos(r));const d="calc(var(--scale-factor)*",f=e.style;this.#e===this.#c?(f.left=`${(100*h/this.#l).toFixed(2)}%`,f.top=`${(100*u/this.#a).toFixed(2)}%`):(f.left=`${d}${h.toFixed(2)}px)`,f.top=`${d}${u.toFixed(2)}px)`),f.fontSize=`${d}${(_e.#x*l).toFixed(2)}px)`,f.fontFamily=o,s.fontSize=l,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),r!==0&&(s.angle=r*(180/Math.PI));let p=!1;if(t.str.length>1)p=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const g=Math.abs(t.transform[0]),m=Math.abs(t.transform[3]);g!==m&&Math.max(g,m)/Math.min(g,m)>1.5&&(p=!0)}if(p&&(s.canvasWidth=a.vertical?t.height:t.width),this.#g.set(e,s),this.#i.div=e,this.#i.properties=s,this.#E(this.#i),s.hasText&&this.#e.append(e),s.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this.#e.append(g)}}#E(t){const{div:e,properties:s,ctx:n}=t,{style:r}=e;let a="";if(_e.#x>1&&(a=`scale(${1/_e.#x})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:o}=r,{canvasWidth:l,fontSize:c}=s;_e.#P(n,c*this.#u,o);const{width:h}=n.measureText(e.textContent);h>0&&(a=`scaleX(${l*this.#u/h}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)}static cleanup(){if(!(this.#S.size>0)){this.#y.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#I(t=null){let e=this.#b.get(t||="");if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#A.set(e,{size:0,family:""})}return e}static#P(t,e,s){const n=this.#A.get(t);e===n.size&&s===n.family||(t.font=`${e}px ${s}`,n.size=e,n.family=s)}static#L(){if(this.#x!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#x=t.getBoundingClientRect().height,t.remove()}static#O(t,e){const s=this.#y.get(t);if(s)return s;const n=this.#I(e);n.canvas.width=n.canvas.height=be,this.#P(n,be,t);const r=n.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return this.#y.set(t,h),n.canvas.width=n.canvas.height=0,h}n.strokeStyle="red",n.clearRect(0,0,be,be),n.strokeText("g",0,0);let l=n.getImageData(0,0,be,be).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/be);break}n.clearRect(0,0,be,be),n.strokeText("A",0,be),l=n.getImageData(0,0,be,be).data,a=0;for(let h=0,u=l.length;h<u;h+=4)if(l[h]>0){a=be-Math.floor(h/4/be);break}n.canvas.width=n.canvas.height=0;const c=a?a/(a+o):eg;return this.#y.set(t,c),c}};class Yn{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function n(r){if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Yn.shouldBuildText(o))r?.attributes?.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&e.push({str:a}),!!r.children)for(const l of r.children)n(l)}return n(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const sg=65536,ng=100,ig=5e3,rg=he?bp:mp,ag=he?Ap:uh,og=he?yp:vp,lg=he?wp:ph;function cg(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new Ka,{docId:e}=t,s=i.url?hg(i.url):null,n=i.data?ug(i.data):null,r=i.httpHeaders||null,a=i.withCredentials===!0,o=i.password??null,l=i.range instanceof xh?i.range:null,c=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:sg;let h=i.worker instanceof Ei?i.worker:null;const u=i.verbosity,d=typeof i.docBaseUrl=="string"&&!cr(i.docBaseUrl)?i.docBaseUrl:null,f=typeof i.cMapUrl=="string"?i.cMapUrl:null,p=i.cMapPacked!==!1,g=i.CMapReaderFactory||ag,m=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,v=i.StandardFontDataFactory||lg,y=i.stopAtErrors!==!0,w=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,b=i.isEvalSupported!==!1,A=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!he,S=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!he&&(ge.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,R=typeof i.disableFontFace=="boolean"?i.disableFontFace:he,x=i.fontExtraProperties===!0,I=i.enableXfa===!0,M=i.ownerDocument||globalThis.document,H=i.disableRange===!0,B=i.disableStream===!0,W=i.disableAutoFetch===!0,et=i.pdfBug===!0,F=i.CanvasFactory||rg,_=i.FilterFactory||og,Y=i.enableHWA===!0,nt=l?l.length:i.length??NaN,mt=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!he&&!R,wt=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:g===uh&&v===ph&&f&&m&&Pn(f,document.baseURI)&&Pn(m,document.baseURI),rt=null;Kf(u);const xt={canvasFactory:new F({ownerDocument:M,enableHWA:Y}),filterFactory:new _({docId:e,ownerDocument:M}),cMapReaderFactory:wt?null:new g({baseUrl:f,isCompressed:p}),standardFontDataFactory:wt?null:new v({baseUrl:m})};if(!h){const N={verbosity:u,port:Fn.workerPort};h=N.port?Ei.fromPort(N):new Ei(N),t._worker=h}const ne={docId:e,apiVersion:"4.10.38",data:n,password:o,disableAutoFetch:W,rangeChunkSize:c,length:nt,docBaseUrl:d,enableXfa:I,evaluatorOptions:{maxImageSize:w,disableFontFace:R,ignoreErrors:y,isEvalSupported:b,isOffscreenCanvasSupported:A,isImageDecoderSupported:S,canvasMaxAreaInBytes:T,fontExtraProperties:x,useSystemFonts:mt,cMapUrl:wt?f:null,standardFontDataUrl:wt?m:null}},te={disableFontFace:R,fontExtraProperties:x,ownerDocument:M,pdfBug:et,styleElement:rt,loadingParams:{disableAutoFetch:W,enableXfa:I}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const N=h.messageHandler.sendWithPromise("GetDocRequest",ne,n?[n.buffer]:null);let C;if(l)C=new jp(l,{disableRange:H,disableStream:B});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");let L;if(he)if(Pn(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");L=nl}else L=Zp;else L=Pn(s)?nl:Gp;C=new L({url:s,length:nt,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:H,disableStream:B})}return N.then(L=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const K=new Cn(e,L,h.port),tt=new gg(K,t,C,te,xt);t._transport=tt,K.send("Ready",null)})}).catch(t._capability.reject),t}function hg(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(he&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function ug(i){if(he&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return or(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function il(i){return typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0}class Ka{static#t=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ka.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}}let xh=class{constructor(t,e,s=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const s of this._rangeListeners)s(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){_t("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class dg{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Et(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class fg{#t=null;#e=!1;constructor(t,e,s,n=!1){this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=n?new zo:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new Eh,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:r=!1}={}){return new ti({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Et(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:s="display",annotationMode:n=Ss.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:u=!1}){this._stats?.time("Overall");const d=this._transport.getRenderingIntent(s,n,h,u),{renderingIntent:f,cacheKey:p}=d;this.#e=!1,this.#n(),o||=this._transport.getOptionalContentConfig(f);let g=this._intentStates.get(p);g||(g=Object.create(null),this._intentStates.set(p,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const m=!!(f&Me.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d));const v=b=>{g.renderTasks.delete(y),(this._maybeCleanupAfterRender||m)&&(this.#e=!0),this.#s(!m),b?(y.capability.reject(b),this._abortOperatorList({intentState:g,reason:b instanceof Error?b:new Error(b)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new Js({callback:v,params:{canvasContext:t,viewport:e,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!m,pdfBug:this._pdfBug,pageColors:c});(g.renderTasks||=new Set).add(y);const w=y.task;return Promise.all([g.displayReadyCapability.promise,o]).then(([b,A])=>{if(this.destroyed){v();return}if(this._stats?.time("Rendering"),!(A.renderingIntent&f))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:b,optionalContentConfig:A}),y.operatorListChanged()}).catch(v),w}getOperatorList({intent:t="display",annotationMode:e=Ss.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(t,e,s,n,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Yn.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,n){function r(){a.read().then(function({value:l,done:c}){if(c){s(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},n)}const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#e=!1,this.#n(),Promise.all(t)}cleanup(t=!1){this.#e=!0;const e=this.#s(!1);return t&&e&&(this._stats&&=new zo),e}#s(t=!1){if(this.#n(),!this.#e||this.destroyed)return!1;if(t)return this.#t=setTimeout(()=>{this.#t=null,this.#s(!1)},ig),!1;for(const{renderTasks:e,operatorList:s}of this._intentStates.values())if(e.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#n(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(t,e){const s=this._intentStates.get(e);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let s=0,n=t.length;s<n;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:n}){const{map:r,transfer:a}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:n},a).getReader(),c=this._intentStates.get(e);c.streamReader=l;const h=()=>{l.read().then(({value:u,done:d})=>{if(d){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,c),h())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const d of c.renderTasks)d.operatorListChanged();this.#s(!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else if(c.opListReadCapability)c.opListReadCapability.reject(u);else throw u}})};h()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof Ba){let n=ng;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new Rs(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,r]of this._intentStates)if(r===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}class pg{#t=new Map;#e=Promise.resolve();postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[n]of this.#t)n.call(this,s)})}addEventListener(t,e,s=null){let n=null;if(s?.signal instanceof AbortSignal){const{signal:r}=s;if(r.aborted){pt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);n=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}this.#t.set(e,n)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}var Ot,Vi,js,$s,an,Si,on,Ti;let Ei=(Ot=class{constructor({name:t=null,port:e=null,verbosity:s=Yf()}={}){Ls(this,an);if(this.name=t,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(ie(Ot,$s)?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(ie(Ot,$s)||pn(Ot,$s,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Cn("main","worker",t),this._messageHandler.on("ready",function(){}),ni(this,an,Si).call(this)}_initialize(){if(ie(Ot,js)||ie(Ot,on,Ti)){this._setupFakeWorker();return}let{workerSrc:t}=Ot;try{Ot._isSameOrigin(window.location.href,t)||(t=Ot._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new Cn("main","worker",e),n=()=>{r.abort(),s.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;e.addEventListener("error",()=>{this._webWorker||n()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){n();return}this._messageHandler=s,this._port=e,this._webWorker=e,ni(this,an,Si).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){n();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{ar("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){ie(Ot,js)||(pt("Setting up fake worker."),pn(Ot,js,!0)),Ot._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new pg;this._port=e;const s=`fake${co(Ot,Vi)._++}`,n=new Cn(s+"_worker",s,e);t.setup(n,e),this._messageHandler=new Cn(s,s+"_worker",e),ni(this,an,Si).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,ie(Ot,$s)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=ie(this,$s)?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Ot(t)}static get workerSrc(){if(Fn.workerSrc)return Fn.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Et(this,"_setupFakeWorkerGlobal",(async()=>ie(this,on,Ti)?ie(this,on,Ti):(await import(this.workerSrc)).WorkerMessageHandler)())}},Vi=new WeakMap,js=new WeakMap,$s=new WeakMap,an=new WeakSet,Si=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},on=new WeakSet,Ti=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ls(Ot,on),Ls(Ot,Vi,0),Ls(Ot,js,!1),Ls(Ot,$s),he&&(pn(Ot,js,!0),Fn.workerSrc||="./pdf.worker.mjs"),Ot._isSameOrigin=(t,e)=>{let s;try{if(s=new URL(t),!s.origin||s.origin==="null")return!1}catch{return!1}const n=new URL(e,s);return s.origin===n.origin},Ot._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Ot);class gg{#t=new Map;#e=new Map;#s=new Map;#n=new Map;#r=null;constructor(t,e,s,n,r){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Eh,this.fontLoader=new pp({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(t,e=null){const s=this.#t.get(t);if(s)return s;const n=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,n),n}get annotationStorage(){return Et(this,"annotationStorage",new Wa)}getRenderingIntent(t,e=Ss.ENABLE,s=null,n=!1,r=!1){let a=Me.DISPLAY,o=aa;switch(t){case"any":a=Me.ANY;break;case"display":break;case"print":a=Me.PRINT;break;default:pt(`getRenderingIntent - invalid intent: ${t}`)}const l=a&Me.PRINT&&s instanceof lh?s:this.annotationStorage;switch(e){case Ss.DISABLE:a+=Me.ANNOTATIONS_DISABLE;break;case Ss.ENABLE:break;case Ss.ENABLE_FORMS:a+=Me.ANNOTATIONS_FORMS;break;case Ss.ENABLE_STORAGE:a+=Me.ANNOTATIONS_STORAGE,o=l.serializable;break;default:pt(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(a+=Me.IS_EDITING),r&&(a+=Me.OPLIST);const{ids:c,hash:h}=l.modifiedIds,u=[a,o.hash,h];return{renderingIntent:a,cacheKey:u.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),la.cleanup(),this._networkStream?.cancelAllRequests(new Rs("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,n)=>{Yt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},n.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){n.close();return}Yt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{this._fullReader.cancel(r),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:r,contentLength:a}=this._fullReader;return(!n||!r)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{e.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:a}}),t.on("GetRangeReader",(s,n)=>{Yt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){n.close();return}n.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){n.close();return}Yt(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{r.cancel(a),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new dg(s,this))}),t.on("DocException",s=>{e._capability.reject(we(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw we(s);const n=r=>{r instanceof Error?this.#r.reject(r):this.#r.resolve({password:r})};e.onPassword(n,s.code)}catch(n){this.#r.reject(n)}return this.#r.promise}),t.on("DataLoaded",s=>{e.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,n,r])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in r){const d=r.error;pt(`Error during font loading: ${d}`),this.commonObjs.resolve(s,d);break}const c=l&&globalThis.FontInspector?.enabled?(d,f)=>globalThis.FontInspector.fontAdded(d,f):null,h=new gp(r,{disableFontFace:a,fontExtraProperties:o,inspectFont:c});this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!o&&h.data&&(h.data=null),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:u}=r;Yt(u,"The imageRef must be defined.");for(const d of this.#e.values())for(const[,f]of d.objs)if(f?.ref===u)return f.dataLen?(this.commonObjs.resolve(s,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([s,n,r,a])=>{if(this.destroyed)return;const o=this.#e.get(n);if(!o.objs.has(s)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(r){case"Image":o.objs.resolve(s,a),a?.dataLen>zf&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",s=>{this.destroyed||e.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),t.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&pt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=this.#s.get(e);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&this.#n.set(r.refStr,t);const a=new fg(e,r,this,this._params.pdfBug);return this.#e.set(e,a),a});return this.#s.set(e,n),n}getPageIndex(t){return il(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#i("GetOptionalContentConfig").then(e=>new kp(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(n=>({info:n[0],metadata:n[1]?new _p(n[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),la.cleanup()}}cachedPageNumber(t){if(!il(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#n.get(e)??null}}const An=Symbol("INITIAL_DATA");class Eh{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:An}}get(t,e=null){if(e){const n=this.#e(t);return n.promise.then(()=>e(n.data)),null}const s=this.#t[t];if(!s||s.data===An)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=this.#t[t];return!!e&&e.data!==An}delete(t){const e=this.#t[t];return!e||e.data===An?!1:(delete this.#t[t],!0)}resolve(t,e=null){const s=this.#e(t);s.data=e,s.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==An&&(yield[t,e])}}}class mg{#t=null;constructor(t){this.#t=t,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Js{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:s,commonObjs:n,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:h=!1,pdfBug:u=!1,pageColors:d=null}){this.callback=t,this.params=e,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=u,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new mg(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Js.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Js.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:n,transform:r,background:a}=this.params;this.gfx=new sn(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Js.#e.delete(this._canvas),this.callback(t||new Ba(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Js.#e.delete(this._canvas),this.callback())))}}const vg="4.10.38",yg="f9bea397f";Ct(670);function rl(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function wn(i){return Math.max(0,Math.min(255,255*i))}class al{static CMYK_G([t,e,s,n]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=wn(t),[t,t,t]}static G_HTML([t]){const e=rl(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(wn)}static RGB_HTML(t){return`#${t.map(rl).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,s+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,s,n]){return[wn(1-Math.min(1,t+n)),wn(1-Math.min(1,s+n)),wn(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const n=1-t,r=1-e,a=1-s,o=Math.min(n,r,a);return["CMYK",n,r,a,o]}}class bg{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){_t("Abstract method `_createSVG` called.")}}let Ya=class extends bg{_createSVG(t){return document.createElementNS(rs,t)}},Sh=class{static setupStorage(t,e,s,n,r){const a=n.getValue(e,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),r==="print")break;t.addEventListener("input",o=>{n.setValue(e,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?t.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",o=>{n.setValue(e,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),r==="print")break;t.addEventListener("input",o=>{n.setValue(e,{value:o.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;n.setValue(e,{value:c})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:n,linkService:r}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&t.setAttribute(l,c)}o&&r.addLinkAttributes(t,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(t,a.dataId,e,s)}static render(t){const e=t.annotationStorage,s=t.linkService,n=t.xfaHtml,r=t.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:r,linkService:s});const o=r!=="richText",l=t.div;if(l.append(a),t.viewport){const u=`matrix(${t.viewport.transform.join(",")})`;l.style.transform=u}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(n.children.length===0){if(n.value){const u=document.createTextNode(n.value);a.append(u),o&&Yn.shouldBuildText(n.name)&&c.push(u)}return{textDivs:c}}const h=[[n,-1,a]];for(;h.length>0;){const[u,d,f]=h.at(-1);if(d+1===u.children.length){h.pop();continue}const p=u.children[++h.at(-1)[1]];if(p===null)continue;const{name:g}=p;if(g==="#text"){const v=document.createTextNode(p.value);c.push(v),f.append(v);continue}const m=p?.attributes?.xmlns?document.createElementNS(p.attributes.xmlns,g):document.createElement(g);if(f.append(m),p.attributes&&this.setAttributes({html:m,element:p,storage:e,intent:r,linkService:s}),p.children?.length>0)h.push([p,-1,m]);else if(p.value){const v=document.createTextNode(p.value);o&&Yn.shouldBuildText(g)&&c.push(v),m.append(v)}}for(const u of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}};const si=1e3,Ag=9,Us=new WeakSet;function Is(i){return{width:i[2]-i[0],height:i[3]-i[1]}}class wg{static create(t){switch(t.data.annotationType){case Qt.LINK:return new Th(t);case Qt.TEXT:return new xg(t);case Qt.WIDGET:switch(t.data.fieldType){case"Tx":return new Eg(t);case"Btn":return t.data.radioButton?new Ph(t):t.data.checkBox?new Tg(t):new Pg(t);case"Ch":return new Cg(t);case"Sig":return new Sg(t)}return new Ws(t);case Qt.POPUP:return new ca(t);case Qt.FREETEXT:return new Ch(t);case Qt.LINE:return new Rg(t);case Qt.SQUARE:return new Mg(t);case Qt.CIRCLE:return new Lg(t);case Qt.POLYLINE:return new Ih(t);case Qt.CARET:return new Ng(t);case Qt.INK:return new Ja(t);case Qt.POLYGON:return new Og(t);case Qt.HIGHLIGHT:return new Rh(t);case Qt.UNDERLINE:return new Dg(t);case Qt.SQUIGGLY:return new _g(t);case Qt.STRIKEOUT:return new Fg(t);case Qt.STAMP:return new Mh(t);case Qt.FILEATTACHMENT:return new kg(t);default:return new Xt(t)}}}class Xt{#t=null;#e=!1;#s=null;constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:s}){return!!(t?.str||e?.str||s?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Xt._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#n(e),this.#s?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#s?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;s?.splice(0,4,...t);const{width:c,height:h}=Is(t);e.left=`${100*(t[0]-o)/r}%`,e.top=`${100*(a-t[3]+l)/a}%`,n===0?(e.width=`${100*c/r}%`,e.height=`${100*h/a}%`):this.setRotation(n)}_createContainer(t){const{data:e,parent:{page:s,viewport:n}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof Ws||(r.tabIndex=si);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof ca){const{rotation:g}=e;return!e.hasOwnCanvas&&g!==0&&this.setRotation(g,r),r}const{width:o,height:l}=Is(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const g=e.borderStyle.horizontalCornerRadius,m=e.borderStyle.verticalCornerRadius;if(g>0||m>0){const y=`calc(${g}px * var(--scale-factor)) / calc(${m}px * var(--scale-factor))`;a.borderRadius=y}else if(this instanceof Ph){const y=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=y}switch(e.borderStyle.style){case yn.SOLID:a.borderStyle="solid";break;case yn.DASHED:a.borderStyle="dashed";break;case yn.BEVELED:pt("Unimplemented border style: beveled");break;case yn.INSET:pt("Unimplemented border style: inset");break;case yn.UNDERLINE:a.borderBottomStyle="solid";break}const v=e.borderColor||null;v?(this.#e=!0,a.borderColor=st.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const c=st.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:u,pageX:d,pageY:f}=n.rawDims;a.left=`${100*(c[0]-d)/h}%`,a.top=`${100*(c[1]-f)/u}%`;const{rotation:p}=e;return e.hasOwnCanvas||p===0?(a.width=`${100*o/h}%`,a.height=`${100*l/u}%`):this.setRotation(p,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims,{width:r,height:a}=Is(this.data.rect);let o,l;t%180===0?(o=100*r/s,l=100*a/n):(o=100*a/s,l=100*r/n),e.style.width=`${o}%`,e.style.height=`${l}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,n)=>{const r=n.detail[e],a=r[0],o=r.slice(1);n.target.style[s]=al[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:al[`${a}_rgb`](o)})};return Et(this,"_commonActions",{display:e=>{const{display:s}=e.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const n of Object.keys(e.detail))(t[n]||s[n])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[n,r]of Object.entries(e)){const a=s[n];if(a){const o={detail:{[n]:r},target:t};a(o),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,n,r]=this.data.rect.map(g=>Math.fround(g));if(t.length===8){const[g,m,v,y]=t.subarray(2,6);if(n===g&&r===m&&e===v&&s===y)return}const{style:a}=this.container;let o;if(this.#e){const{borderColor:g,borderWidth:m}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${m}">`],this.container.classList.add("hasBorder")}const l=n-e,c=r-s,{svgFactory:h}=this,u=h.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0);const d=h.createElement("defs");u.append(d);const f=h.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let g=2,m=t.length;g<m;g+=8){const v=t[g],y=t[g+1],w=t[g+2],b=t[g+3],A=h.createElement("rect"),S=(w-e)/l,T=(r-y)/c,R=(v-w)/l,x=(y-b)/c;A.setAttribute("x",S),A.setAttribute("y",T),A.setAttribute("width",R),A.setAttribute("height",x),f.append(A),o?.push(`<rect vector-effect="non-scaling-stroke" x="${S}" y="${T}" width="${R}" height="${x}"/>`)}this.#e&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{data:t}=this,e=this.#s=new ca({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){_t("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:r,id:a,exportValues:o}of n){if(r===-1||a===e)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!Us.has(c)){pt(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:l,domElement:c})}return s}for(const n of document.getElementsByName(t)){const{exportValue:r}=n,a=n.getAttribute("data-element-id");a!==e&&Us.has(n)&&s.push({id:a,exportValue:r,domElement:n})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}}class Th extends Xt{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let n=!1;return t.url?(e.addLinkAttributes(s,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(s,t.action),n=!0):t.attachment?(this.#e(s,t.attachment,t.attachmentDest),n=!0):t.setOCGState?(this.#s(s,t.setOCGState),n=!0):t.dest?(this._bindLink(s,t.dest),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),n=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,s=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#s(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const r=s.get(n);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){pt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:n,refs:r,include:a}=e,o=[];if(n.length!==0||r.length!==0){const h=new Set(r);for(const u of n){const d=this._fieldObjects[u]||[];for(const{id:f}of d)h.add(f)}for(const u of Object.values(this._fieldObjects))for(const d of u)h.has(d.id)===a&&o.push(d)}else for(const h of Object.values(this._fieldObjects))o.push(...h);const l=this.annotationStorage,c=[];for(const h of o){const{id:u}=h;switch(c.push(u),h.type){case"text":{const f=h.defaultValue||"";l.setValue(u,{value:f});break}case"checkbox":case"radiobutton":{const f=h.defaultValue===h.exportValues;l.setValue(u,{value:f});break}case"combobox":case"listbox":{const f=h.defaultValue||"";l.setValue(u,{value:f});break}default:continue}const d=document.querySelector(`[data-element-id="${u}"]`);if(d){if(!Us.has(d)){pt(`_bindResetFormAction - element not allowed: ${u}`);continue}}else continue;d.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}}),!1}}}class xg extends Xt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Ws extends Xt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ge.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,n,r){s.includes("mouse")?t.addEventListener(s,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(s,a=>{if(s==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a)}})})}_setEventListeners(t,e,s,n){for(const[r,a]of s)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,r,a,n),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":st.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||Ag,r=t.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(c/(Rr*n))||1,u=c/h;a=Math.min(n,l(u/Rr))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(n,l(c/Rr))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=st.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Eg extends Ws{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,n){const r=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=s),r.setValue(a.id,{[n]:s})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let r=n.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&r.length>a&&(r=r.slice(0,a));let o=n.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:r,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=o??r,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",o??r),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Us.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=si,this._setRequired(s,this.data.required),a&&(s.maxLength=a),s.addEventListener("input",h=>{t.setValue(e,{value:h.target.value}),this.setPropertyOnSiblings(s,"value",h.target.value,"value"),l.formattedValue=null}),s.addEventListener("resetform",h=>{const u=this.data.defaultFieldValue??"";s.value=l.userValue=u,l.formattedValue=null});let c=h=>{const{formattedValue:u}=l;u!=null&&(h.target.value=u),h.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",u=>{if(l.focused)return;const{target:d}=u;l.userValue&&(d.value=l.userValue),l.lastCommittedValue=d.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),s.addEventListener("updatefromsandbox",u=>{this.showElementAndHideCanvas(u.target);const d={value(f){l.userValue=f.detail.value??"",t.setValue(e,{value:l.userValue.toString()}),f.target.value=l.userValue},formattedValue(f){const{formattedValue:p}=f.detail;l.formattedValue=p,p!=null&&f.target!==document.activeElement&&(f.target.value=p),t.setValue(e,{formattedValue:p})},selRange(f){f.target.setSelectionRange(...f.detail.selRange)},charLimit:f=>{const{charLimit:p}=f.detail,{target:g}=f;if(p===0){g.removeAttribute("maxLength");return}g.setAttribute("maxLength",p);let m=l.userValue;!m||m.length<=p||(m=m.slice(0,p),g.value=l.userValue=m,t.setValue(e,{value:m}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:1,selStart:g.selectionStart,selEnd:g.selectionEnd}}))}};this._dispatchEventFromSandbox(d,u)}),s.addEventListener("keydown",u=>{l.commitKey=1;let d=-1;if(u.key==="Escape"?d=0:u.key==="Enter"&&!this.data.multiLine?d=2:u.key==="Tab"&&(l.commitKey=3),d===-1)return;const{value:f}=u.target;l.lastCommittedValue!==f&&(l.lastCommittedValue=f,l.userValue=f,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:f,willCommit:!0,commitKey:d,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}))});const h=c;c=null,s.addEventListener("blur",u=>{if(!l.focused||!u.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:d}=u.target;l.userValue=d,l.lastCommittedValue!==d&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,willCommit:!0,commitKey:l.commitKey,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}),h(u)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",u=>{l.lastCommittedValue=null;const{data:d,target:f}=u,{value:p,selectionStart:g,selectionEnd:m}=f;let v=g,y=m;switch(u.inputType){case"deleteWordBackward":{const w=p.substring(0,g).match(/\w*[^\w]*$/);w&&(v-=w[0].length);break}case"deleteWordForward":{const w=p.substring(g).match(/^[^\w]*\w*/);w&&(y+=w[0].length);break}case"deleteContentBackward":g===m&&(v-=1);break;case"deleteContentForward":g===m&&(y+=1);break}u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:p,change:d||"",willCommit:!1,selStart:v,selEnd:y}})}),this._setEventListeners(s,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.value)}if(c&&s.addEventListener("blur",c),this.data.comb){const u=(this.data.rect[2]-this.data.rect[0])/a;s.classList.add("comb"),s.style.letterSpacing=`calc(${u}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Sg extends Ws{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Tg extends Ws{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Us.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=si,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s)){const h=l&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=h),t.setValue(c.id,{value:h})}t.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=e.defaultFieldValue||"Off";a.target.checked=o===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",t.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Ph extends Ws{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(s,{value:n})),n)for(const a of this._getElementsByName(e.fieldName,s))t.setValue(a.id,{value:!1});const r=document.createElement("input");if(Us.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.tabIndex=si,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s))t.setValue(c.id,{value:!1});t.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=o!=null&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const h=a===c.detail.value;for(const u of this._getElementsByName(c.target.name)){const d=h&&u.id===s;u.domElement&&(u.domElement.checked=d),t.setValue(u.id,{value:d})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Pg extends Th{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class Cg extends Ws{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");Us.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=si;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const u=this.data.defaultFieldValue;for(const d of n.options)d.selected=d.value===u});for(const h of this.data.options){const u=document.createElement("option");u.textContent=h.displayValue,u.value=h.exportValue,s.value.includes(h.exportValue)&&(u.setAttribute("selected",!0),r=!1),n.append(u)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),a=()=>{h.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const o=h=>{const u=h?"value":"textContent",{options:d,multiple:f}=n;return f?Array.prototype.filter.call(d,p=>p.selected).map(p=>p[u]):d.selectedIndex===-1?null:d[d.selectedIndex][u]};let l=o(!1);const c=h=>{const u=h.target.options;return Array.prototype.map.call(u,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const u={value(d){a?.();const f=d.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(const g of n.options)g.selected=p.has(g.value);t.setValue(e,{value:o(!0)}),l=o(!1)},multipleSelection(d){n.multiple=!0},remove(d){const f=n.options,p=d.detail.remove;f[p].selected=!1,n.remove(p),f.length>0&&Array.prototype.findIndex.call(f,m=>m.selected)===-1&&(f[0].selected=!0),t.setValue(e,{value:o(!0),items:c(d)}),l=o(!1)},clear(d){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),l=o(!1)},insert(d){const{index:f,displayValue:p,exportValue:g}=d.detail.insert,m=n.children[f],v=document.createElement("option");v.textContent=p,v.value=g,m?m.before(v):n.append(v),t.setValue(e,{value:o(!0),items:c(d)}),l=o(!1)},items(d){const{items:f}=d.detail;for(;n.length!==0;)n.remove(0);for(const p of f){const{displayValue:g,exportValue:m}=p,v=document.createElement("option");v.textContent=g,v.value=m,n.append(v)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(d)}),l=o(!1)},indices(d){const f=new Set(d.detail.indices);for(const p of d.target.options)p.selected=f.has(p.index);t.setValue(e,{value:o(!0)}),l=o(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(u,h)}),n.addEventListener("input",h=>{const u=o(!0),d=o(!1);t.setValue(e,{value:u}),h.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:l,change:d,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class ca extends Xt{constructor(t){const{data:e,elements:s}=t;super(t,{isRenderable:Xt._hasPopupData(e)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new Ig({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",e.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(s=>`${$a}${s}`).join(",")),this.container}}class Ig{#t=this.#T.bind(this);#e=this.#P.bind(this);#s=this.#I.bind(this);#n=this.#E.bind(this);#r=null;#i=null;#a=null;#l=null;#h=null;#c=null;#d=null;#u=!1;#f=null;#o=null;#p=null;#m=null;#g=null;#v=null;#y=!1;constructor({container:t,color:e,elements:s,titleObj:n,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:h,open:u}){this.#i=t,this.#g=n,this.#a=a,this.#m=o,this.#c=l,this.#r=e,this.#p=c,this.#d=h,this.#h=s,this.#l=ih.toDateObject(r),this.trigger=s.flatMap(d=>d.getElementsToTriggerPopup());for(const d of this.trigger)d.addEventListener("click",this.#n),d.addEventListener("mouseenter",this.#s),d.addEventListener("mouseleave",this.#e),d.classList.add("popupTriggerArea");for(const d of s)d.container?.addEventListener("keydown",this.#t);this.#i.hidden=!0,u&&this.#E()}render(){if(this.#f)return;const t=this.#f=document.createElement("div");if(t.className="popup",this.#r){const r=t.style.outlineColor=st.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:t.style.backgroundColor=st.makeHexColor(...this.#r.map(o=>Math.floor(.7*(255-o)+o)))}const e=document.createElement("span");e.className="header";const s=document.createElement("h1");if(e.append(s),{dir:s.dir,str:s.textContent}=this.#g,t.append(e),this.#l){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#l.valueOf()})),e.append(r)}const n=this.#b;if(n)Sh.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(this.#a);t.append(r)}this.#i.append(t)}get#b(){const t=this.#m,e=this.#a;return t?.str&&(!e?.str||e.str===t.str)&&this.#m.html||null}get#A(){return this.#b?.attributes?.style?.fontSize||0}get#x(){return this.#b?.attributes?.style?.color||null}#S(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:this.#x,fontSize:this.#A?`calc(${this.#A}px * var(--scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:n});return s}_formatContents({str:t,dir:e}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=e;const n=t.split(/(?:\r\n?|\n)/);for(let r=0,a=n.length;r<a;++r){const o=n[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}#T(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#u)&&this.#E()}updateEdited({rect:t,popupContent:e}){this.#v||={contentsObj:this.#a,richText:this.#m},t&&(this.#o=null),e&&(this.#m=this.#S(e),this.#a=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#v&&({contentsObj:this.#a,richText:this.#m}=this.#v,this.#v=null,this.#f?.remove(),this.#f=null,this.#o=null)}#R(){if(this.#o!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:n,pageY:r}}}=this.#c;let a=!!this.#d,o=a?this.#d:this.#p;for(const p of this.#h)if(!o||st.intersect(p.data.rect,o)!==null){o=p.data.rect,a=!0;break}const l=st.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]),h=a?o[2]-o[0]+5:0,u=l[0]+h,d=l[1];this.#o=[100*(u-n)/e,100*(d-r)/s];const{style:f}=this.#i;f.left=`${this.#o[0]}%`,f.top=`${this.#o[1]}%`}#E(){this.#u=!this.#u,this.#u?(this.#I(),this.#i.addEventListener("click",this.#n),this.#i.addEventListener("keydown",this.#t)):(this.#P(),this.#i.removeEventListener("click",this.#n),this.#i.removeEventListener("keydown",this.#t))}#I(){this.#f||this.render(),this.isVisible?this.#u&&this.#i.classList.add("focused"):(this.#R(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#P(){this.#i.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#y=this.isVisible,this.#y&&(this.#i.hidden=!0)}maybeShow(){this.#y&&(this.#f||this.#I(),this.#y=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class Ch extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=At.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Rg extends Xt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:s}=Is(t.rect),n=this.svgFactory.create(e,s,!0),r=this.#t=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Mg extends Xt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:s}=Is(t.rect),n=this.svgFactory.create(e,s,!0),r=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",e-r),a.setAttribute("height",s-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Lg extends Xt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:s}=Is(t.rect),n=this.svgFactory.create(e,s,!0),r=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",s/2),a.setAttribute("rx",e/2-r/2),a.setAttribute("ry",s/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ih extends Xt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:s,popupRef:n}}=this;if(!e)return this.container;const{width:r,height:a}=Is(t),o=this.svgFactory.create(r,a,!0);let l=[];for(let h=0,u=e.length;h<u;h+=2){const d=e[h]-t[0],f=t[3]-e[h+1];l.push(`${d},${f}`)}l=l.join(" ");const c=this.#t=this.svgFactory.createElement(this.svgElementName);return c.setAttribute("points",l),c.setAttribute("stroke-width",s.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c),this.container.append(o),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Og extends Ih{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ng extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ja extends Xt{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?At.HIGHLIGHT:At.INK}#s(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:s,borderStyle:n,popupRef:r}}=this,{transform:a,width:o,height:l}=this.#s(e,t),c=this.svgFactory.create(o,l,!0),h=this.#t=this.svgFactory.createElement("svg:g");c.append(h),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let u=0,d=s.length;u<d;u++){const f=this.svgFactory.createElement(this.svgElementName);this.#e.push(f),f.setAttribute("points",s[u].join(",")),h.append(f)}return!r&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:s,rect:n}=t,r=this.#t;if(e>=0&&r.setAttribute("stroke-width",e||1),s)for(let a=0,o=this.#e.length;a<o;a++)this.#e[a].setAttribute("points",s[a].join(","));if(n){const{transform:a,width:o,height:l}=this.#s(this.data.rotation,n);r.parentElement.setAttribute("viewBox",`0 0 ${o} ${l}`),r.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Rh extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=At.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Dg extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class _g extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Fg extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Mh extends Xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=At.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class kg extends Xt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let s;e.hasAppearance||e.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:n}=ge.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(n?r.metaKey:r.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let jg=class{#t=null;#e=null;#s=new Map;#n=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:n,page:r,viewport:a,structTreeLayer:o}){this.div=t,this.#t=e,this.#e=s,this.#n=o||null,this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return this.#s.size>0}async#r(t,e){const s=t.firstChild||t,n=s.id=`${$a}${e}`,r=await this.#n?.getAriaAttributes(n);if(r)for(const[a,o]of r)s.setAttribute(a,o);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1)}async render(t){const{annotations:e}=t,s=this.div;Vs(s,this.viewport);const n=new Map,r={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Ya,annotationStorage:t.annotationStorage||new Wa,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const o=a.annotationType===Qt.POPUP;if(o){const h=n.get(a.id);if(!h)continue;r.elements=h}else{const{width:h,height:u}=Is(a.rect);if(h<=0||u<=0)continue}r.data=a;const l=wg.create(r);if(!l.isRenderable)continue;if(!o&&a.popupRef){const h=n.get(a.popupRef);h?h.push(l):n.set(a.popupRef,[l])}const c=l.render();a.hidden&&(c.style.visibility="hidden"),await this.#r(c,a.id),l._isEditable&&(this.#s.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#i()}update({viewport:t}){const e=this.div;this.viewport=t,Vs(e,{rotation:t.rotation}),this.#i(),e.hidden=!1}#i(){if(!this.#e)return;const t=this.div;for(const[e,s]of this.#e){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:r}=n;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):n.append(s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(t){return this.#s.get(t)}};const hi=/\r\n?|\n/g;class qt extends lt{#t;#e="";#s=`${this.id}-editor`;#n=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=qt.prototype,e=r=>r.isEmpty(),s=Kn.TRANSLATE_SMALL,n=Kn.TRANSLATE_BIG;return Et(this,"_keyboardManager",new ei([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}]]))}static _type="freetext";static _editorType=At.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||qt._defaultColor||lt._defaultLineColor,this.#r=t.fontSize||qt._defaultFontSize}static initialize(t,e){lt.initialize(t,e);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case St.FREETEXT_SIZE:qt._defaultFontSize=e;break;case St.FREETEXT_COLOR:qt._defaultColor=e;break}}updateParams(t,e){switch(t){case St.FREETEXT_SIZE:this.#i(e);break;case St.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[St.FREETEXT_SIZE,qt._defaultFontSize],[St.FREETEXT_COLOR,qt._defaultColor||lt._defaultLineColor]]}get propertiesToUpdate(){return[[St.FREETEXT_SIZE,this.#r],[St.FREETEXT_COLOR,this.#t]]}#i(t){const e=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-this.#r)*this.parentScale),this.#r=n,this.#h()},s=this.#r;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#a(t){const e=n=>{this.#t=this.editorDiv.style.color=n},s=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-qt._internalPadding*t,-(qt._internalPadding+this.#r)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(At.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#l(){const t=[];this.editorDiv.normalize();let e=null;for(const s of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(qt.#c(s)),e=s);return t.join(`
`)}#h(){const[t,e]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:r}=this,a=r.style.display,o=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",n.div.append(this.div),s=r.getBoundingClientRect(),r.remove(),r.style.display=a,r.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/e):(this.width=s.height/t,this.height=s.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#l().trimEnd();if(t===e)return;const s=n=>{if(this.#e=n,!n){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#h()};this.addCommands({cmd:()=>{s(e)},undo:()=>{s(t)},mustExec:!1}),this.#h()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){qt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Fi(this,this.div,["dblclick","keydown"]),this.width){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);const[c,h]=this.pageDimensions,[u,d]=this.pageTranslation;let f,p;switch(this.rotation){case 0:f=t+(a[0]-u)/c,p=e+this.height-(a[1]-d)/h;break;case 90:f=t+(a[0]-u)/c,p=e-(a[1]-d)/h,[o,l]=[l,-o];break;case 180:f=t-this.width+(a[0]-u)/c,p=e-(a[1]-d)/h,[o,l]=[-o,-l];break;case 270:f=t+(a[0]-u-this.height*h)/c,p=e+(a[1]-d-this.width*c)/h,[o,l]=[-l,o];break}this.setAt(f*n,p*r,o,l)}else this.setAt(t*n,e*r,this.width*n,this.height*r);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(hi,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:s}=e;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const n=qt.#f(e.getData("text")||"").replaceAll(hi,`
`);if(!n)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const a=r.getRangeAt(0);if(!n.includes(`
`)){a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:o,startOffset:l}=a,c=[],h=[];if(o.nodeType===Node.TEXT_NODE){const f=o.parentElement;if(h.push(o.nodeValue.slice(l).replaceAll(hi,"")),f!==this.editorDiv){let p=c;for(const g of this.editorDiv.childNodes){if(g===f){p=h;continue}p.push(qt.#c(g))}}c.push(o.nodeValue.slice(0,l).replaceAll(hi,""))}else if(o===this.editorDiv){let f=c,p=0;for(const g of this.editorDiv.childNodes)p++===l&&(f=h),f.push(qt.#c(g))}this.#e=`${c.join(`
`)}${n}${h.join(`
`)}`,this.#d();const u=new Range;let d=c.reduce((f,p)=>f+p.length,0);for(const{firstChild:f}of this.editorDiv.childNodes)if(f.nodeType===Node.TEXT_NODE){const p=f.nodeValue.length;if(d<=p){u.setStart(f,d),u.setEnd(f,d);break}d-=p}r.removeAllRanges(),r.addRange(u)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(""," ")}static#f(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,s){let n=null;if(t instanceof Ch){const{data:{defaultAppearanceData:{fontSize:a,fontColor:o},rect:l,rotation:c,id:h,popupRef:u},textContent:d,textPosition:f,parent:{page:{pageNumber:p}}}=t;if(!d||d.length===0)return null;n=t={annotationType:At.FREETEXT,color:Array.from(o),fontSize:a,value:d.join(`
`),position:f,pageIndex:p-1,rect:l.slice(0),rotation:c,id:h,deleted:!1,popupRef:u}}const r=await super.deserialize(t,e,s);return r.#r=t.fontSize,r.#t=st.makeHexColor(...t.color),r.#e=qt.#f(t.value),r.annotationElementId=t.id||null,r._initialData=n,r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=qt._internalPadding*this.parentScale,s=this.getRect(e,e),n=lt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),r={annotationType:At.FREETEXT,color:n,fontSize:this.#r,value:this.#u(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?r:this.annotationElementId&&!this.#o(r)?null:(r.id=this.annotationElementId,r)}#o(t){const{value:e,fontSize:s,color:n,pageIndex:r}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==s||t.color.some((a,o)=>a!==n[o])||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:s}=e;s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#t,e.replaceChildren();for(const r of this.#e.split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),e.append(a)}const n=qt._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(n,n),popupContent:this.#e}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class q{static PRECISION=1e-4;toSVGPath(){_t("Abstract method `toSVGPath` must be implemented.")}get box(){_t("Abstract getter `box` must be implemented.")}serialize(t,e){_t("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,n,r,a){a||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=e+t[o]*n,a[o+1]=s+t[o+1]*r;return a}static _rescaleAndSwap(t,e,s,n,r,a){a||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=e+t[o+1]*n,a[o+1]=s+t[o]*r;return a}static _translate(t,e,s,n){n||=new Float32Array(t.length);for(let r=0,a=t.length;r<a;r+=2)n[r]=e+t[r],n[r+1]=s+t[r+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,n,r){switch(r){case 90:return[1-e/s,t/n];case 180:return[1-t/s,1-e/n];case 270:return[e/s,1-t/n];default:return[t/s,e/n]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,n,r,a){return[(t+5*s)/6,(e+5*n)/6,(5*s+r)/6,(5*n+a)/6,(s+r)/2,(n+a)/2]}}class ks{#t;#e=[];#s;#n;#r=[];#i=new Float32Array(18);#a;#l;#h;#c;#d;#u;#f=[];static#o=8;static#p=2;static#m=ks.#o+ks.#p;constructor({x:t,y:e},s,n,r,a,o=0){this.#t=s,this.#u=r*n,this.#n=a,this.#i.set([NaN,NaN,NaN,NaN,t,e],6),this.#s=o,this.#c=ks.#o*n,this.#h=ks.#m*n,this.#d=n,this.#f.push(t,e)}isEmpty(){return isNaN(this.#i[8])}#g(){const t=this.#i.subarray(4,6),e=this.#i.subarray(16,18),[s,n,r,a]=this.#t;return[(this.#a+(t[0]-e[0])/2-s)/r,(this.#l+(t[1]-e[1])/2-n)/a,(this.#a+(e[0]-t[0])/2-s)/r,(this.#l+(e[1]-t[1])/2-n)/a]}add({x:t,y:e}){this.#a=t,this.#l=e;const[s,n,r,a]=this.#t;let[o,l,c,h]=this.#i.subarray(8,12);const u=t-c,d=e-h,f=Math.hypot(u,d);if(f<this.#h)return!1;const p=f-this.#c,g=p/f,m=g*u,v=g*d;let y=o,w=l;o=c,l=h,c+=m,h+=v,this.#f?.push(t,e);const b=-v/p,A=m/p,S=b*this.#u,T=A*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([c+S,h+T],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([c-S,h-T],16),isNaN(this.#i[6])?(this.#r.length===0&&(this.#i.set([o+S,l+T],2),this.#r.push(NaN,NaN,NaN,NaN,(o+S-s)/r,(l+T-n)/a),this.#i.set([o-S,l-T],14),this.#e.push(NaN,NaN,NaN,NaN,(o-S-s)/r,(l-T-n)/a)),this.#i.set([y,w,o,l,c,h],6),!this.isEmpty()):(this.#i.set([y,w,o,l,c,h],6),Math.abs(Math.atan2(w-l,y-o)-Math.atan2(v,m))<Math.PI/2?([o,l,c,h]=this.#i.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((o+c)/2-s)/r,((l+h)/2-n)/a),[o,l,y,w]=this.#i.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((y+o)/2-s)/r,((w+l)/2-n)/a),!0):([y,w,o,l,c,h]=this.#i.subarray(0,6),this.#r.push(((y+5*o)/6-s)/r,((w+5*l)/6-n)/a,((5*o+c)/6-s)/r,((5*l+h)/6-n)/a,((o+c)/2-s)/r,((l+h)/2-n)/a),[c,h,o,l,y,w]=this.#i.subarray(12,18),this.#e.push(((y+5*o)/6-s)/r,((w+5*l)/6-n)/a,((5*o+c)/6-s)/r,((5*l+h)/6-n)/a,((o+c)/2-s)/r,((l+h)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#v();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);this.#b(s);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return this.#y(s),s.join(" ")}#v(){const[t,e,s,n]=this.#t,[r,a,o,l]=this.#g();return`M${(this.#i[2]-t)/s} ${(this.#i[3]-e)/n} L${(this.#i[4]-t)/s} ${(this.#i[5]-e)/n} L${r} ${a} L${o} ${l} L${(this.#i[16]-t)/s} ${(this.#i[17]-e)/n} L${(this.#i[14]-t)/s} ${(this.#i[15]-e)/n} Z`}#y(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,s,n,r]=this.#t,a=this.#i.subarray(4,6),o=this.#i.subarray(16,18),[l,c,h,u]=this.#g();t.push(`L${(a[0]-e)/n} ${(a[1]-s)/r} L${l} ${c} L${h} ${u} L${(o[0]-e)/n} ${(o[1]-s)/r}`)}newFreeDrawOutline(t,e,s,n,r,a){return new Lh(t,e,s,n,r,a)}getOutlines(){const t=this.#r,e=this.#e,s=this.#i,[n,r,a,o]=this.#t,l=new Float32Array((this.#f?.length??0)+2);for(let u=0,d=l.length-2;u<d;u+=2)l[u]=(this.#f[u]-n)/a,l[u+1]=(this.#f[u+1]-r)/o;if(l[l.length-2]=(this.#a-n)/a,l[l.length-1]=(this.#l-r)/o,isNaN(s[6])&&!this.isEmpty())return this.#A(l);const c=new Float32Array(this.#r.length+24+this.#e.length);let h=t.length;for(let u=0;u<h;u+=2){if(isNaN(t[u])){c[u]=c[u+1]=NaN;continue}c[u]=t[u],c[u+1]=t[u+1]}h=this.#S(c,h);for(let u=e.length-6;u>=6;u-=6)for(let d=0;d<6;d+=2){if(isNaN(e[u+d])){c[h]=c[h+1]=NaN,h+=2;continue}c[h]=e[u+d],c[h+1]=e[u+d+1],h+=2}return this.#x(c,h),this.newFreeDrawOutline(c,l,this.#t,this.#d,this.#s,this.#n)}#A(t){const e=this.#i,[s,n,r,a]=this.#t,[o,l,c,h]=this.#g(),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(e[2]-s)/r,(e[3]-n)/a,NaN,NaN,NaN,NaN,(e[4]-s)/r,(e[5]-n)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,(e[16]-s)/r,(e[17]-n)/a,NaN,NaN,NaN,NaN,(e[14]-s)/r,(e[15]-n)/a],0),this.newFreeDrawOutline(u,t,this.#t,this.#d,this.#s,this.#n)}#x(t,e){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6}#S(t,e){const s=this.#i.subarray(4,6),n=this.#i.subarray(16,18),[r,a,o,l]=this.#t,[c,h,u,d]=this.#g();return t.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(n[0]-r)/o,(n[1]-a)/l],e),e+=24}}class Lh extends q{#t;#e=new Float32Array(4);#s;#n;#r;#i;#a;constructor(t,e,s,n,r,a){super(),this.#a=t,this.#r=e,this.#t=s,this.#i=n,this.#s=r,this.#n=a,this.lastPoint=[NaN,NaN],this.#l(a);const[o,l,c,h]=this.#e;for(let u=0,d=t.length;u<d;u+=2)t[u]=(t[u]-o)/c,t[u+1]=(t[u+1]-l)/h;for(let u=0,d=e.length;u<d;u+=2)e[u]=(e[u]-o)/c,e[u+1]=(e[u+1]-l)/h}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,s=this.#a.length;e<s;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,s,n],r){const a=s-t,o=n-e;let l,c;switch(r){case 0:l=q._rescale(this.#a,t,n,a,-o),c=q._rescale(this.#r,t,n,a,-o);break;case 90:l=q._rescaleAndSwap(this.#a,t,e,a,o),c=q._rescaleAndSwap(this.#r,t,e,a,o);break;case 180:l=q._rescale(this.#a,s,e,-a,o),c=q._rescale(this.#r,s,e,-a,o);break;case 270:l=q._rescaleAndSwap(this.#a,s,n,-a,-o),c=q._rescaleAndSwap(this.#r,s,n,-a,-o);break}return{outline:Array.from(l),points:[Array.from(c)]}}#l(t){const e=this.#a;let s=e[4],n=e[5],r=s,a=n,o=s,l=n,c=s,h=n;const u=t?Math.max:Math.min;for(let f=6,p=e.length;f<p;f+=6){if(isNaN(e[f]))r=Math.min(r,e[f+4]),a=Math.min(a,e[f+5]),o=Math.max(o,e[f+4]),l=Math.max(l,e[f+5]),h<e[f+5]?(c=e[f+4],h=e[f+5]):h===e[f+5]&&(c=u(c,e[f+4]));else{const g=st.bezierBoundingBox(s,n,...e.slice(f,f+6));r=Math.min(r,g[0]),a=Math.min(a,g[1]),o=Math.max(o,g[2]),l=Math.max(l,g[3]),h<g[3]?(c=g[2],h=g[3]):h===g[3]&&(c=u(c,g[2]))}s=e[f+4],n=e[f+5]}const d=this.#e;d[0]=r-this.#s,d[1]=a-this.#s,d[2]=o-r+2*this.#s,d[3]=l-a+2*this.#s,this.lastPoint=[c,h]}get box(){return this.#e}newOutliner(t,e,s,n,r,a=0){return new ks(t,e,s,n,r,a)}getNewOutline(t,e){const[s,n,r,a]=this.#e,[o,l,c,h]=this.#t,u=r*c,d=a*h,f=s*c+o,p=n*h+l,g=this.newOutliner({x:this.#r[0]*u+f,y:this.#r[1]*d+p},this.#t,this.#i,t,this.#n,e??this.#s);for(let m=2;m<this.#r.length;m+=2)g.add({x:this.#r[m]*u+f,y:this.#r[m+1]*d+p});return g.getOutlines()}}class ha{#t;#e;#s=[];#n=[];constructor(t,e=0,s=0,n=!0){let r=1/0,a=-1/0,o=1/0,l=-1/0;const c=10**-4;for(const{x:m,y:v,width:y,height:w}of t){const b=Math.floor((m-e)/c)*c,A=Math.ceil((m+y+e)/c)*c,S=Math.floor((v-e)/c)*c,T=Math.ceil((v+w+e)/c)*c,R=[b,S,T,!0],x=[A,S,T,!1];this.#s.push(R,x),r=Math.min(r,b),a=Math.max(a,A),o=Math.min(o,S),l=Math.max(l,T)}const h=a-r+2*s,u=l-o+2*s,d=r-s,f=o-s,p=this.#s.at(n?-1:-2),g=[p[0],p[2]];for(const m of this.#s){const[v,y,w]=m;m[0]=(v-d)/h,m[1]=(y-f)/u,m[2]=(w-f)/u}this.#t=new Float32Array([d,f,h,u]),this.#e=g}getOutlines(){this.#s.sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of this.#s)e[3]?(t.push(...this.#h(e)),this.#a(e)):(this.#l(e),t.push(...this.#h(e)));return this.#r(t)}#r(t){const e=[],s=new Set;for(const a of t){const[o,l,c]=a;e.push([o,l,a],[o,c,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const l=e[a][2],c=e[a+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const n=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,l,c,h,u]=a;s.delete(a);let d=o,f=l;for(r=[o,c],n.push(r);;){let p;if(s.has(h))p=h;else if(s.has(u))p=u;else break;s.delete(p),[o,l,c,h,u]=p,d!==o&&(r.push(d,f,o,f===l?l:c),d=o),f=f===l?c:l}r.push(d,f)}return new $g(n,this.#t,this.#e)}#i(t){const e=this.#n;let s=0,n=e.length-1;for(;s<=n;){const r=s+n>>1,a=e[r][0];if(a===t)return r;a<t?s=r+1:n=r-1}return n+1}#a([,t,e]){const s=this.#i(t);this.#n.splice(s,0,[t,e])}#l([,t,e]){const s=this.#i(t);for(let n=s;n<this.#n.length;n++){const[r,a]=this.#n[n];if(r!==t)break;if(r===t&&a===e){this.#n.splice(n,1);return}}for(let n=s-1;n>=0;n--){const[r,a]=this.#n[n];if(r!==t)break;if(r===t&&a===e){this.#n.splice(n,1);return}}}#h(t){const[e,s,n]=t,r=[[e,s,n]],a=this.#i(n);for(let o=0;o<a;o++){const[l,c]=this.#n[o];for(let h=0,u=r.length;h<u;h++){const[,d,f]=r[h];if(!(c<=d||f<=l)){if(d>=l){if(f>c)r[h][1]=c;else{if(u===1)return[];r.splice(h,1),h--,u--}continue}r[h][2]=l,f>c&&r.push([e,c,f])}}}return r}}class $g extends q{#t;#e;constructor(t,e,s){super(),this.#e=t,this.#t=e,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[s,n]=e;t.push(`M${s} ${n}`);for(let r=2;r<e.length;r+=2){const a=e[r],o=e[r+1];a===s?(t.push(`V${o}`),n=o):o===n&&(t.push(`H${a}`),s=a)}t.push("Z")}return t.join(" ")}serialize([t,e,s,n],r){const a=[],o=s-t,l=n-e;for(const c of this.#e){const h=new Array(c.length);for(let u=0;u<c.length;u+=2)h[u]=t+c[u]*o,h[u+1]=n-c[u+1]*l;a.push(h)}return a}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class ua extends ks{newFreeDrawOutline(t,e,s,n,r,a){return new Bg(t,e,s,n,r,a)}}class Bg extends Lh{newOutliner(t,e,s,n,r,a=0){return new ua(t,e,s,n,r,a)}}let Oh=class Ye{#t=null;#e=null;#s;#n=null;#r=!1;#i=!1;#a=null;#l;#h=null;#c=null;#d;static#u=null;static get _keyboardManager(){return Et(this,"_keyboardManager",new ei([[["Escape","mac+Escape"],Ye.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ye.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ye.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ye.prototype._moveToPrevious],[["Home","mac+Home"],Ye.prototype._moveToBeginning],[["End","mac+End"],Ye.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#i=!1,this.#d=St.HIGHLIGHT_COLOR,this.#a=t):(this.#i=!0,this.#d=St.HIGHLIGHT_DEFAULT_COLOR),this.#c=t?._uiManager||e,this.#l=this.#c._eventBus,this.#s=t?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",Ye.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#c._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#p.bind(this),{signal:e});const s=this.#e=document.createElement("span");return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=this.#s,t.append(s),t}renderMainDropdown(){const t=this.#n=this.#f();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#f(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",Ve,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,n]of this.#c.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",n),r.title=s,r.setAttribute("data-l10n-id",Ye.#u[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=n,r.setAttribute("aria-selected",n===this.#s),r.addEventListener("click",this.#o.bind(this,n),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#p.bind(this),{signal:e}),t}#o(t,e){e.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#o(e,t)}_moveToNext(t){if(!this.#v){this.#m(t);return}if(t.target===this.#t){this.#n.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstChild||t.target===this.#t){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#v){this.#m(t);return}this.#n.firstChild?.focus()}_moveToEnd(t){if(!this.#v){this.#m(t);return}this.#n.lastChild?.focus()}#p(t){Ye._keyboardManager.exec(this,t)}#m(t){if(this.#v){this.hideDropdown();return}if(this.#r=t.detail===0,this.#h||(this.#h=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#c.combinedSignal(this.#h)})),this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#f();this.#t.append(e)}#g(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#h?.abort(),this.#h=null}get#v(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#v){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#c.highlightColors.values();for(const s of this.#n.children)s.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}};class zt extends lt{#t=null;#e=0;#s;#n=null;#r=null;#i=null;#a=null;#l=0;#h=null;#c=null;#d=null;#u=!1;#f=null;#o;#p=null;#m="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=At.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=zt.prototype;return Et(this,"_keyboardManager",new ei([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||zt._defaultColor,this.#g=t.thickness||zt._defaultThickness,this.#o=t.opacity||zt._defaultOpacity,this.#s=t.boxes||null,this.#v=t.methodOfCreation||"",this.#m=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#u=!0,this.#b(t),this.#R()):this.#s&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#l=t.focusOffset,this.#y(),this.#R(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#y(){const t=new ha(this.#s,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new ha(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#i=e.getOutlines();const{lastPoint:s}=this.#i;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:s}){this.#c=t;const n=1.5;if(this.#i=t.getNewOutline(this.#g/2+n,.0025),e>=0)this.#d=e,this.#n=s,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:zt.#E(this.#c.box,(h-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:zt.#E(this.#i.box,h),path:{d:this.#i.toSVGPath()}})}const[r,a,o,l]=t.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=o,this.height=l;break;case 90:{const[h,u]=this.parentDimensions;this.x=a,this.y=1-r,this.width=o*u/h,this.height=l*h/u;break}case 180:this.x=1-r,this.y=1-a,this.width=o,this.height=l;break;case 270:{const[h,u]=this.parentDimensions;this.x=1-a,this.y=r,this.width=o*u/h,this.height=l*h/u;break}}const{lastPoint:c}=this.#i;this.#f=[(c[0]-r)/o,(c[1]-a)/l]}static initialize(t,e){lt.initialize(t,e),zt._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case St.HIGHLIGHT_DEFAULT_COLOR:zt._defaultColor=e;break;case St.HIGHLIGHT_THICKNESS:zt._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#f}updateParams(t,e){switch(t){case St.HIGHLIGHT_COLOR:this.#A(e);break;case St.HIGHLIGHT_THICKNESS:this.#x(e);break}}static get defaultPropertiesToUpdate(){return[[St.HIGHLIGHT_DEFAULT_COLOR,zt._defaultColor],[St.HIGHLIGHT_THICKNESS,zt._defaultThickness]]}get propertiesToUpdate(){return[[St.HIGHLIGHT_COLOR,this.color||zt._defaultColor],[St.HIGHLIGHT_THICKNESS,this.#g||zt._defaultThickness],[St.HIGHLIGHT_FREE,this.#u]]}#A(t){const e=(r,a)=>{this.color=r,this.#o=a,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:r,"fill-opacity":a}}),this.#r?.updateColor(r)},s=this.color,n=this.#o;this.addCommands({cmd:e.bind(this,t,zt._defaultOpacity),undo:e.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#x(t){const e=this.#g,s=n=>{this.#g=n,this.#S(n)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:St.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#r=new Oh({editor:this}),t.addColorPicker(this.#r)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#L())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#L())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#R(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#T():t&&(this.#R(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){if(!this.#u)return;this.#b({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,s]=this.parentDimensions;this.setDims(this.width*e,this.height*s)}#T(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#R(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#o},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#h&&(this.#h.style.clipPath=this.#n))}static#E([t,e,s,n],r){switch(r){case 90:return[1-e-n,t,n,s];case 180:return[1-t-s,1-e-n,s,n];case 270:return[e,1-t-s,n,s]}return[t,e,s,n]}rotate(t){const{drawLayer:e}=this.parent;let s;this.#u?(t=(t-this.rotation+360)%360,s=zt.#E(this.#c.box,t)):s=zt.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:zt.#E(this.#i.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#m&&(t.setAttribute("aria-label",this.#m),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#I.bind(this),{signal:this._uiManager._signal});const e=this.#h=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n;const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),Fi(this,this.#h,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#I(t){zt._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#P(!0);break;case 1:case 3:this.#P(!1);break}}#P(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#l)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#P(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#L(){return this.#u?this.rotation:0}#O(){if(this.#u)return null;const[t,e]=this.pageDimensions,[s,n]=this.pageTranslation,r=this.#s,a=new Float32Array(r.length*8);let o=0;for(const{x:l,y:c,width:h,height:u}of r){const d=l*t+s,f=(1-c)*e+n;a[o]=a[o+4]=d,a[o+1]=a[o+3]=f,a[o+2]=a[o+6]=d+h*t,a[o+5]=a[o+7]=f-u*e,o+=8}return a}#_(t){return this.#c.serialize(t,this.#L())}static startHighlighting(t,e,{target:s,x:n,y:r}){const{x:a,y:o,width:l,height:c}=s.getBoundingClientRect(),h=new AbortController,u=t.combinedSignal(h),d=f=>{h.abort(),this.#w(t,f)};window.addEventListener("blur",d,{signal:u}),window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("pointerdown",Le,{capture:!0,passive:!1,signal:u}),window.addEventListener("contextmenu",Ve,{signal:u}),s.addEventListener("pointermove",this.#C.bind(this,t),{signal:u}),this._freeHighlight=new ua({x:n,y:r},[a,o,l,c],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#C(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#w(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,s){let n=null;if(t instanceof Rh){const{data:{quadPoints:p,rect:g,rotation:m,id:v,color:y,opacity:w,popupRef:b},parent:{page:{pageNumber:A}}}=t;n=t={annotationType:At.HIGHLIGHT,color:Array.from(y),opacity:w,quadPoints:p,boxes:null,pageIndex:A-1,rect:g.slice(0),rotation:m,id:v,deleted:!1,popupRef:b}}else if(t instanceof Ja){const{data:{inkLists:p,rect:g,rotation:m,id:v,color:y,borderStyle:{rawWidth:w},popupRef:b},parent:{page:{pageNumber:A}}}=t;n=t={annotationType:At.HIGHLIGHT,color:Array.from(y),thickness:w,inkLists:p,boxes:null,pageIndex:A-1,rect:g.slice(0),rotation:m,id:v,deleted:!1,popupRef:b}}const{color:r,quadPoints:a,inkLists:o,opacity:l}=t,c=await super.deserialize(t,e,s);c.color=st.makeHexColor(...r),c.#o=l||1,o&&(c.#g=t.thickness),c.annotationElementId=t.id||null,c._initialData=n;const[h,u]=c.pageDimensions,[d,f]=c.pageTranslation;if(a){const p=c.#s=[];for(let g=0;g<a.length;g+=8)p.push({x:(a[g]-d)/h,y:1-(a[g+1]-f)/u,width:(a[g+2]-a[g])/h,height:(a[g+1]-a[g+5])/u});c.#y(),c.#R(),c.rotate(c.rotation)}else if(o){c.#u=!0;const p=o[0],g={x:p[0]-d,y:u-(p[1]-f)},m=new ua(g,[0,0,h,u],1,c.#g/2,!0,.001);for(let w=0,b=p.length;w<b;w+=2)g.x=p[w]-d,g.y=u-(p[w+1]-f),m.add(g);const{id:v,clipPathId:y}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:m.toSVGPath()}},!0,!0);c.#b({highlightOutlines:m.getOutlines(),highlightId:v,clipPathId:y}),c.#R()}return c}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),s=lt._colorManager.convert(this.color),n={annotationType:At.HIGHLIGHT,color:s,opacity:this.#o,thickness:this.#g,quadPoints:this.#O(),outlines:this.#_(e),pageIndex:this.pageIndex,rect:e,rotation:this.#L(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#F(n)?null:(n.id=this.annotationElementId,n)}#F(t){const{color:e}=this._initialData;return t.color.some((s,n)=>s!==e[n])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Hg{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))this.updateProperty(e,s)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){_t("Not implemented")}}class ot extends lt{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#n=null;static#r=null;static#i=NaN;static#a=null;static#l=null;static#h=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,t.drawOutlines&&(this.#c(t),this.#f())}#c({drawOutlines:t,drawId:e,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#m(t.box)}#d(t,e){const{id:s}=e.drawLayer.draw(ot._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,e){const s=new Set(Object.keys(t));for(const[n,r]of Object.entries(e))s.has(n)?Object.assign(t[n],r):t[n]=r;return t}static getDefaultDrawingOptions(t){_t("Not implemented")}static get typesMap(){_t("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,e),this._currentParent&&(ot.#s.updateProperty(s,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[s,n]of this.typesMap)t.push([s,e[n]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[s,n]of this.constructor.typesMap)t.push([s,e[n]]);return t}_updateProperty(t,e,s){const n=this._drawingOptions,r=n[e],a=o=>{n.updateProperty(e,o);const l=this.#t.updateProperty(e,o);l&&this.#m(l),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ot._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ot._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g(t,e)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ot._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#m(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#o([t,e,s,n]){const{parentDimensions:[r,a],rotation:o}=this;switch(o){case 90:return[e,1-t,s*(a/r),n*(r/a)];case 180:return[1-t,1-e,s,n];case 270:return[1-e,t,s*(a/r),n*(r/a)];default:return[t,e,s,n]}}#p(){const{x:t,y:e,width:s,height:n,parentDimensions:[r,a],rotation:o}=this;switch(o){case 90:return[1-e,t,s*(r/a),n*(a/r)];case 180:return[1-t,1-e,s,n];case 270:return[e,1-t,s*(r/a),n*(a/r)];default:return[t,e,s,n]}}#m(t){if([this.x,this.y,this.width,this.height]=this.#o(t),this.div){this.fixAndSetPosition();const[e,s]=this.parentDimensions;this.setDims(this.width*e,this.height*s)}this._onResized()}#g(){const{x:t,y:e,width:s,height:n,rotation:r,parentRotation:a,parentDimensions:[o,l]}=this;switch((r*4+a)/90){case 1:return[1-e-n,t,n,s];case 2:return[1-t-s,1-e-n,s,n];case 3:return[e,1-t-s,n,s];case 4:return[t,e-s*(o/l),n*(l/o),s*(o/l)];case 5:return[1-e,t,s*(o/l),n*(l/o)];case 6:return[1-t-n*(l/o),1-e,n*(l/o),s*(o/l)];case 7:return[e-s*(o/l),1-t-n*(l/o),s*(o/l),n*(l/o)];case 8:return[t-s,e-n,s,n];case 9:return[1-e,t-s,n,s];case 10:return[1-t,1-e,s,n];case 11:return[e-n,1-t,n,s];case 12:return[t-n*(l/o),e,n*(l/o),s*(o/l)];case 13:return[1-e-s*(o/l),t-n*(l/o),s*(o/l),n*(l/o)];case 14:return[1-t,1-e-s*(o/l),n*(l/o),s*(o/l)];case 15:return[e,1-t,s*(o/l),n*(l/o)];default:return[t,e,s,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ot._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const e=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal";const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,e,s,n,r){_t("Not implemented")}static startDrawing(t,e,s,n){const{target:r,offsetX:a,offsetY:o,pointerId:l,pointerType:c}=n;if(ot.#a&&ot.#a!==c)return;const{viewport:{rotation:h}}=t,{width:u,height:d}=r.getBoundingClientRect(),f=ot.#n=new AbortController,p=t.combinedSignal(f);if(ot.#i||=l,ot.#a??=c,window.addEventListener("pointerup",g=>{ot.#i===g.pointerId?this._endDraw(g):ot.#l?.delete(g.pointerId)},{signal:p}),window.addEventListener("pointercancel",g=>{ot.#i===g.pointerId?this._currentParent.endDrawingSession():ot.#l?.delete(g.pointerId)},{signal:p}),window.addEventListener("pointerdown",g=>{ot.#a===g.pointerType&&((ot.#l||=new Set).add(g.pointerId),ot.#s.isCancellable()&&(ot.#s.removeLastElement(),ot.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Ve,{signal:p}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),r.addEventListener("touchmove",g=>{g.timeStamp===ot.#h&&Le(g)},{signal:p}),t.toggleDrawing(),e._editorUndoBar?.hide(),ot.#s){t.drawLayer.updateProperties(this._currentDrawId,ot.#s.startNew(a,o,u,d,h));return}e.updateUIForDefaultProperties(this),ot.#s=this.createDrawerInstance(a,o,u,d,h),ot.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(ot.#r.toSVGProperties(),ot.#s.defaultSVGProperties),!0,!1)}static _drawMove(t){if(ot.#h=-1,!ot.#s)return;const{offsetX:e,offsetY:s,pointerId:n}=t;if(ot.#i===n){if(ot.#l?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,ot.#s.add(e,s)),ot.#h=t.timeStamp,Le(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,ot.#s=null,ot.#r=null,ot.#a=null,ot.#h=NaN),ot.#n&&(ot.#n.abort(),ot.#n=null,ot.#i=NaN,ot.#l=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t&&e.drawLayer.updateProperties(this._currentDrawId,ot.#s.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=ot.#s,n=this._currentDrawId,r=s.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(n,s.setLastElement(r))},undo:()=>{e.drawLayer.updateProperties(n,s.removeLastElement())},mustExec:!1,type:St.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(St.DRAW_STEP),!ot.#s.isEmpty()){const{pageDimensions:[s,n],scale:r}=e,a=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:ot.#s.getOutlines(s*r,n*r,r,this._INNER_MARGIN),drawingOptions:ot.#r,mustBeCommitted:!t});return this._cleanup(!0),a}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,s,n,r,a){_t("Not implemented")}static async deserialize(t,e,s){const{rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:o}}=e.viewport,l=this.deserializeDraw(a,o,n,r,this._INNER_MARGIN,t),c=await super.deserialize(t,e,s);return c.createDrawingOptions(t),c.#c({drawOutlines:l}),c.#f(),c.onScaleChanging(),c.rotate(),c}serializeDraw(t){const[e,s]=this.pageTranslation,[n,r]=this.pageDimensions;return this.#t.serialize([e,s,n,r],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Vg{#t=new Float64Array(6);#e;#s;#n;#r;#i;#a="";#l=0;#h=new dr;#c;#d;constructor(t,e,s,n,r,a){this.#c=s,this.#d=n,this.#n=r,this.#r=a,[t,e]=this.#u(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e],this.#s=[{line:o,points:this.#i}],this.#t.set(o,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#u(t,e){return q._normalizePoint(t,e,this.#c,this.#d,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#i.length<=10}add(t,e){[t,e]=this.#u(t,e);const[s,n,r,a]=this.#t.subarray(2,6),o=t-r,l=e-a;return Math.hypot(this.#c*o,this.#d*l)<=2?null:(this.#i.push(t,e),isNaN(s)?(this.#t.set([r,a,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,n,r,a,t,e],0),this.#e.push(...q.createBezierPoints(s,n,r,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,n,r){this.#c=s,this.#d=n,this.#n=r,[t,e]=this.#u(t,e);const a=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e];const o=this.#s.at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),this.#s.push({line:a,points:this.#i}),this.#t.set(a,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(t){return this.#s?(this.#s.push(t),this.#e=t.line,this.#i=t.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#h.setLastElement(t)}removeLastElement(){if(!this.#s)return this.#h.removeLastElement();this.#s.pop(),this.#a="";for(let t=0,e=this.#s.length;t<e;t++){const{line:s,points:n}=this.#s[t];this.#e=s,this.#i=n,this.#l=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=q.svgRound(this.#e[4]),e=q.svgRound(this.#e[5]);if(this.#i.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#i.length<=6){const n=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,n)} M ${t} ${e}`,this.#l=6}if(this.#i.length===4){const n=q.svgRound(this.#e[10]),r=q.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${n} ${r}`,this.#l=12,this.#a}const s=[];this.#l===0&&(s.push(`M ${t} ${e}`),this.#l=6);for(let n=this.#l,r=this.#e.length;n<r;n+=6){const[a,o,l,c,h,u]=this.#e.slice(n,n+6).map(q.svgRound);s.push(`C${a} ${o} ${l} ${c} ${h} ${u}`)}return this.#a+=s.join(" "),this.#l=this.#e.length,this.#a}getOutlines(t,e,s,n){const r=this.#s.at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),this.#h.build(this.#s,t,e,s,this.#n,this.#r,n),this.#t=null,this.#e=null,this.#s=null,this.#a=null,this.#h}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class dr extends q{#t;#e=0;#s;#n;#r;#i;#a;#l;#h;build(t,e,s,n,r,a,o){this.#r=e,this.#i=s,this.#a=n,this.#l=r,this.#h=a,this.#s=o??0,this.#n=t,this.#u()}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${q.svgRound(e[4])} ${q.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12){t.push(`L${q.svgRound(e[10])} ${q.svgRound(e[11])}`);continue}for(let s=6,n=e.length;s<n;s+=6){const[r,a,o,l,c,h]=e.subarray(s,s+6).map(q.svgRound);t.push(`C${r} ${a} ${o} ${l} ${c} ${h}`)}}return t.join("")}serialize([t,e,s,n],r){const a=[],o=[],[l,c,h,u]=this.#d();let d,f,p,g,m,v,y,w,b;switch(this.#l){case 0:b=q._rescale,d=t,f=e+n,p=s,g=-n,m=t+l*s,v=e+(1-c-u)*n,y=t+(l+h)*s,w=e+(1-c)*n;break;case 90:b=q._rescaleAndSwap,d=t,f=e,p=s,g=n,m=t+c*s,v=e+l*n,y=t+(c+u)*s,w=e+(l+h)*n;break;case 180:b=q._rescale,d=t+s,f=e,p=-s,g=n,m=t+(1-l-h)*s,v=e+c*n,y=t+(1-l)*s,w=e+(c+u)*n;break;case 270:b=q._rescaleAndSwap,d=t+s,f=e+n,p=-s,g=-n,m=t+(1-c-u)*s,v=e+(1-l-h)*n,y=t+(1-c)*s,w=e+(1-l)*n;break}for(const{line:A,points:S}of this.#n)a.push(b(A,d,f,p,g,r?new Array(A.length):null)),o.push(b(S,d,f,p,g,r?new Array(S.length):null));return{lines:a,points:o,rect:[m,v,y,w]}}static deserialize(t,e,s,n,r,{paths:{lines:a,points:o},rotation:l,thickness:c}){const h=[];let u,d,f,p,g;switch(l){case 0:g=q._rescale,u=-t/s,d=e/n+1,f=1/s,p=-1/n;break;case 90:g=q._rescaleAndSwap,u=-e/n,d=-t/s,f=1/n,p=1/s;break;case 180:g=q._rescale,u=t/s+1,d=-e/n,f=-1/s,p=1/n;break;case 270:g=q._rescaleAndSwap,u=e/n+1,d=t/s+1,f=-1/n,p=-1/s;break}if(!a){a=[];for(const v of o){const y=v.length;if(y===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(y===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const w=new Float32Array(3*(y-2));a.push(w);let[b,A,S,T]=v.subarray(0,4);w.set([NaN,NaN,NaN,NaN,b,A],0);for(let R=4;R<y;R+=2){const x=v[R],I=v[R+1];w.set(q.createBezierPoints(b,A,S,T,x,I),(R-2)*3),[b,A,S,T]=[S,T,x,I]}}}for(let v=0,y=a.length;v<y;v++)h.push({line:g(a[v].map(w=>w??NaN),u,d,f,p),points:g(o[v].map(w=>w??NaN),u,d,f,p)});const m=new dr;return m.build(h,s,n,1,l,c,r),m}#c(t=this.#h){const e=this.#s+t/2*this.#a;return this.#l%180===0?[e/this.#r,e/this.#i]:[e/this.#i,e/this.#r]}#d(){const[t,e,s,n]=this.#t,[r,a]=this.#c(0);return[t+r,e+a,s-2*r,n-2*a]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#n){if(n.length<=12){for(let o=4,l=n.length;o<l;o+=6){const[c,h]=n.subarray(o,o+2);t[0]=Math.min(t[0],c),t[1]=Math.min(t[1],h),t[2]=Math.max(t[2],c),t[3]=Math.max(t[3],h)}continue}let r=n[4],a=n[5];for(let o=6,l=n.length;o<l;o+=6){const[c,h,u,d,f,p]=n.subarray(o,o+6);st.bezierBoundingBox(r,a,c,h,u,d,f,p,t),r=f,a=p}}const[e,s]=this.#c();t[0]=Math.min(1,Math.max(0,t[0]-e)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+e)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,s]=this.#c();this.#h=t;const[n,r]=this.#c(),[a,o]=[n-e,r-s],l=this.#t;return l[0]-=a,l[1]-=o,l[2]+=2*a,l[3]+=2*o,l}updateParentDimensions([t,e],s){const[n,r]=this.#c();this.#r=t,this.#i=e,this.#a=s;const[a,o]=this.#c(),l=a-n,c=o-r,h=this.#t;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(q.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${q.svgRound(t)} ${q.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let s=0,n=0,r=0,a=0,o=0,l=0;switch(this.#e){case 90:n=e/t,r=-t/e,o=t;break;case 180:s=-1,a=-1,o=t,l=e;break;case 270:n=-e/t,r=t/e,l=e;break;default:return""}return`matrix(${s} ${n} ${r} ${a} ${q.svgRound(o)} ${q.svgRound(l)})`}getPathResizingSVGProperties([t,e,s,n]){const[r,a]=this.#c(),[o,l,c,h]=this.#t;if(Math.abs(c-r)<=q.PRECISION||Math.abs(h-a)<=q.PRECISION){const g=t+s/2-(o+c/2),m=e+n/2-(l+h/2);return{path:{"transform-origin":`${q.svgRound(t)} ${q.svgRound(e)}`,transform:`${this.rotationTransform} translate(${g} ${m})`}}}const u=(s-2*r)/(c-2*r),d=(n-2*a)/(h-2*a),f=c/s,p=h/n;return{path:{"transform-origin":`${q.svgRound(o)} ${q.svgRound(l)}`,transform:`${this.rotationTransform} scale(${f} ${p}) translate(${q.svgRound(r)} ${q.svgRound(a)}) scale(${u} ${d}) translate(${q.svgRound(-r)} ${q.svgRound(-a)})`}}}getPathResizedSVGProperties([t,e,s,n]){const[r,a]=this.#c(),o=this.#t,[l,c,h,u]=o;if(o[0]=t,o[1]=e,o[2]=s,o[3]=n,Math.abs(h-r)<=q.PRECISION||Math.abs(u-a)<=q.PRECISION){const m=t+s/2-(l+h/2),v=e+n/2-(c+u/2);for(const{line:y,points:w}of this.#n)q._translate(y,m,v,y),q._translate(w,m,v,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${q.svgRound(t)} ${q.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const d=(s-2*r)/(h-2*r),f=(n-2*a)/(u-2*a),p=-d*(l+r)+t+r,g=-f*(c+a)+e+a;if(d!==1||f!==1||p!==0||g!==0)for(const{line:m,points:v}of this.#n)q._rescale(m,p,g,d,f,m),q._rescale(v,p,g,d,f,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${q.svgRound(t)} ${q.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],s){const[n,r]=s,a=this.#t,o=t-a[0],l=e-a[1];if(this.#r===n&&this.#i===r)for(const{line:c,points:h}of this.#n)q._translate(c,o,l,c),q._translate(h,o,l,h);else{const c=this.#r/n,h=this.#i/r;this.#r=n,this.#i=r;for(const{line:u,points:d}of this.#n)q._rescale(u,o,l,c,h,u),q._rescale(d,o,l,c,h,d);a[2]*=c,a[3]*=h}return a[0]=t,a[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${q.svgRound(t)} ${q.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${q.svgRound(t[0])} ${q.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Za extends Hg{#t;constructor(t){super(),this.#t=t,super.updateProperties({fill:"none",stroke:lt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this.#t.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Za(this.#t);return t.updateAll(this),t}}class Qa extends ot{static _type="ink";static _editorType=At.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(t,e){lt.initialize(t,e),this._defaultDrawingOptions=new Za(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Et(this,"typesMap",new Map([[St.INK_THICKNESS,"stroke-width"],[St.INK_COLOR,"stroke"],[St.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,s,n,r){return new Vg(t,e,s,n,r,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,s,n,r,a){return dr.deserialize(t,e,s,n,r,a)}static async deserialize(t,e,s){let n=null;if(t instanceof Ja){const{data:{inkLists:a,rect:o,rotation:l,id:c,color:h,opacity:u,borderStyle:{rawWidth:d},popupRef:f},parent:{page:{pageNumber:p}}}=t;n=t={annotationType:At.INK,color:Array.from(h),thickness:d,opacity:u,paths:{points:a},boxes:null,pageIndex:p-1,rect:o.slice(0),rotation:l,id:c,deleted:!1,popupRef:f}}const r=await super.deserialize(t,e,s);return r.annotationElementId=t.id||null,r._initialData=n,r}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:s}=this;e.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:s}){this._drawingOptions=Qa.getDefaultDrawingOptions({stroke:st.makeHexColor(...t),"stroke-width":e,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:s,rect:n}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,l={annotationType:At.INK,color:lt._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:e,points:s},pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?l:this.annotationElementId&&!this.#t(l)?null:(l.id=this.annotationElementId,l)}#t(t){const{color:e,thickness:s,opacity:n,pageIndex:r}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,o)=>a!==e[o])||t.thickness!==s||t.opacity!==n||t.pageIndex!==r}renderAnnotationElement(t){const{points:e,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class qa extends lt{#t=null;#e=null;#s=null;#n=null;#r=null;#i="";#a=null;#l=null;#h=!1;#c=!1;static _type="stamp";static _editorType=At.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#r=t.bitmapFile}static initialize(t,e){lt.initialize(t,e)}static get supportedTypes(){return Et(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(e=>`image/${e}`))}static get supportedTypesStr(){return Et(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(At.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#d(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#h=t.isSvg),t.file&&(this.#i=t.file.name),this.#o()}#u(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:r,height:a}=t||this.copyCanvas(null,null,!0).imageData,o=await s.guess({name:"altText",request:{data:n,width:r,height:a,channels:n.length/(r*a)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");const l=o.output;return await this.setGuessedAltText(l),e&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}#f(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#d(s,!0)).finally(()=>this.#u());return}if(this.#n){const s=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(s).then(n=>this.#d(n)).finally(()=>this.#u());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(s).then(n=>this.#d(n)).finally(()=>this.#u());return}const t=document.createElement("input");t.type="file",t.accept=qa.supportedTypesStr;const e=this._uiManager._signal;this.#s=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(n)}s()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:e})}).finally(()=>this.#u()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#f();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#s||this.#t||this.#n||this.#r||this.#e)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#t?this.#o():this.#f(),this.width&&!this.annotationElementId){const[s,n]=this.parentDimensions;this.setAt(t*s,e*n,this.width*s,this.height*n)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#l!==null&&clearTimeout(this.#l);const t=200;this.#l=setTimeout(()=>{this.#l=null,this.#m()},t)}#o(){const{div:t}=this;let{width:e,height:s}=this.#t;const[n,r]=this.pageDimensions,a=.75;if(this.width)e=this.width*n,s=this.height*r;else if(e>a*n||s>a*r){const h=Math.min(a*n/e,a*r/s);e*=h,s*=h}const[o,l]=this.parentDimensions;this.setDims(e*o/n,s*l/r),this._uiManager.enableWaiting(!1);const c=this.#a=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=e/n,this.height=s/r,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&c.setAttribute("aria-label",this.#i)}copyCanvas(t,e,s=!1){t||(t=224);const{width:n,height:r}=this.#t,a=new ia;let o=this.#t,l=n,c=r,h=null;if(e){if(n>e||r>e){const S=Math.min(e/n,e/r);l=Math.floor(n*S),c=Math.floor(r*S)}h=document.createElement("canvas");const d=h.width=Math.ceil(l*a.sx),f=h.height=Math.ceil(c*a.sy);this.#h||(o=this.#p(d,f));const p=h.getContext("2d");p.filter=this._uiManager.hcmFilter;let g="white",m="#cfcfd8";this._uiManager.hcmFilter!=="none"?m="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(g="#8f8f9d",m="#42414d");const v=15,y=v*a.sx,w=v*a.sy,b=new OffscreenCanvas(y*2,w*2),A=b.getContext("2d");A.fillStyle=g,A.fillRect(0,0,y*2,w*2),A.fillStyle=m,A.fillRect(0,0,y,w),A.fillRect(y,w,y,w),p.fillStyle=p.createPattern(b,"repeat"),p.fillRect(0,0,d,f),p.drawImage(o,0,0,o.width,o.height,0,0,d,f)}let u=null;if(s){let d,f;if(a.symmetric&&o.width<t&&o.height<t)d=o.width,f=o.height;else if(o=this.#t,n>t||r>t){const m=Math.min(t/n,t/r);d=Math.floor(n*m),f=Math.floor(r*m),this.#h||(o=this.#p(d,f))}const g=new OffscreenCanvas(d,f).getContext("2d",{willReadFrequently:!0});g.drawImage(o,0,0,o.width,o.height,0,0,d,f),u={width:d,height:f,data:g.getImageData(0,0,d,f).data}}return{canvas:h,width:l,height:c,imageData:u}}#p(t,e){const{width:s,height:n}=this.#t;let r=s,a=n,o=this.#t;for(;r>2*t||a>2*e;){const l=r,c=a;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(r,a);h.getContext("2d").drawImage(o,0,0,l,c,0,0,r,a),o=h.transferToImageBitmap()}return o}#m(){const[t,e]=this.parentDimensions,{width:s,height:n}=this,r=new ia,a=Math.ceil(s*t*r.sx),o=Math.ceil(n*e*r.sy),l=this.#a;if(!l||l.width===a&&l.height===o)return;l.width=a,l.height=o;const c=this.#h?this.#t:this.#p(a,o),h=l.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(c,0,0,c.width,c.height,0,0,a,o)}getImageForAltText(){return this.#a}#g(t){if(t){if(this.#h){const n=this._uiManager.imageManager.getSvgUrl(this.#e);if(n)return n}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#h){const[e,s]=this.pageDimensions,n=Math.round(this.width*e*un.PDF_TO_CSS_UNITS),r=Math.round(this.height*s*un.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,r);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,n,r),a.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,s){let n=null;if(t instanceof Mh){const{data:{rect:p,rotation:g,id:m,structParent:v,popupRef:y},container:w,parent:{page:{pageNumber:b}}}=t,A=w.querySelector("canvas"),S=s.imageManager.getFromCanvas(w.id,A);A.remove();const T=(await e._structTree.getAriaAttributes(`${$a}${m}`))?.get("aria-label")||"";n=t={annotationType:At.STAMP,bitmapId:S.id,bitmap:S.bitmap,pageIndex:b-1,rect:p.slice(0),rotation:g,id:m,deleted:!1,accessibilityData:{decorative:!1,altText:T},isSvg:!1,structParent:v,popupRef:y}}const r=await super.deserialize(t,e,s),{rect:a,bitmap:o,bitmapUrl:l,bitmapId:c,isSvg:h,accessibilityData:u}=t;c&&s.imageManager.isValidId(c)?(r.#e=c,o&&(r.#t=o)):r.#n=l,r.#h=h;const[d,f]=r.pageDimensions;return r.width=(a[2]-a[0])/d,r.height=(a[3]-a[1])/f,r.annotationElementId=t.id||null,u&&(r.altTextData=u),r._initialData=n,r.#c=!!n,r}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:At.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#h,structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=this.#g(!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:n,altText:r}=this.serializeAltText(!1);if(!n&&r&&(s.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const o=this.#v(s);if(o.isSame)return null;o.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,e===null)return s;e.stamps||=new Map;const a=this.#h?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:a,serialized:s}),s.bitmap=this.#g(!1);else if(this.#h){const o=e.stamps.get(this.#e);a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=this.#g(!1))}return s}#v(t){const{pageIndex:e,accessibilityData:{altText:s}}=this._initialData,n=t.pageIndex===e,r=(t.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&n&&r,isSameAltText:r}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}let Ug=class bs{#t;#e=!1;#s=null;#n=null;#r=null;#i=new Map;#a=!1;#l=!1;#h=!1;#c=null;#d=null;#u=null;#f=null;#o;static _initialized=!1;static#p=new Map([qt,Qa,qa,zt].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:n,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:h}){const u=[...bs.#p.values()];if(!bs._initialized){bs._initialized=!0;for(const d of u)d.initialize(h,t)}t.registerEditorTypes(u),this.#o=t,this.pageIndex=e,this.div=s,this.#t=r,this.#s=a,this.viewport=c,this.#u=l,this.drawLayer=o,this._structTree=n,this.#o.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#o.getMode()===At.NONE}updateToolbar(t){this.#o.updateToolbar(t)}updateMode(t=this.#o.getMode()){switch(this.#b(),t){case At.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case At.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case At.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const s of bs.#p.values())e.toggle(`${s._type}Editing`,t===s._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#o.setEditingState(t)}addCommands(t){this.#o.addCommands(t)}cleanUndoStack(t){this.#o.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#s?.div.classList.toggle("disabled",!t)}async enable(){this.#h=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const s of this.#i.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#o.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));if(!this.#s){this.#h=!1;return}const e=this.#s.getEditableAnnotations();for(const s of e){if(s.hide(),this.#o.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const n=await this.deserialize(s);n&&(this.addOrRebuild(n),n.enableEditing())}this.#h=!1}disable(){this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of this.#i.values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){t.set(n.annotationElementId,n);continue}else e.set(n.annotationElementId,n);this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()}if(this.#s){const n=this.#s.getEditableAnnotations();for(const r of n){const{id:a}=r.data;if(this.#o.isDeletedAnnotationElement(a))continue;let o=e.get(a);if(o){o.resetAnnotationElement(r),o.show(!1),r.show();continue}o=t.get(a),o&&(this.#o.addChangedExistingAnnotation(o),o.renderAnnotationElement(r)&&o.show(!1)),r.show()}}this.#b(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const n of bs.#p.values())s.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#l=!1}getEditableAnnotation(t){return this.#s?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#o.getActive()!==t&&this.#o.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const t=this.#o.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#m.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#m(t){this.#o.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:s}=ge.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#o.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),zt.startHighlighting(this,this.#o.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#o._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#o.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#i.set(t.id,t);const{annotationElementId:e}=t;e&&this.#o.isDeletedAnnotationElement(e)&&this.#o.removeDeletedAnnotationElement(t)}detach(t){this.#i.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#l&&t.annotationElementId&&this.#o.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#o.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#o.addDeletedAnnotationElement(t.annotationElementId),lt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#o.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#h),this.#o.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#o._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getNextId(){return this.#o.getId()}get#g(){return bs.#p.get(this.#o.getMode())}combinedSignal(t){return this.#o.combinedSignal(t)}#v(t){const e=this.#g;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#g?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#o.updateToolbar(t),this.#o.updateMode(t);const{offsetX:s,offsetY:n}=this.#y(),r=this.getNextId(),a=this.#v({parent:this,id:r,x:s,y:n,uiManager:this.#o,isCentered:!0,...e});a&&this.add(a)}async deserialize(t){return await bs.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#o)||null}createAndAddNewEditor(t,e,s={}){const n=this.getNextId(),r=this.#v({parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:this.#o,isCentered:e,...s});return r&&this.add(r),r}#y(){const{x:t,y:e,width:s,height:n}=this.div.getBoundingClientRect(),r=Math.max(0,t),a=Math.max(0,e),o=Math.min(window.innerWidth,t+s),l=Math.min(window.innerHeight,e+n),c=(r+o)/2-t,h=(a+l)/2-e,[u,d]=this.viewport.rotation%180===0?[c,h]:[h,c];return{offsetX:u,offsetY:d}}addNewEditor(){this.createAndAddNewEditor(this.#y(),!0)}setSelected(t){this.#o.setSelected(t)}toggleSelected(t){this.#o.toggleSelected(t)}unselect(t){this.#o.unselect(t)}pointerup(t){const{isMac:e}=ge.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&this.#a&&(this.#a=!1,!(this.#g?.isDrawer&&this.#g.supportMultipleDrawings))){if(!this.#e){this.#e=!0;return}if(this.#o.getMode()===At.STAMP){this.#o.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#o.getMode()===At.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=ge.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#g?.isDrawer){this.startDrawingSession(t);return}const s=this.#o.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus(),this.#c){this.#g.startDrawing(this,this.#o,!1,t);return}this.#o.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#o.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#g.startDrawing(this,this.#o,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#c?(this.#o.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#g.endDrawing(t)):null}findNewParent(t,e,s){const n=this.#o.findParent(e,s);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#g.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#o.getActive()?.parent===this&&(this.#o.commitOrRemove(),this.#o.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#i.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#i.clear(),this.#o.removeLayer(this)}#b(){for(const t of this.#i.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Vs(this.div,t);for(const e of this.#o.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#o.commitOrRemove(),this.#b();const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,Vs(this.div,{rotation:s}),e!==s)for(const n of this.#i.values())n.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#o.viewParameters.realScale}},zg=class Ae{#t=null;#e=0;#s=new Map;#n=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#s.size>0)for(const e of this.#s.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Et(this,"_svgFactory",new Ya)}static#r(t,[e,s,n,r]){const{style:a}=t;a.top=`${100*s}%`,a.left=`${100*e}%`,a.width=`${100*n}%`,a.height=`${100*r}%`}#i(){const t=Ae._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const s=Ae._svgFactory.createElement("clipPath");t.append(s);const n=`clip_${e}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Ae._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),n}#l(t,e){for(const[s,n]of Object.entries(e))n===null?t.removeAttribute(s):t.setAttribute(s,n)}draw(t,e=!1,s=!1){const n=this.#e++,r=this.#i(),a=Ae._svgFactory.createElement("defs");r.append(a);const o=Ae._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(n,o);const c=s?this.#a(a,l):null,h=Ae._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,t),this.#s.set(n,r),{id:n,clipPathId:`url(#${c})`}}drawOutline(t,e){const s=this.#e++,n=this.#i(),r=Ae._svgFactory.createElement("defs");n.append(r);const a=Ae._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(e){const u=Ae._svgFactory.createElement("mask");r.append(u),l=`mask_p${this.pageIndex}_${s}`,u.setAttribute("id",l),u.setAttribute("maskUnits","objectBoundingBox");const d=Ae._svgFactory.createElement("rect");u.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const f=Ae._svgFactory.createElement("use");u.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const c=Ae._svgFactory.createElement("use");n.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const h=c.cloneNode();return n.append(h),c.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(n,t),this.#s.set(s,n),s}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:s,bbox:n,rootClass:r,path:a}=e,o=typeof t=="number"?this.#s.get(t):t;if(o){if(s&&this.#l(o,s),n&&Ae.#r(o,n),r){const{classList:l}=o;for(const[c,h]of Object.entries(r))l.toggle(c,h)}if(a){const c=o.firstChild.firstChild;this.#l(c,a)}}}updateParent(t,e){if(e===this)return;const s=this.#s.get(t);s&&(e.#t.append(s),this.#s.delete(t),e.#s.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#s.get(t).remove(),this.#s.delete(t))}destroy(){this.#t=null;for(const t of this.#s.values())t.remove();this.#s.clear(),this.#n.clear()}};globalThis.pdfjsTestingUtils={HighlightOutliner:ha};dt.AbortException;dt.AnnotationEditorLayer;dt.AnnotationEditorParamsType;dt.AnnotationEditorType;dt.AnnotationEditorUIManager;dt.AnnotationLayer;dt.AnnotationMode;dt.ColorPicker;dt.DOMSVGFactory;dt.DrawLayer;dt.FeatureTest;var Wg=dt.GlobalWorkerOptions;dt.ImageKind;dt.InvalidPDFException;dt.MissingPDFException;dt.OPS;dt.OutputScale;dt.PDFDataRangeTransport;dt.PDFDateString;dt.PDFWorker;dt.PasswordResponses;dt.PermissionFlag;dt.PixelsPerInch;dt.RenderingCancelledException;dt.TextLayer;dt.TouchManager;dt.UnexpectedResponseException;dt.Util;dt.VerbosityLevel;dt.XfaLayer;dt.build;dt.createValidAbsoluteUrl;dt.fetchData;var Gg=dt.getDocument;dt.getFilenameFromUrl;dt.getPdfFilenameFromUrl;dt.getXfaPageViewport;dt.isDataScheme;dt.isPdfFile;dt.noContextMenu;dt.normalizeUnicode;dt.setLayerDimensions;dt.shadow;dt.stopEvent;dt.version;var Xg={9306:((i,t,e)=>{var s=e(4901),n=e(6823),r=TypeError;i.exports=function(a){if(s(a))return a;throw new r(n(a)+" is not a function")}}),3506:((i,t,e)=>{var s=e(3925),n=String,r=TypeError;i.exports=function(a){if(s(a))return a;throw new r("Can't set "+n(a)+" as a prototype")}}),7080:((i,t,e)=>{var s=e(4402).has;i.exports=function(n){return s(n),n}}),679:((i,t,e)=>{var s=e(1625),n=TypeError;i.exports=function(r,a){if(s(a,r))return r;throw new n("Incorrect invocation")}}),8551:((i,t,e)=>{var s=e(34),n=String,r=TypeError;i.exports=function(a){if(s(a))return a;throw new r(n(a)+" is not an object")}}),7811:(i=>{i.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"}),7394:((i,t,e)=>{var s=e(4576),n=e(6706),r=e(2195),a=s.ArrayBuffer,o=s.TypeError;i.exports=a&&n(a.prototype,"byteLength","get")||function(l){if(r(l)!=="ArrayBuffer")throw new o("ArrayBuffer expected");return l.byteLength}}),3238:((i,t,e)=>{var s=e(4576),n=e(7476),r=e(7394),a=s.ArrayBuffer,o=a&&a.prototype,l=o&&n(o.slice);i.exports=function(c){if(r(c)!==0||!l)return!1;try{return l(c,0,0),!1}catch{return!0}}}),5169:((i,t,e)=>{var s=e(3238),n=TypeError;i.exports=function(r){if(s(r))throw new n("ArrayBuffer is detached");return r}}),5636:((i,t,e)=>{var s=e(4576),n=e(9504),r=e(6706),a=e(7696),o=e(5169),l=e(7394),c=e(4483),h=e(1548),u=s.structuredClone,d=s.ArrayBuffer,f=s.DataView,p=Math.min,g=d.prototype,m=f.prototype,v=n(g.slice),y=r(g,"resizable","get"),w=r(g,"maxByteLength","get"),b=n(m.getInt8),A=n(m.setInt8);i.exports=(h||c)&&function(S,T,R){var x=l(S),I=T===void 0?x:a(T),M=!y||!y(S),H;if(o(S),h&&(S=u(S,{transfer:[S]}),x===I&&(R||M)))return S;if(x>=I&&(!R||M))H=v(S,0,I);else{var B=R&&!M&&w?{maxByteLength:w(S)}:void 0;H=new d(I,B);for(var W=new f(S),et=new f(H),F=p(I,x),_=0;_<F;_++)A(et,_,b(W,_))}return h||c(S),H}}),4644:((i,t,e)=>{var s=e(7811),n=e(3724),r=e(4576),a=e(4901),o=e(34),l=e(9297),c=e(6955),h=e(6823),u=e(6699),d=e(6840),f=e(2106),p=e(1625),g=e(2787),m=e(2967),v=e(8227),y=e(3392),w=e(1181),b=w.enforce,A=w.get,S=r.Int8Array,T=S&&S.prototype,R=r.Uint8ClampedArray,x=R&&R.prototype,I=S&&g(S),M=T&&g(T),H=Object.prototype,B=r.TypeError,W=v("toStringTag"),et=y("TYPED_ARRAY_TAG"),F="TypedArrayConstructor",_=s&&!!m&&c(r.opera)!=="Opera",Y=!1,nt,mt,wt,rt={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},xt={BigInt64Array:8,BigUint64Array:8},ne=function(E){if(!o(E))return!1;var P=c(E);return P==="DataView"||l(rt,P)||l(xt,P)},te=function(z){var E=g(z);if(o(E)){var P=A(E);return P&&l(P,F)?P[F]:te(E)}},N=function(z){if(!o(z))return!1;var E=c(z);return l(rt,E)||l(xt,E)},C=function(z){if(N(z))return z;throw new B("Target is not a typed array")},L=function(z){if(a(z)&&(!m||p(I,z)))return z;throw new B(h(z)+" is not a typed array constructor")},K=function(z,E,P,O){if(n){if(P)for(var k in rt){var D=r[k];if(D&&l(D.prototype,z))try{delete D.prototype[z]}catch{try{D.prototype[z]=E}catch{}}}(!M[z]||P)&&d(M,z,P?E:_&&T[z]||E,O)}},tt=function(z,E,P){var O,k;if(n){if(m){if(P){for(O in rt)if(k=r[O],k&&l(k,z))try{delete k[z]}catch{}}if(!I[z]||P)try{return d(I,z,P?E:_&&I[z]||E)}catch{}else return}for(O in rt)k=r[O],k&&(!k[z]||P)&&d(k,z,E)}};for(nt in rt)mt=r[nt],wt=mt&&mt.prototype,wt?b(wt)[F]=mt:_=!1;for(nt in xt)mt=r[nt],wt=mt&&mt.prototype,wt&&(b(wt)[F]=mt);if((!_||!a(I)||I===Function.prototype)&&(I=function(){throw new B("Incorrect invocation")},_))for(nt in rt)r[nt]&&m(r[nt],I);if((!_||!M||M===H)&&(M=I.prototype,_))for(nt in rt)r[nt]&&m(r[nt].prototype,M);if(_&&g(x)!==M&&m(x,M),n&&!l(M,W)){Y=!0,f(M,W,{configurable:!0,get:function(){return o(this)?this[et]:void 0}});for(nt in rt)r[nt]&&u(r[nt],et,nt)}i.exports={NATIVE_ARRAY_BUFFER_VIEWS:_,TYPED_ARRAY_TAG:Y&&et,aTypedArray:C,aTypedArrayConstructor:L,exportTypedArrayMethod:K,exportTypedArrayStaticMethod:tt,getTypedArrayConstructor:te,isView:ne,isTypedArray:N,TypedArray:I,TypedArrayPrototype:M}}),5370:((i,t,e)=>{var s=e(6198);i.exports=function(n,r,a){for(var o=0,l=arguments.length>2?a:s(r),c=new n(l);l>o;)c[o]=r[o++];return c}}),9617:((i,t,e)=>{var s=e(5397),n=e(5610),r=e(6198),a=function(o){return function(l,c,h){var u=s(l),d=r(u);if(d===0)return!o&&-1;var f=n(h,d),p;if(o&&c!==c){for(;d>f;)if(p=u[f++],p!==p)return!0}else for(;d>f;f++)if((o||f in u)&&u[f]===c)return o||f||0;return!o&&-1}};i.exports={includes:a(!0),indexOf:a(!1)}}),4527:((i,t,e)=>{var s=e(3724),n=e(4376),r=TypeError,a=Object.getOwnPropertyDescriptor,o=s&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}})();i.exports=o?function(l,c){if(n(l)&&!a(l,"length").writable)throw new r("Cannot set read only .length");return l.length=c}:function(l,c){return l.length=c}}),7628:((i,t,e)=>{var s=e(6198);i.exports=function(n,r){for(var a=s(n),o=new r(a),l=0;l<a;l++)o[l]=n[a-l-1];return o}}),9928:((i,t,e)=>{var s=e(6198),n=e(1291),r=RangeError;i.exports=function(a,o,l,c){var h=s(a),u=n(l),d=u<0?h+u:u;if(d>=h||d<0)throw new r("Incorrect index");for(var f=new o(h),p=0;p<h;p++)f[p]=p===d?c:a[p];return f}}),6319:((i,t,e)=>{var s=e(8551),n=e(9539);i.exports=function(r,a,o,l){try{return l?a(s(o)[0],o[1]):a(o)}catch(c){n(r,"throw",c)}}}),2195:((i,t,e)=>{var s=e(9504),n=s({}.toString),r=s("".slice);i.exports=function(a){return r(n(a),8,-1)}}),6955:((i,t,e)=>{var s=e(2140),n=e(4901),r=e(2195),a=e(8227),o=a("toStringTag"),l=Object,c=r((function(){return arguments})())==="Arguments",h=function(u,d){try{return u[d]}catch{}};i.exports=s?r:function(u){var d,f,p;return u===void 0?"Undefined":u===null?"Null":typeof(f=h(d=l(u),o))=="string"?f:c?r(d):(p=r(d))==="Object"&&n(d.callee)?"Arguments":p}}),7740:((i,t,e)=>{var s=e(9297),n=e(5031),r=e(7347),a=e(4913);i.exports=function(o,l,c){for(var h=n(l),u=a.f,d=r.f,f=0;f<h.length;f++){var p=h[f];!s(o,p)&&!(c&&s(c,p))&&u(o,p,d(l,p))}}}),2211:((i,t,e)=>{var s=e(9039);i.exports=!s(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype})}),2529:(i=>{i.exports=function(t,e){return{value:t,done:e}}}),6699:((i,t,e)=>{var s=e(3724),n=e(4913),r=e(6980);i.exports=s?function(a,o,l){return n.f(a,o,r(1,l))}:function(a,o,l){return a[o]=l,a}}),6980:(i=>{i.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}}),4659:((i,t,e)=>{var s=e(3724),n=e(4913),r=e(6980);i.exports=function(a,o,l){s?n.f(a,o,r(0,l)):a[o]=l}}),2106:((i,t,e)=>{var s=e(283),n=e(4913);i.exports=function(r,a,o){return o.get&&s(o.get,a,{getter:!0}),o.set&&s(o.set,a,{setter:!0}),n.f(r,a,o)}}),6840:((i,t,e)=>{var s=e(4901),n=e(4913),r=e(283),a=e(9433);i.exports=function(o,l,c,h){h||(h={});var u=h.enumerable,d=h.name!==void 0?h.name:l;if(s(c)&&r(c,d,h),h.global)u?o[l]=c:a(l,c);else{try{h.unsafe?o[l]&&(u=!0):delete o[l]}catch{}u?o[l]=c:n.f(o,l,{value:c,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return o}}),6279:((i,t,e)=>{var s=e(6840);i.exports=function(n,r,a){for(var o in r)s(n,o,r[o],a);return n}}),9433:((i,t,e)=>{var s=e(4576),n=Object.defineProperty;i.exports=function(r,a){try{n(s,r,{value:a,configurable:!0,writable:!0})}catch{s[r]=a}return a}}),3724:((i,t,e)=>{var s=e(9039);i.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})}),4483:((i,t,e)=>{var s=e(4576),n=e(9429),r=e(1548),a=s.structuredClone,o=s.ArrayBuffer,l=s.MessageChannel,c=!1,h,u,d,f;if(r)c=function(p){a(p,{transfer:[p]})};else if(o)try{l||(h=n("worker_threads"),h&&(l=h.MessageChannel)),l&&(u=new l,d=new o(2),f=function(p){u.port1.postMessage(null,[p])},d.byteLength===2&&(f(d),d.byteLength===0&&(c=f)))}catch{}i.exports=c}),4055:((i,t,e)=>{var s=e(4576),n=e(34),r=s.document,a=n(r)&&n(r.createElement);i.exports=function(o){return a?r.createElement(o):{}}}),6837:(i=>{var t=TypeError,e=9007199254740991;i.exports=function(s){if(s>e)throw t("Maximum allowed index exceeded");return s}}),8727:(i=>{i.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]}),6193:((i,t,e)=>{var s=e(4215);i.exports=s==="NODE"}),2839:((i,t,e)=>{var s=e(4576),n=s.navigator,r=n&&n.userAgent;i.exports=r?String(r):""}),9519:((i,t,e)=>{var s=e(4576),n=e(2839),r=s.process,a=s.Deno,o=r&&r.versions||a&&a.version,l=o&&o.v8,c,h;l&&(c=l.split("."),h=c[0]>0&&c[0]<4?1:+(c[0]+c[1])),!h&&n&&(c=n.match(/Edge\/(\d+)/),(!c||c[1]>=74)&&(c=n.match(/Chrome\/(\d+)/),c&&(h=+c[1]))),i.exports=h}),4215:((i,t,e)=>{var s=e(4576),n=e(2839),r=e(2195),a=function(o){return n.slice(0,o.length)===o};i.exports=(function(){return a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":s.Bun&&typeof Bun.version=="string"?"BUN":s.Deno&&typeof Deno.version=="object"?"DENO":r(s.process)==="process"?"NODE":s.window&&s.document?"BROWSER":"REST"})()}),6518:((i,t,e)=>{var s=e(4576),n=e(7347).f,r=e(6699),a=e(6840),o=e(9433),l=e(7740),c=e(2796);i.exports=function(h,u){var d=h.target,f=h.global,p=h.stat,g,m,v,y,w,b;if(f?m=s:p?m=s[d]||o(d,{}):m=s[d]&&s[d].prototype,m)for(v in u){if(w=u[v],h.dontCallGetSet?(b=n(m,v),y=b&&b.value):y=m[v],g=c(f?v:d+(p?".":"#")+v,h.forced),!g&&y!==void 0){if(typeof w==typeof y)continue;l(w,y)}(h.sham||y&&y.sham)&&r(w,"sham",!0),a(m,v,w,h)}}}),9039:(i=>{i.exports=function(t){try{return!!t()}catch{return!0}}}),6080:((i,t,e)=>{var s=e(7476),n=e(9306),r=e(616),a=s(s.bind);i.exports=function(o,l){return n(o),l===void 0?o:r?a(o,l):function(){return o.apply(l,arguments)}}}),616:((i,t,e)=>{var s=e(9039);i.exports=!s(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")})}),9565:((i,t,e)=>{var s=e(616),n=Function.prototype.call;i.exports=s?n.bind(n):function(){return n.apply(n,arguments)}}),350:((i,t,e)=>{var s=e(3724),n=e(9297),r=Function.prototype,a=s&&Object.getOwnPropertyDescriptor,o=n(r,"name"),l=o&&(function(){}).name==="something",c=o&&(!s||s&&a(r,"name").configurable);i.exports={EXISTS:o,PROPER:l,CONFIGURABLE:c}}),6706:((i,t,e)=>{var s=e(9504),n=e(9306);i.exports=function(r,a,o){try{return s(n(Object.getOwnPropertyDescriptor(r,a)[o]))}catch{}}}),7476:((i,t,e)=>{var s=e(2195),n=e(9504);i.exports=function(r){if(s(r)==="Function")return n(r)}}),9504:((i,t,e)=>{var s=e(616),n=Function.prototype,r=n.call,a=s&&n.bind.bind(r,r);i.exports=s?a:function(o){return function(){return r.apply(o,arguments)}}}),9429:((i,t,e)=>{var s=e(4576),n=e(6193);i.exports=function(r){if(n){try{return s.process.getBuiltinModule(r)}catch{}try{return Function('return require("'+r+'")')()}catch{}}}}),7751:((i,t,e)=>{var s=e(4576),n=e(4901),r=function(a){return n(a)?a:void 0};i.exports=function(a,o){return arguments.length<2?r(s[a]):s[a]&&s[a][o]}}),1767:(i=>{i.exports=function(t){return{iterator:t,next:t.next,done:!1}}}),851:((i,t,e)=>{var s=e(6955),n=e(5966),r=e(4117),a=e(6269),o=e(8227),l=o("iterator");i.exports=function(c){if(!r(c))return n(c,l)||n(c,"@@iterator")||a[s(c)]}}),81:((i,t,e)=>{var s=e(9565),n=e(9306),r=e(8551),a=e(6823),o=e(851),l=TypeError;i.exports=function(c,h){var u=arguments.length<2?o(c):h;if(n(u))return r(s(u,c));throw new l(a(c)+" is not iterable")}}),5966:((i,t,e)=>{var s=e(9306),n=e(4117);i.exports=function(r,a){var o=r[a];return n(o)?void 0:s(o)}}),3789:((i,t,e)=>{var s=e(9306),n=e(8551),r=e(9565),a=e(1291),o=e(1767),l="Invalid size",c=RangeError,h=TypeError,u=Math.max,d=function(f,p){this.set=f,this.size=u(p,0),this.has=s(f.has),this.keys=s(f.keys)};d.prototype={getIterator:function(){return o(n(r(this.keys,this.set)))},includes:function(f){return r(this.has,this.set,f)}},i.exports=function(f){n(f);var p=+f.size;if(p!==p)throw new h(l);var g=a(p);if(g<0)throw new c(l);return new d(f,g)}}),4576:(function(i){var t=function(e){return e&&e.Math===Math&&e};i.exports=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof global=="object"&&global)||t(typeof this=="object"&&this)||(function(){return this})()||Function("return this")()}),9297:((i,t,e)=>{var s=e(9504),n=e(8981),r=s({}.hasOwnProperty);i.exports=Object.hasOwn||function(o,l){return r(n(o),l)}}),421:(i=>{i.exports={}}),397:((i,t,e)=>{var s=e(7751);i.exports=s("document","documentElement")}),5917:((i,t,e)=>{var s=e(3724),n=e(9039),r=e(4055);i.exports=!s&&!n(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7})}),7055:((i,t,e)=>{var s=e(9504),n=e(9039),r=e(2195),a=Object,o=s("".split);i.exports=n(function(){return!a("z").propertyIsEnumerable(0)})?function(l){return r(l)==="String"?o(l,""):a(l)}:a}),3706:((i,t,e)=>{var s=e(9504),n=e(4901),r=e(7629),a=s(Function.toString);n(r.inspectSource)||(r.inspectSource=function(o){return a(o)}),i.exports=r.inspectSource}),1181:((i,t,e)=>{var s=e(8622),n=e(4576),r=e(34),a=e(6699),o=e(9297),l=e(7629),c=e(6119),h=e(421),u="Object already initialized",d=n.TypeError,f=n.WeakMap,p,g,m,v=function(A){return m(A)?g(A):p(A,{})},y=function(A){return function(S){var T;if(!r(S)||(T=g(S)).type!==A)throw new d("Incompatible receiver, "+A+" required");return T}};if(s||l.state){var w=l.state||(l.state=new f);w.get=w.get,w.has=w.has,w.set=w.set,p=function(A,S){if(w.has(A))throw new d(u);return S.facade=A,w.set(A,S),S},g=function(A){return w.get(A)||{}},m=function(A){return w.has(A)}}else{var b=c("state");h[b]=!0,p=function(A,S){if(o(A,b))throw new d(u);return S.facade=A,a(A,b,S),S},g=function(A){return o(A,b)?A[b]:{}},m=function(A){return o(A,b)}}i.exports={set:p,get:g,has:m,enforce:v,getterFor:y}}),4209:((i,t,e)=>{var s=e(8227),n=e(6269),r=s("iterator"),a=Array.prototype;i.exports=function(o){return o!==void 0&&(n.Array===o||a[r]===o)}}),4376:((i,t,e)=>{var s=e(2195);i.exports=Array.isArray||function(r){return s(r)==="Array"}}),1108:((i,t,e)=>{var s=e(6955);i.exports=function(n){var r=s(n);return r==="BigInt64Array"||r==="BigUint64Array"}}),4901:(i=>{var t=typeof document=="object"&&document.all;i.exports=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"}}),2796:((i,t,e)=>{var s=e(9039),n=e(4901),r=/#|\.prototype\./,a=function(u,d){var f=l[o(u)];return f===h?!0:f===c?!1:n(d)?s(d):!!d},o=a.normalize=function(u){return String(u).replace(r,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",h=a.POLYFILL="P";i.exports=a}),4117:(i=>{i.exports=function(t){return t==null}}),34:((i,t,e)=>{var s=e(4901);i.exports=function(n){return typeof n=="object"?n!==null:s(n)}}),3925:((i,t,e)=>{var s=e(34);i.exports=function(n){return s(n)||n===null}}),6395:(i=>{i.exports=!1}),757:((i,t,e)=>{var s=e(7751),n=e(4901),r=e(1625),a=e(7040),o=Object;i.exports=a?function(l){return typeof l=="symbol"}:function(l){var c=s("Symbol");return n(c)&&r(c.prototype,o(l))}}),507:((i,t,e)=>{var s=e(9565);i.exports=function(n,r,a){for(var o=a?n:n.iterator,l=n.next,c,h;!(c=s(l,o)).done;)if(h=r(c.value),h!==void 0)return h}}),2652:((i,t,e)=>{var s=e(6080),n=e(9565),r=e(8551),a=e(6823),o=e(4209),l=e(6198),c=e(1625),h=e(81),u=e(851),d=e(9539),f=TypeError,p=function(m,v){this.stopped=m,this.result=v},g=p.prototype;i.exports=function(m,v,y){var w=y&&y.that,b=!!(y&&y.AS_ENTRIES),A=!!(y&&y.IS_RECORD),S=!!(y&&y.IS_ITERATOR),T=!!(y&&y.INTERRUPTED),R=s(v,w),x,I,M,H,B,W,et,F=function(Y){return x&&d(x,"normal",Y),new p(!0,Y)},_=function(Y){return b?(r(Y),T?R(Y[0],Y[1],F):R(Y[0],Y[1])):T?R(Y,F):R(Y)};if(A)x=m.iterator;else if(S)x=m;else{if(I=u(m),!I)throw new f(a(m)+" is not iterable");if(o(I)){for(M=0,H=l(m);H>M;M++)if(B=_(m[M]),B&&c(g,B))return B;return new p(!1)}x=h(m,I)}for(W=A?m.next:x.next;!(et=n(W,x)).done;){try{B=_(et.value)}catch(Y){d(x,"throw",Y)}if(typeof B=="object"&&B&&c(g,B))return B}return new p(!1)}}),9539:((i,t,e)=>{var s=e(9565),n=e(8551),r=e(5966);i.exports=function(a,o,l){var c,h;n(a);try{if(c=r(a,"return"),!c){if(o==="throw")throw l;return l}c=s(c,a)}catch(u){h=!0,c=u}if(o==="throw")throw l;if(h)throw c;return n(c),l}}),9462:((i,t,e)=>{var s=e(9565),n=e(2360),r=e(6699),a=e(6279),o=e(8227),l=e(1181),c=e(5966),h=e(7657).IteratorPrototype,u=e(2529),d=e(9539),f=o("toStringTag"),p="IteratorHelper",g="WrapForValidIterator",m=l.set,v=function(b){var A=l.getterFor(b?g:p);return a(n(h),{next:function(){var T=A(this);if(b)return T.nextHandler();try{var R=T.done?void 0:T.nextHandler();return u(R,T.done)}catch(x){throw T.done=!0,x}},return:function(){var S=A(this),T=S.iterator;if(S.done=!0,b){var R=c(T,"return");return R?s(R,T):u(void 0,!0)}if(S.inner)try{d(S.inner.iterator,"normal")}catch(x){return d(T,"throw",x)}return T&&d(T,"normal"),u(void 0,!0)}})},y=v(!0),w=v(!1);r(w,f,"Iterator Helper"),i.exports=function(b,A){var S=function(R,x){x?(x.iterator=R.iterator,x.next=R.next):x=R,x.type=A?g:p,x.nextHandler=b,x.counter=0,x.done=!1,m(this,x)};return S.prototype=A?y:w,S}}),713:((i,t,e)=>{var s=e(9565),n=e(9306),r=e(8551),a=e(1767),o=e(9462),l=e(6319),c=o(function(){var h=this.iterator,u=r(s(this.next,h)),d=this.done=!!u.done;if(!d)return l(h,this.mapper,[u.value,this.counter++],!0)});i.exports=function(u){return r(this),n(u),new c(a(this),{mapper:u})}}),7657:((i,t,e)=>{var s=e(9039),n=e(4901),r=e(34),a=e(2360),o=e(2787),l=e(6840),c=e(8227),h=e(6395),u=c("iterator"),d=!1,f,p,g;[].keys&&(g=[].keys(),"next"in g?(p=o(o(g)),p!==Object.prototype&&(f=p)):d=!0);var m=!r(f)||s(function(){var v={};return f[u].call(v)!==v});m?f={}:h&&(f=a(f)),n(f[u])||l(f,u,function(){return this}),i.exports={IteratorPrototype:f,BUGGY_SAFARI_ITERATORS:d}}),6269:(i=>{i.exports={}}),6198:((i,t,e)=>{var s=e(8014);i.exports=function(n){return s(n.length)}}),283:((i,t,e)=>{var s=e(9504),n=e(9039),r=e(4901),a=e(9297),o=e(3724),l=e(350).CONFIGURABLE,c=e(3706),h=e(1181),u=h.enforce,d=h.get,f=String,p=Object.defineProperty,g=s("".slice),m=s("".replace),v=s([].join),y=o&&!n(function(){return p(function(){},"length",{value:8}).length!==8}),w=String(String).split("String"),b=i.exports=function(A,S,T){g(f(S),0,7)==="Symbol("&&(S="["+m(f(S),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),T&&T.getter&&(S="get "+S),T&&T.setter&&(S="set "+S),(!a(A,"name")||l&&A.name!==S)&&(o?p(A,"name",{value:S,configurable:!0}):A.name=S),y&&T&&a(T,"arity")&&A.length!==T.arity&&p(A,"length",{value:T.arity});try{T&&a(T,"constructor")&&T.constructor?o&&p(A,"prototype",{writable:!1}):A.prototype&&(A.prototype=void 0)}catch{}var R=u(A);return a(R,"source")||(R.source=v(w,typeof S=="string"?S:"")),A};Function.prototype.toString=b(function(){return r(this)&&d(this).source||c(this)},"toString")}),741:(i=>{var t=Math.ceil,e=Math.floor;i.exports=Math.trunc||function(n){var r=+n;return(r>0?e:t)(r)}}),6043:((i,t,e)=>{var s=e(9306),n=TypeError,r=function(a){var o,l;this.promise=new a(function(c,h){if(o!==void 0||l!==void 0)throw new n("Bad Promise constructor");o=c,l=h}),this.resolve=s(o),this.reject=s(l)};i.exports.f=function(a){return new r(a)}}),2360:((i,t,e)=>{var s=e(8551),n=e(6801),r=e(8727),a=e(421),o=e(397),l=e(4055),c=e(6119),h=">",u="<",d="prototype",f="script",p=c("IE_PROTO"),g=function(){},m=function(A){return u+f+h+A+u+"/"+f+h},v=function(A){A.write(m("")),A.close();var S=A.parentWindow.Object;return A=null,S},y=function(){var A=l("iframe"),S="java"+f+":",T;return A.style.display="none",o.appendChild(A),A.src=String(S),T=A.contentWindow.document,T.open(),T.write(m("document.F=Object")),T.close(),T.F},w,b=function(){try{w=new ActiveXObject("htmlfile")}catch{}b=typeof document<"u"?document.domain&&w?v(w):y():v(w);for(var A=r.length;A--;)delete b[d][r[A]];return b()};a[p]=!0,i.exports=Object.create||function(S,T){var R;return S!==null?(g[d]=s(S),R=new g,g[d]=null,R[p]=S):R=b(),T===void 0?R:n.f(R,T)}}),6801:((i,t,e)=>{var s=e(3724),n=e(8686),r=e(4913),a=e(8551),o=e(5397),l=e(1072);t.f=s&&!n?Object.defineProperties:function(h,u){a(h);for(var d=o(u),f=l(u),p=f.length,g=0,m;p>g;)r.f(h,m=f[g++],d[m]);return h}}),4913:((i,t,e)=>{var s=e(3724),n=e(5917),r=e(8686),a=e(8551),o=e(6969),l=TypeError,c=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",f="writable";t.f=s?r?function(g,m,v){if(a(g),m=o(m),a(v),typeof g=="function"&&m==="prototype"&&"value"in v&&f in v&&!v[f]){var y=h(g,m);y&&y[f]&&(g[m]=v.value,v={configurable:d in v?v[d]:y[d],enumerable:u in v?v[u]:y[u],writable:!1})}return c(g,m,v)}:c:function(g,m,v){if(a(g),m=o(m),a(v),n)try{return c(g,m,v)}catch{}if("get"in v||"set"in v)throw new l("Accessors not supported");return"value"in v&&(g[m]=v.value),g}}),7347:((i,t,e)=>{var s=e(3724),n=e(9565),r=e(8773),a=e(6980),o=e(5397),l=e(6969),c=e(9297),h=e(5917),u=Object.getOwnPropertyDescriptor;t.f=s?u:function(f,p){if(f=o(f),p=l(p),h)try{return u(f,p)}catch{}if(c(f,p))return a(!n(r.f,f,p),f[p])}}),8480:((i,t,e)=>{var s=e(1828),n=e(8727),r=n.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(o){return s(o,r)}}),3717:((i,t)=>{t.f=Object.getOwnPropertySymbols}),2787:((i,t,e)=>{var s=e(9297),n=e(4901),r=e(8981),a=e(6119),o=e(2211),l=a("IE_PROTO"),c=Object,h=c.prototype;i.exports=o?c.getPrototypeOf:function(u){var d=r(u);if(s(d,l))return d[l];var f=d.constructor;return n(f)&&d instanceof f?f.prototype:d instanceof c?h:null}}),1625:((i,t,e)=>{var s=e(9504);i.exports=s({}.isPrototypeOf)}),1828:((i,t,e)=>{var s=e(9504),n=e(9297),r=e(5397),a=e(9617).indexOf,o=e(421),l=s([].push);i.exports=function(c,h){var u=r(c),d=0,f=[],p;for(p in u)!n(o,p)&&n(u,p)&&l(f,p);for(;h.length>d;)n(u,p=h[d++])&&(~a(f,p)||l(f,p));return f}}),1072:((i,t,e)=>{var s=e(1828),n=e(8727);i.exports=Object.keys||function(a){return s(a,n)}}),8773:((i,t)=>{var e={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,n=s&&!e.call({1:2},1);t.f=n?function(a){var o=s(this,a);return!!o&&o.enumerable}:e}),2967:((i,t,e)=>{var s=e(6706),n=e(34),r=e(7750),a=e(3506);i.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var o=!1,l={},c;try{c=s(Object.prototype,"__proto__","set"),c(l,[]),o=l instanceof Array}catch{}return function(u,d){return r(u),a(d),n(u)&&(o?c(u,d):u.__proto__=d),u}})():void 0)}),4270:((i,t,e)=>{var s=e(9565),n=e(4901),r=e(34),a=TypeError;i.exports=function(o,l){var c,h;if(l==="string"&&n(c=o.toString)&&!r(h=s(c,o))||n(c=o.valueOf)&&!r(h=s(c,o))||l!=="string"&&n(c=o.toString)&&!r(h=s(c,o)))return h;throw new a("Can't convert object to primitive value")}}),5031:((i,t,e)=>{var s=e(7751),n=e(9504),r=e(8480),a=e(3717),o=e(8551),l=n([].concat);i.exports=s("Reflect","ownKeys")||function(h){var u=r.f(o(h)),d=a.f;return d?l(u,d(h)):u}}),8235:((i,t,e)=>{var s=e(9504),n=e(9297),r=SyntaxError,a=parseInt,o=String.fromCharCode,l=s("".charAt),c=s("".slice),h=s(/./.exec),u={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},d=/^[\da-f]{4}$/i,f=/^[\u0000-\u001F]$/;i.exports=function(p,g){for(var m=!0,v="";g<p.length;){var y=l(p,g);if(y==="\\"){var w=c(p,g,g+2);if(n(u,w))v+=u[w],g+=2;else if(w==="\\u"){g+=2;var b=c(p,g,g+4);if(!h(d,b))throw new r("Bad Unicode escape at: "+g);v+=o(a(b,16)),g+=4}else throw new r('Unknown escape sequence: "'+w+'"')}else if(y==='"'){m=!1,g++;break}else{if(h(f,y))throw new r("Bad control character in string literal at: "+g);v+=y,g++}}if(m)throw new r("Unterminated string at: "+g);return{value:v,end:g}}}),7750:((i,t,e)=>{var s=e(4117),n=TypeError;i.exports=function(r){if(s(r))throw new n("Can't call method on "+r);return r}}),9286:((i,t,e)=>{var s=e(4402),n=e(8469),r=s.Set,a=s.add;i.exports=function(o){var l=new r;return n(o,function(c){a(l,c)}),l}}),3440:((i,t,e)=>{var s=e(7080),n=e(4402),r=e(9286),a=e(5170),o=e(3789),l=e(8469),c=e(507),h=n.has,u=n.remove;i.exports=function(f){var p=s(this),g=o(f),m=r(p);return a(p)<=g.size?l(p,function(v){g.includes(v)&&u(m,v)}):c(g.getIterator(),function(v){h(p,v)&&u(m,v)}),m}}),4402:((i,t,e)=>{var s=e(9504),n=Set.prototype;i.exports={Set,add:s(n.add),has:s(n.has),remove:s(n.delete),proto:n}}),8750:((i,t,e)=>{var s=e(7080),n=e(4402),r=e(5170),a=e(3789),o=e(8469),l=e(507),c=n.Set,h=n.add,u=n.has;i.exports=function(f){var p=s(this),g=a(f),m=new c;return r(p)>g.size?l(g.getIterator(),function(v){u(p,v)&&h(m,v)}):o(p,function(v){g.includes(v)&&h(m,v)}),m}}),4449:((i,t,e)=>{var s=e(7080),n=e(4402).has,r=e(5170),a=e(3789),o=e(8469),l=e(507),c=e(9539);i.exports=function(u){var d=s(this),f=a(u);if(r(d)<=f.size)return o(d,function(g){if(f.includes(g))return!1},!0)!==!1;var p=f.getIterator();return l(p,function(g){if(n(d,g))return c(p,"normal",!1)})!==!1}}),3838:((i,t,e)=>{var s=e(7080),n=e(5170),r=e(8469),a=e(3789);i.exports=function(l){var c=s(this),h=a(l);return n(c)>h.size?!1:r(c,function(u){if(!h.includes(u))return!1},!0)!==!1}}),8527:((i,t,e)=>{var s=e(7080),n=e(4402).has,r=e(5170),a=e(3789),o=e(507),l=e(9539);i.exports=function(h){var u=s(this),d=a(h);if(r(u)<d.size)return!1;var f=d.getIterator();return o(f,function(p){if(!n(u,p))return l(f,"normal",!1)})!==!1}}),8469:((i,t,e)=>{var s=e(9504),n=e(507),r=e(4402),a=r.Set,o=r.proto,l=s(o.forEach),c=s(o.keys),h=c(new a).next;i.exports=function(u,d,f){return f?n({iterator:c(u),next:h},d):l(u,d)}}),4916:((i,t,e)=>{var s=e(7751),n=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};i.exports=function(r){var a=s("Set");try{new a()[r](n(0));try{return new a()[r](n(-1)),!1}catch{return!0}}catch{return!1}}}),5170:((i,t,e)=>{var s=e(6706),n=e(4402);i.exports=s(n.proto,"size","get")||function(r){return r.size}}),3650:((i,t,e)=>{var s=e(7080),n=e(4402),r=e(9286),a=e(3789),o=e(507),l=n.add,c=n.has,h=n.remove;i.exports=function(d){var f=s(this),p=a(d).getIterator(),g=r(f);return o(p,function(m){c(f,m)?h(g,m):l(g,m)}),g}}),4204:((i,t,e)=>{var s=e(7080),n=e(4402).add,r=e(9286),a=e(3789),o=e(507);i.exports=function(c){var h=s(this),u=a(c).getIterator(),d=r(h);return o(u,function(f){n(d,f)}),d}}),6119:((i,t,e)=>{var s=e(5745),n=e(3392),r=s("keys");i.exports=function(a){return r[a]||(r[a]=n(a))}}),7629:((i,t,e)=>{var s=e(6395),n=e(4576),r=e(9433),a="__core-js_shared__",o=i.exports=n[a]||r(a,{});(o.versions||(o.versions=[])).push({version:"3.39.0",mode:s?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),5745:((i,t,e)=>{var s=e(7629);i.exports=function(n,r){return s[n]||(s[n]=r||{})}}),1548:((i,t,e)=>{var s=e(4576),n=e(9039),r=e(9519),a=e(4215),o=s.structuredClone;i.exports=!!o&&!n(function(){if(a==="DENO"&&r>92||a==="NODE"&&r>94||a==="BROWSER"&&r>97)return!1;var l=new ArrayBuffer(8),c=o(l,{transfer:[l]});return l.byteLength!==0||c.byteLength!==8})}),4495:((i,t,e)=>{var s=e(9519),n=e(9039),r=e(4576),a=r.String;i.exports=!!Object.getOwnPropertySymbols&&!n(function(){var o=Symbol("symbol detection");return!a(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&s&&s<41})}),5610:((i,t,e)=>{var s=e(1291),n=Math.max,r=Math.min;i.exports=function(a,o){var l=s(a);return l<0?n(l+o,0):r(l,o)}}),5854:((i,t,e)=>{var s=e(2777),n=TypeError;i.exports=function(r){var a=s(r,"number");if(typeof a=="number")throw new n("Can't convert number to bigint");return BigInt(a)}}),7696:((i,t,e)=>{var s=e(1291),n=e(8014),r=RangeError;i.exports=function(a){if(a===void 0)return 0;var o=s(a),l=n(o);if(o!==l)throw new r("Wrong length or index");return l}}),5397:((i,t,e)=>{var s=e(7055),n=e(7750);i.exports=function(r){return s(n(r))}}),1291:((i,t,e)=>{var s=e(741);i.exports=function(n){var r=+n;return r!==r||r===0?0:s(r)}}),8014:((i,t,e)=>{var s=e(1291),n=Math.min;i.exports=function(r){var a=s(r);return a>0?n(a,9007199254740991):0}}),8981:((i,t,e)=>{var s=e(7750),n=Object;i.exports=function(r){return n(s(r))}}),2777:((i,t,e)=>{var s=e(9565),n=e(34),r=e(757),a=e(5966),o=e(4270),l=e(8227),c=TypeError,h=l("toPrimitive");i.exports=function(u,d){if(!n(u)||r(u))return u;var f=a(u,h),p;if(f){if(d===void 0&&(d="default"),p=s(f,u,d),!n(p)||r(p))return p;throw new c("Can't convert object to primitive value")}return d===void 0&&(d="number"),o(u,d)}}),6969:((i,t,e)=>{var s=e(2777),n=e(757);i.exports=function(r){var a=s(r,"string");return n(a)?a:a+""}}),2140:((i,t,e)=>{var s=e(8227),n=s("toStringTag"),r={};r[n]="z",i.exports=String(r)==="[object z]"}),655:((i,t,e)=>{var s=e(6955),n=String;i.exports=function(r){if(s(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return n(r)}}),6823:(i=>{var t=String;i.exports=function(e){try{return t(e)}catch{return"Object"}}}),3392:((i,t,e)=>{var s=e(9504),n=0,r=Math.random(),a=s(1 .toString);i.exports=function(o){return"Symbol("+(o===void 0?"":o)+")_"+a(++n+r,36)}}),7040:((i,t,e)=>{var s=e(4495);i.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}),8686:((i,t,e)=>{var s=e(3724),n=e(9039);i.exports=s&&n(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})}),2812:(i=>{var t=TypeError;i.exports=function(e,s){if(e<s)throw new t("Not enough arguments");return e}}),8622:((i,t,e)=>{var s=e(4576),n=e(4901),r=s.WeakMap;i.exports=n(r)&&/native code/.test(String(r))}),8227:((i,t,e)=>{var s=e(4576),n=e(5745),r=e(9297),a=e(3392),o=e(4495),l=e(7040),c=s.Symbol,h=n("wks"),u=l?c.for||c:c&&c.withoutSetter||a;i.exports=function(d){return r(h,d)||(h[d]=o&&r(c,d)?c[d]:u("Symbol."+d)),h[d]}}),6573:((i,t,e)=>{var s=e(3724),n=e(2106),r=e(3238),a=ArrayBuffer.prototype;s&&!("detached"in a)&&n(a,"detached",{configurable:!0,get:function(){return r(this)}})}),7936:((i,t,e)=>{var s=e(6518),n=e(5636);n&&s({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return n(this,arguments.length?arguments[0]:void 0,!1)}})}),8100:((i,t,e)=>{var s=e(6518),n=e(5636);n&&s({target:"ArrayBuffer",proto:!0},{transfer:function(){return n(this,arguments.length?arguments[0]:void 0,!0)}})}),4114:((i,t,e)=>{var s=e(6518),n=e(8981),r=e(6198),a=e(4527),o=e(6837),l=e(9039),c=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),h=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},u=c||!h();s({target:"Array",proto:!0,arity:1,forced:u},{push:function(f){var p=n(this),g=r(p),m=arguments.length;o(g+m);for(var v=0;v<m;v++)p[g]=arguments[v],g++;return a(p,g),g}})}),8111:((i,t,e)=>{var s=e(6518),n=e(4576),r=e(679),a=e(8551),o=e(4901),l=e(2787),c=e(2106),h=e(4659),u=e(9039),d=e(9297),f=e(8227),p=e(7657).IteratorPrototype,g=e(3724),m=e(6395),v="constructor",y="Iterator",w=f("toStringTag"),b=TypeError,A=n[y],S=m||!o(A)||A.prototype!==p||!u(function(){A({})}),T=function(){if(r(this,p),l(this)===p)throw new b("Abstract class Iterator not directly constructable")},R=function(x,I){g?c(p,x,{configurable:!0,get:function(){return I},set:function(M){if(a(this),this===p)throw new b("You can't redefine this property");d(this,x)?this[x]=M:h(this,x,M)}}):p[x]=I};d(p,w)||R(w,y),(S||!d(p,v)||p[v]===Object)&&R(v,T),T.prototype=p,s({global:!0,constructor:!0,forced:S},{Iterator:T})}),1148:((i,t,e)=>{var s=e(6518),n=e(2652),r=e(9306),a=e(8551),o=e(1767);s({target:"Iterator",proto:!0,real:!0},{every:function(c){a(this),r(c);var h=o(this),u=0;return!n(h,function(d,f){if(!c(d,u++))return f()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}),2489:((i,t,e)=>{var s=e(6518),n=e(9565),r=e(9306),a=e(8551),o=e(1767),l=e(9462),c=e(6319),h=e(6395),u=l(function(){for(var d=this.iterator,f=this.predicate,p=this.next,g,m,v;;){if(g=a(n(p,d)),m=this.done=!!g.done,m)return;if(v=g.value,c(d,f,[v,this.counter++],!0))return v}});s({target:"Iterator",proto:!0,real:!0,forced:h},{filter:function(f){return a(this),r(f),new u(o(this),{predicate:f})}})}),7588:((i,t,e)=>{var s=e(6518),n=e(2652),r=e(9306),a=e(8551),o=e(1767);s({target:"Iterator",proto:!0,real:!0},{forEach:function(c){a(this),r(c);var h=o(this),u=0;n(h,function(d){c(d,u++)},{IS_RECORD:!0})}})}),1701:((i,t,e)=>{var s=e(6518),n=e(713),r=e(6395);s({target:"Iterator",proto:!0,real:!0,forced:r},{map:n})}),4628:((i,t,e)=>{var s=e(6518),n=e(6043);s({target:"Promise",stat:!0},{withResolvers:function(){var a=n.f(this);return{promise:a.promise,resolve:a.resolve,reject:a.reject}}})}),7642:((i,t,e)=>{var s=e(6518),n=e(3440),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("difference")},{difference:n})}),8004:((i,t,e)=>{var s=e(6518),n=e(9039),r=e(8750),a=e(4916),o=!a("intersection")||n(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});s({target:"Set",proto:!0,real:!0,forced:o},{intersection:r})}),3853:((i,t,e)=>{var s=e(6518),n=e(4449),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("isDisjointFrom")},{isDisjointFrom:n})}),5876:((i,t,e)=>{var s=e(6518),n=e(3838),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("isSubsetOf")},{isSubsetOf:n})}),2475:((i,t,e)=>{var s=e(6518),n=e(8527),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("isSupersetOf")},{isSupersetOf:n})}),5024:((i,t,e)=>{var s=e(6518),n=e(3650),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("symmetricDifference")},{symmetricDifference:n})}),1698:((i,t,e)=>{var s=e(6518),n=e(4204),r=e(4916);s({target:"Set",proto:!0,real:!0,forced:!r("union")},{union:n})}),7467:((i,t,e)=>{var s=e(7628),n=e(4644),r=n.aTypedArray,a=n.exportTypedArrayMethod,o=n.getTypedArrayConstructor;a("toReversed",function(){return s(r(this),o(this))})}),4732:((i,t,e)=>{var s=e(4644),n=e(9504),r=e(9306),a=e(5370),o=s.aTypedArray,l=s.getTypedArrayConstructor,c=s.exportTypedArrayMethod,h=n(s.TypedArrayPrototype.sort);c("toSorted",function(d){d!==void 0&&r(d);var f=o(this),p=a(l(f),f);return h(p,d)})}),9577:((i,t,e)=>{var s=e(9928),n=e(4644),r=e(1108),a=e(1291),o=e(5854),l=n.aTypedArray,c=n.getTypedArrayConstructor,h=n.exportTypedArrayMethod,u=!!(function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(d){return d===8}})();h("with",function(d,f){var p=l(this),g=a(d),m=r(p)?o(f):+f;return s(p,c(p),g,m)},!u)}),8992:((i,t,e)=>{e(8111)}),3215:((i,t,e)=>{e(1148)}),4520:((i,t,e)=>{e(2489)}),3949:((i,t,e)=>{e(7588)}),1454:((i,t,e)=>{e(1701)}),8335:((i,t,e)=>{var s=e(6518),n=e(3724),r=e(4576),a=e(7751),o=e(9504),l=e(9565),c=e(4901),h=e(34),u=e(4376),d=e(9297),f=e(655),p=e(6198),g=e(4659),m=e(9039),v=e(8235),y=e(4495),w=r.JSON,b=r.Number,A=r.SyntaxError,S=w&&w.parse,T=a("Object","keys"),R=Object.getOwnPropertyDescriptor,x=o("".charAt),I=o("".slice),M=o(/./.exec),H=o([].push),B=/^\d$/,W=/^[1-9]$/,et=/^[\d-]$/,F=/^[\t\n\r ]$/,_=0,Y=1,nt=function(N,C){N=f(N);var L=new xt(N,0),K=L.parse(),tt=K.value,z=L.skip(F,K.end);if(z<N.length)throw new A('Unexpected extra character: "'+x(N,z)+'" after the parsed data at: '+z);return c(C)?mt({"":tt},"",C,K):tt},mt=function(N,C,L,K){var tt=N[C],z=K&&tt===K.value,E=z&&typeof K.source=="string"?{source:K.source}:{},P,O,k,D,$;if(h(tt)){var J=u(tt),G=z?K.nodes:J?[]:{};if(J)for(P=G.length,k=p(tt),D=0;D<k;D++)wt(tt,D,mt(tt,""+D,L,D<P?G[D]:void 0));else for(O=T(tt),k=p(O),D=0;D<k;D++)$=O[D],wt(tt,$,mt(tt,$,L,d(G,$)?G[$]:void 0))}return l(L,N,C,tt,E)},wt=function(N,C,L){if(n){var K=R(N,C);if(K&&!K.configurable)return}L===void 0?delete N[C]:g(N,C,L)},rt=function(N,C,L,K){this.value=N,this.end=C,this.source=L,this.nodes=K},xt=function(N,C){this.source=N,this.index=C};xt.prototype={fork:function(N){return new xt(this.source,N)},parse:function(){var N=this.source,C=this.skip(F,this.index),L=this.fork(C),K=x(N,C);if(M(et,K))return L.number();switch(K){case"{":return L.object();case"[":return L.array();case'"':return L.string();case"t":return L.keyword(!0);case"f":return L.keyword(!1);case"n":return L.keyword(null)}throw new A('Unexpected character: "'+K+'" at: '+C)},node:function(N,C,L,K,tt){return new rt(C,K,N?null:I(this.source,L,K),tt)},object:function(){for(var N=this.source,C=this.index+1,L=!1,K={},tt={};C<N.length;){if(C=this.until(['"',"}"],C),x(N,C)==="}"&&!L){C++;break}var z=this.fork(C).string(),E=z.value;C=z.end,C=this.until([":"],C)+1,C=this.skip(F,C),z=this.fork(C).parse(),g(tt,E,z),g(K,E,z.value),C=this.until([",","}"],z.end);var P=x(N,C);if(P===",")L=!0,C++;else if(P==="}"){C++;break}}return this.node(Y,K,this.index,C,tt)},array:function(){for(var N=this.source,C=this.index+1,L=!1,K=[],tt=[];C<N.length;){if(C=this.skip(F,C),x(N,C)==="]"&&!L){C++;break}var z=this.fork(C).parse();if(H(tt,z),H(K,z.value),C=this.until([",","]"],z.end),x(N,C)===",")L=!0,C++;else if(x(N,C)==="]"){C++;break}}return this.node(Y,K,this.index,C,tt)},string:function(){var N=this.index,C=v(this.source,this.index+1);return this.node(_,C.value,N,C.end)},number:function(){var N=this.source,C=this.index,L=C;if(x(N,L)==="-"&&L++,x(N,L)==="0")L++;else if(M(W,x(N,L)))L=this.skip(B,L+1);else throw new A("Failed to parse number at: "+L);if(x(N,L)==="."&&(L=this.skip(B,L+1)),x(N,L)==="e"||x(N,L)==="E"){L++,(x(N,L)==="+"||x(N,L)==="-")&&L++;var K=L;if(L=this.skip(B,L),K===L)throw new A("Failed to parse number's exponent value at: "+L)}return this.node(_,b(I(N,C,L)),C,L)},keyword:function(N){var C=""+N,L=this.index,K=L+C.length;if(I(this.source,L,K)!==C)throw new A("Failed to parse value at: "+L);return this.node(_,N,L,K)},skip:function(N,C){for(var L=this.source;C<L.length&&M(N,x(L,C));C++);return C},until:function(N,C){C=this.skip(F,C);for(var L=x(this.source,C),K=0;K<N.length;K++)if(N[K]===L)return C;throw new A('Unexpected character: "'+L+'" at: '+C)}};var ne=m(function(){var N="9007199254740993",C;return S(N,function(L,K,tt){C=tt.source}),C!==N}),te=y&&!m(function(){return 1/S("-0 	")!==-1/0});s({target:"JSON",stat:!0,forced:ne},{parse:function(C,L){return te&&!c(L)?S(C):nt(C,L)}})}),4603:((i,t,e)=>{var s=e(6840),n=e(9504),r=e(655),a=e(2812),o=URLSearchParams,l=o.prototype,c=n(l.append),h=n(l.delete),u=n(l.forEach),d=n([].push),f=new o("a=1&a=2&b=3");f.delete("a",1),f.delete("b",void 0),f+""!="a=2"&&s(l,"delete",function(p){var g=arguments.length,m=g<2?void 0:arguments[1];if(g&&m===void 0)return h(this,p);var v=[];u(this,function(x,I){d(v,{key:I,value:x})}),a(g,1);for(var y=r(p),w=r(m),b=0,A=0,S=!1,T=v.length,R;b<T;)R=v[b++],S||R.key===y?(S=!0,h(this,R.key)):A++;for(;A<T;)R=v[A++],R.key===y&&R.value===w||c(this,R.key,R.value)},{enumerable:!0,unsafe:!0})}),7566:((i,t,e)=>{var s=e(6840),n=e(9504),r=e(655),a=e(2812),o=URLSearchParams,l=o.prototype,c=n(l.getAll),h=n(l.has),u=new o("a=1");(u.has("a",2)||!u.has("a",void 0))&&s(l,"has",function(f){var p=arguments.length,g=p<2?void 0:arguments[1];if(p&&g===void 0)return h(this,f);var m=c(this,f);a(p,1);for(var v=r(g),y=0;y<m.length;)if(m[y++]===v)return!0;return!1},{enumerable:!0,unsafe:!0})}),8721:((i,t,e)=>{var s=e(3724),n=e(9504),r=e(2106),a=URLSearchParams.prototype,o=n(a.forEach);s&&!("size"in a)&&r(a,"size",{get:function(){var c=0;return o(this,function(){c++}),c},configurable:!0,enumerable:!0})})},ol={};function Mt(i){var t=ol[i];if(t!==void 0)return t.exports;var e=ol[i]={exports:{}};return Xg[i].call(e.exports,e,e.exports,Mt),e.exports}Mt.d=(i,t)=>{for(var e in t)Mt.o(t,e)&&!Mt.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:t[e]})};Mt.o=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var Ht=globalThis.pdfjsViewer={};Mt.d(Ht,{AnnotationLayerBuilder:()=>Fh,DownloadManager:()=>Vm,EventBus:()=>kh,FindState:()=>As,GenericL10n:()=>us,LinkTarget:()=>_s,PDFFindController:()=>Im,PDFHistory:()=>$v,PDFLinkService:()=>pr,PDFPageView:()=>Uh,PDFScriptingManager:()=>Zv,PDFSinglePageViewer:()=>ey,PDFViewer:()=>zh,ProgressBar:()=>rm,RenderingStates:()=>Vt,ScrollMode:()=>Pt,SimpleLinkService:()=>to,SpreadMode:()=>ae,StructTreeLayerBuilder:()=>Hh,TextLayerBuilder:()=>rn,XfaLayerBuilder:()=>Vh,parseQueryString:()=>fr});Mt(4114);Mt(6573);Mt(8100);Mt(7936);Mt(4628);Mt(7642);Mt(8004);Mt(3853);Mt(5876);Mt(2475);Mt(5024);Mt(1698);Mt(7467);Mt(4732);Mt(9577);Mt(8992);Mt(4520);Mt(1454);Mt(4603);Mt(7566);Mt(8721);const Kg="auto",Nh=1,ll=1.1,Yg=.1,Jg=10,Fr=0,Zg=1.25,cl=40,hl=5,Vt={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},nn={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},ts={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},Pt={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},ae={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};function Dh(i,t,e=!1){let s=i.offsetParent;if(!s){console.error("offsetParent is not set -- cannot scroll");return}let n=i.offsetTop+i.clientTop,r=i.offsetLeft+i.clientLeft;for(;s.clientHeight===s.scrollHeight&&s.clientWidth===s.scrollWidth||e&&(s.classList.contains("markedContent")||getComputedStyle(s).overflow==="hidden");)if(n+=s.offsetTop,r+=s.offsetLeft,s=s.offsetParent,!s)return;t&&(t.top!==void 0&&(n+=t.top),t.left!==void 0&&(r+=t.left,s.scrollLeft=r)),s.scrollTop=n}function Qg(i,t,e=void 0){const s=function(a){r||(r=window.requestAnimationFrame(function(){r=null;const l=i.scrollLeft,c=n.lastX;l!==c&&(n.right=l>c),n.lastX=l;const h=i.scrollTop,u=n.lastY;h!==u&&(n.down=h>u),n.lastY=h,t(n)}))},n={right:!0,down:!0,lastX:i.scrollLeft,lastY:i.scrollTop,_eventHandler:s};let r=null;return i.addEventListener("scroll",s,{useCapture:!0,signal:e}),e?.addEventListener("abort",()=>window.cancelAnimationFrame(r),{once:!0}),n}function fr(i){const t=new Map;for(const[e,s]of new URLSearchParams(i))t.set(e.toLowerCase(),s);return t}const ul=/[\x00-\x1F]/g;function kn(i,t=!1){return ul.test(i)?t?i.replaceAll(ul,e=>e==="\0"?"":" "):i.replaceAll("\0",""):i}function Jn(i,t,e=0){let s=e,n=i.length-1;if(n<0||!t(i[n]))return i.length;if(t(i[s]))return s;for(;s<n;){const r=s+n>>1,a=i[r];t(a)?n=r:s=r+1}return s}function dl(i){if(Math.floor(i)===i)return[i,1];const t=1/i,e=8;if(t>e)return[1,e];if(Math.floor(t)===t)return[1,t];const s=i>1?t:i;let n=0,r=1,a=1,o=1;for(;;){const c=n+a,h=r+o;if(h>e)break;s<=c/h?(a=c,o=h):(n=c,r=h)}let l;return s-n/r<a/o-s?l=s===i?[n,r]:[r,n]:l=s===i?[a,o]:[o,a],l}function ui(i,t){return i-i%t}function qg(i,t,e){if(i<2)return i;let s=t[i].div,n=s.offsetTop+s.clientTop;n>=e&&(s=t[i-1].div,n=s.offsetTop+s.clientTop);for(let r=i-2;r>=0&&(s=t[r].div,!(s.offsetTop+s.clientTop+s.clientHeight<=n));--r)i=r;return i}function tm({scrollEl:i,views:t,sortByVisibility:e=!1,horizontal:s=!1,rtl:n=!1}){const r=i.scrollTop,a=r+i.clientHeight,o=i.scrollLeft,l=o+i.clientWidth;function c(y){const w=y.div;return w.offsetTop+w.clientTop+w.clientHeight>r}function h(y){const w=y.div,b=w.offsetLeft+w.clientLeft,A=b+w.clientWidth;return n?b<l:A>o}const u=[],d=new Set,f=t.length;let p=Jn(t,s?h:c);p>0&&p<f&&!s&&(p=qg(p,t,r));let g=s?l:-1;for(let y=p;y<f;y++){const w=t[y],b=w.div,A=b.offsetLeft+b.clientLeft,S=b.offsetTop+b.clientTop,T=b.clientWidth,R=b.clientHeight,x=A+T,I=S+R;if(g===-1)I>=a&&(g=I);else if((s?A:S)>g)break;if(I<=r||S>=a||x<=o||A>=l)continue;const M=Math.max(0,r-S)+Math.max(0,I-a),H=Math.max(0,o-A)+Math.max(0,x-l),B=(R-M)/R,W=(T-H)/T,et=B*W*100|0;u.push({id:w.id,x:A,y:S,view:w,percent:et,widthPercent:W*100|0}),d.add(w.id)}const m=u[0],v=u.at(-1);return e&&u.sort(function(y,w){const b=y.percent-w.percent;return Math.abs(b)>.001?-b:y.id-w.id}),{first:m,last:v,views:u,ids:d}}function _h(i){return Number.isInteger(i)&&i%90===0}function em(i){return Number.isInteger(i)&&Object.values(Pt).includes(i)&&i!==Pt.UNKNOWN}function sm(i){return Number.isInteger(i)&&Object.values(ae).includes(i)&&i!==ae.UNKNOWN}function fl(i){return i.width<=i.height}new Promise(function(i){window.requestAnimationFrame(i)});const nm=document.documentElement.style;function im(i,t,e){return Math.min(Math.max(i,t),e)}class rm{#t=null;#e=null;#s=0;#n=null;#r=!0;constructor(t){this.#t=t.classList,this.#n=t.style}get percent(){return this.#s}set percent(t){if(this.#s=im(t,0,100),isNaN(t)){this.#t.add("indeterminate");return}this.#t.remove("indeterminate"),this.#n.setProperty("--progressBar-percent",`${this.#s}%`)}setWidth(t){if(!t)return;const s=t.parentNode.offsetWidth-t.offsetWidth;s>0&&this.#n.setProperty("--progressBar-end-offset",`${s}px`)}setDisableAutoFetch(t=5e3){this.#s===100||isNaN(this.#s)||(this.#e&&clearTimeout(this.#e),this.show(),this.#e=setTimeout(()=>{this.#e=null,this.hide()},t))}hide(){this.#r&&(this.#r=!1,this.#t.add("hidden"))}show(){this.#r||(this.#r=!0,this.#t.remove("hidden"))}}function am(i){let t=Pt.VERTICAL,e=ae.NONE;switch(i){case"SinglePage":t=Pt.PAGE;break;case"OneColumn":break;case"TwoPageLeft":t=Pt.PAGE;case"TwoColumnLeft":e=ae.ODD;break;case"TwoPageRight":t=Pt.PAGE;case"TwoColumnRight":e=ae.EVEN;break}return{scrollMode:t,spreadMode:e}}const di=(function(){const i=document.createElement("div");return i.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",i.style.width==="calc(1320px)"?Math.fround:t=>t})(),je={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function om(i){return i<11904}function lm(i){return(i&65408)===0}function cm(i){return i>=97&&i<=122||i>=65&&i<=90}function hm(i){return i>=48&&i<=57}function um(i){return i===32||i===9||i===13||i===10}function dm(i){return i>=13312&&i<=40959||i>=63744&&i<=64255}function fm(i){return i>=12448&&i<=12543}function pm(i){return i>=12352&&i<=12447}function gm(i){return i>=65376&&i<=65439}function mm(i){return(i&65408)===3584}function fi(i){return om(i)?lm(i)?um(i)?je.SPACE:cm(i)||hm(i)||i===95?je.ALPHA_LETTER:je.PUNCT:mm(i)?je.THAI_LETTER:i===160?je.SPACE:je.ALPHA_LETTER:dm(i)?je.HAN_LETTER:fm(i)?je.KATAKANA_LETTER:pm(i)?je.HIRAGANA_LETTER:gm(i)?je.HALFWIDTH_KATAKANA_LETTER:je.ALPHA_LETTER}let pl;function vm(){return pl||="---------------------------------------------------------------------------------------------------",pl}const As={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},ym=250,bm=-50,Am=-400,gl={"":"-","":"'","":"'","":"'","":"'","":'"',"":'"',"":'"',"":'"',"":"1/4","":"1/2","":"3/4"},ml=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let vl;const wm=new RegExp("\\p{M}+","gu"),xm=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),Em=new RegExp("([^\\p{M}])\\p{M}*$","u"),Sm=new RegExp("^\\p{M}*([^\\p{M}])","u"),Tm=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,yl=new Map,Pm="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",bl=new Map;let kr=null,jr=null;function $r(i){const t=[];let e;for(;(e=Tm.exec(i))!==null;){let{index:g}=e;for(const m of e[0]){let v=yl.get(m);v||(v=m.normalize("NFD").length,yl.set(m,v)),t.push([v,g++])}}let s;if(t.length===0&&kr)s=kr;else if(t.length>0&&jr)s=jr;else{const g=Object.keys(gl).join(""),m=vm(),b=`([${g}])|([${m}])|((?:|)\\n)|(\\p{M}+(?:-\\n)?)|(\\p{Ll}-\\n\\p{Lu})|(\\S-\\n)|((?:\\p{Ideographic}|[-])\\n)|(\\n)`;t.length===0?s=kr=new RegExp(b+"|(\\u0000)","gum"):s=jr=new RegExp(b+`|(${Pm})`,"gum")}const n=[];for(;(e=wm.exec(i))!==null;)n.push([e[0].length,e.index]);let r=i.normalize("NFD");const a=[0,0];let o=0,l=0,c=0,h=0,u=0,d=!1;r=r.replace(s,(g,m,v,y,w,b,A,S,T,R,x)=>{if(x-=h,m){const I=gl[m],M=I.length;for(let H=1;H<M;H++)a.push(x-c+H,c-H);return c-=M-1,I}if(v){let I=bl.get(v);I||(I=v.normalize("NFKC"),bl.set(v,I));const M=I.length;for(let H=1;H<M;H++)a.push(x-c+H,c-H);return c-=M-1,I}if(y)return d=!0,x+u===n[o]?.[1]?++o:(a.push(x-1-c+1,c-1),c-=1,h+=1),a.push(x-c+1,c),h+=1,u+=1,y.charAt(0);if(w){const I=w.endsWith(`
`),M=I?w.length-2:w.length;d=!0;let H=M;x+u===n[o]?.[1]&&(H-=n[o][0],++o);for(let B=1;B<=H;B++)a.push(x-1-c+B,c-B);return c-=H,h+=H,I?(x+=M-1,a.push(x-c+1,1+c),c+=1,h+=1,u+=1,w.slice(0,M)):w}if(b)return h+=1,u+=1,b.replace(`
`,"");if(A){const I=A.length-2;return a.push(x-c+I,1+c),c+=1,h+=1,u+=1,A.slice(0,-2)}if(S){const I=S.length-1;return a.push(x-c+I,c),h+=1,u+=1,S.slice(0,-1)}if(T)return a.push(x-c+1,c-1),c-=1,h+=1,u+=1," ";if(x+u===t[l]?.[1]){const I=t[l][0]-1;++l;for(let M=1;M<=I;M++)a.push(x-(c-M),c-M);c-=I,h+=I}return R}),a.push(r.length,c);const f=new Uint32Array(a.length>>1),p=new Int32Array(a.length>>1);for(let g=0,m=a.length;g<m;g+=2)f[g>>1]=a[g],p[g>>1]=a[g+1];return[r,[f,p],d]}function Cm(i,t,e){if(!i)return[t,e];const[s,n]=i,r=t,a=t+e-1;let o=Jn(s,d=>d>=r);s[o]>r&&--o;let l=Jn(s,d=>d>=a,o);s[l]>a&&--l;const c=r+n[o],u=a+n[l]+1-c;return[c,u]}class Im{#t=null;#e=!0;#s=0;constructor({linkService:t,eventBus:e,updateMatchesCountOnProgress:s=!0}){this._linkService=t,this._eventBus=e,this.#e=s,this.onIsPageVisible=null,this.#r(),e._on("find",this.#n.bind(this)),e._on("findbarclose",this.#y.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#t}setDocument(t){this._pdfDocument&&this.#r(),t&&(this._pdfDocument=t,this._firstPageCapability.resolve())}#n(t){if(!t)return;const e=this._pdfDocument,{type:s}=t;(this.#t===null||this.#a(t))&&(this._dirtyMatch=!0),this.#t=t,s!=="highlightallchange"&&this.#x(As.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||e&&this._pdfDocument!==e)return;this.#d();const n=!this._highlightMatches,r=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),s?this._dirtyMatch?this.#o():s==="again"?(this.#o(),n&&this.#t.highlightAll&&this.#f()):s==="highlightallchange"?(r?this.#o():this._highlightMatches=!0,this.#f()):this.#o():this._findTimeout=setTimeout(()=>{this.#o(),this._findTimeout=null},ym)})}scrollMatchIntoView({element:t=null,selectedLeft:e=0,pageIndex:s=-1,matchIndex:n=-1}){if(!this._scrollMatches||!t)return;if(n===-1||n!==this._selected.matchIdx)return;if(s===-1||s!==this._selected.pageIdx)return;this._scrollMatches=!1;const r={top:bm,left:e+Am};Dh(t,r,!0)}#r(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#s=0,this.#t=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#i(){const{query:t}=this.#t;return typeof t=="string"?(t!==this._rawQuery&&(this._rawQuery=t,[this._normalizedQuery]=$r(t)),this._normalizedQuery):(t||[]).filter(e=>!!e).map(e=>$r(e)[0])}#a(t){const e=t.query,s=this.#t.query,n=typeof e;if(n!==typeof s)return!0;if(n==="string"){if(e!==s)return!0}else if(JSON.stringify(e)!==JSON.stringify(s))return!0;switch(t.type){case"again":const a=this._selected.pageIdx+1,o=this._linkService;return a>=1&&a<=o.pagesCount&&a!==o.page&&!(this.onIsPageVisible?.(a)??!0);case"highlightallchange":return!1}return!0}#l(t,e,s){let n=t.slice(0,e).match(Em);if(n){const r=t.charCodeAt(e),a=n[1].charCodeAt(0);if(fi(r)===fi(a))return!1}if(n=t.slice(e+s).match(Sm),n){const r=t.charCodeAt(e+s-1),a=n[1].charCodeAt(0);if(fi(r)===fi(a))return!1}return!0}#h(t,e){const{matchDiacritics:s}=this.#t;let n=!1;t=t.replaceAll(xm,(a,o,l,c,h,u)=>o?`[ ]*\\${o}[ ]*`:l?`[ ]*${l}[ ]*`:c?"[ ]+":s?h||u:h?ml.has(h.charCodeAt(0))?h:"":e?(n=!0,`${u}\\p{M}*`):u);const r="[ ]*";return t.endsWith(r)&&(t=t.slice(0,t.length-r.length)),s&&e&&(vl||=String.fromCharCode(...ml),n=!0,t=`${t}(?=[${vl}]|[^\\p{M}]|$)`),[n,t]}#c(t){const e=this.#i;if(e.length===0)return;const s=this._pageContents[t],n=this.match(e,s,t),r=this._pageMatches[t]=[],a=this._pageMatchesLength[t]=[],o=this._pageDiffs[t];n?.forEach(({index:c,length:h})=>{const[u,d]=Cm(o,c,h);d&&(r.push(u),a.push(d))}),this.#t.highlightAll&&this.#u(t),this._resumePageIdx===t&&(this._resumePageIdx=null,this.#m());const l=r.length;this._matchesCountTotal+=l,this.#e?l>0&&this.#A():++this.#s===this._linkService.pagesCount&&this.#A()}match(t,e,s){const n=this._hasDiacritics[s];let r=!1;if(typeof t=="string"?[r,t]=this.#h(t,n):t=t.sort().reverse().map(u=>{const[d,f]=this.#h(u,n);return r||=d,`(${f})`}).join("|"),!t)return;const{caseSensitive:a,entireWord:o}=this.#t,l=`g${r?"u":""}${a?"":"i"}`;t=new RegExp(t,l);const c=[];let h;for(;(h=t.exec(e))!==null;)o&&!this.#l(e,h.index,h[0].length)||c.push({index:h.index,length:h[0].length});return c}#d(){if(this._extractTextPromises.length>0)return;let t=Promise.resolve();const e={disableNormalization:!0};for(let s=0,n=this._linkService.pagesCount;s<n;s++){const{promise:r,resolve:a}=Promise.withResolvers();this._extractTextPromises[s]=r,t=t.then(()=>this._pdfDocument.getPage(s+1).then(o=>o.getTextContent(e)).then(o=>{const l=[];for(const c of o.items)l.push(c.str),c.hasEOL&&l.push(`
`);[this._pageContents[s],this._pageDiffs[s],this._hasDiacritics[s]]=$r(l.join("")),a()},o=>{console.error(`Unable to get text content for page ${s+1}`,o),this._pageContents[s]="",this._pageDiffs[s]=null,this._hasDiacritics[s]=!1,a()}))}}#u(t){this._scrollMatches&&this._selected.pageIdx===t&&(this._linkService.page=t+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:t})}#f(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#o(){const t=this.#t.findPrevious,e=this._linkService.page-1,s=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=e,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#s=0,this._matchesCountTotal=0,this.#f();for(let a=0;a<s;a++)this._pendingFindMatches.has(a)||(this._pendingFindMatches.add(a),this._extractTextPromises[a].then(()=>{this._pendingFindMatches.delete(a),this.#c(a)}))}if(this.#i.length===0){this.#x(As.FOUND);return}if(this._resumePageIdx)return;const r=this._offset;if(this._pagesToSearch=s,r.matchIdx!==null){const a=this._pageMatches[r.pageIdx].length;if(!t&&r.matchIdx+1<a||t&&r.matchIdx>0){r.matchIdx=t?r.matchIdx-1:r.matchIdx+1,this.#v(!0);return}this.#g(t)}this.#m()}#p(t){const e=this._offset,s=t.length,n=this.#t.findPrevious;return s?(e.matchIdx=n?s-1:0,this.#v(!0),!0):(this.#g(n),e.wrapped&&(e.matchIdx=null,this._pagesToSearch<0)?(this.#v(!1),!0):!1)}#m(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let t=null;do{const e=this._offset.pageIdx;if(t=this._pageMatches[e],!t){this._resumePageIdx=e;break}}while(!this.#p(t))}#g(t){const e=this._offset,s=this._linkService.pagesCount;e.pageIdx=t?e.pageIdx-1:e.pageIdx+1,e.matchIdx=null,this._pagesToSearch--,(e.pageIdx>=s||e.pageIdx<0)&&(e.pageIdx=t?s-1:0,e.wrapped=!0)}#v(t=!1){let e=As.NOT_FOUND;const s=this._offset.wrapped;if(this._offset.wrapped=!1,t){const n=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,e=s?As.WRAPPED:As.FOUND,n!==-1&&n!==this._selected.pageIdx&&this.#u(n)}this.#x(e,this.#t.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#u(this._selected.pageIdx))}#y(t){const e=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||e&&this._pdfDocument!==e||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#x(As.FOUND),this._highlightMatches=!1,this.#f())})}#b(){const{pageIdx:t,matchIdx:e}=this._selected;let s=0,n=this._matchesCountTotal;if(e!==-1){for(let r=0;r<t;r++)s+=this._pageMatches[r]?.length||0;s+=e+1}return(s<1||s>n)&&(s=n=0),{current:s,total:n}}#A(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#b()})}#x(t,e=!1){!this.#e&&(this.#s!==this._linkService.pagesCount||t===As.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:t,previous:e,entireWord:this.#t?.entireWord??null,matchesCount:this.#b(),rawQuery:this.#t?.query??null})}}Mt(8335);const Rm="noopener noreferrer nofollow",_s={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};class pr{externalLinkEnabled=!0;constructor({eventBus:t,externalLinkTarget:e=null,externalLinkRel:s=null,ignoreDestinationZoom:n=!1}={}){this.eventBus=t,this.externalLinkTarget=e,this.externalLinkRel=s,this._ignoreDestinationZoom=n,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(t,e=null){this.baseUrl=e,this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(t){this.pdfDocument&&(this.pdfViewer.currentPageNumber=t)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(t){this.pdfDocument&&(this.pdfViewer.pagesRotation=t)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}async goToDestination(t){if(!this.pdfDocument)return;let e,s,n;if(typeof t=="string"?(e=t,s=await this.pdfDocument.getDestination(t)):(e=null,s=await t),!Array.isArray(s)){console.error(`goToDestination: "${s}" is not a valid destination array, for dest="${t}".`);return}const[r]=s;if(r&&typeof r=="object"){if(n=this.pdfDocument.cachedPageNumber(r),!n)try{n=await this.pdfDocument.getPageIndex(r)+1}catch{console.error(`goToDestination: "${r}" is not a valid page reference, for dest="${t}".`);return}}else Number.isInteger(r)&&(n=r+1);if(!n||n<1||n>this.pagesCount){console.error(`goToDestination: "${n}" is not a valid page number, for dest="${t}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:e,explicitDest:s,pageNumber:n})),this.pdfViewer.scrollPageIntoView({pageNumber:n,destArray:s,ignoreDestinationZoom:this._ignoreDestinationZoom})}goToPage(t){if(!this.pdfDocument)return;const e=typeof t=="string"&&this.pdfViewer.pageLabelToPageNumber(t)||t|0;if(!(Number.isInteger(e)&&e>0&&e<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${t}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(e)),this.pdfViewer.scrollPageIntoView({pageNumber:e})}addLinkAttributes(t,e,s=!1){if(!e||typeof e!="string")throw new Error('A valid "url" parameter must provided.');const n=s?_s.BLANK:this.externalLinkTarget,r=this.externalLinkRel;this.externalLinkEnabled?t.href=t.title=e:(t.href="",t.title=`Disabled: ${e}`,t.onclick=()=>!1);let a="";switch(n){case _s.NONE:break;case _s.SELF:a="_self";break;case _s.BLANK:a="_blank";break;case _s.PARENT:a="_parent";break;case _s.TOP:a="_top";break}t.target=a,t.rel=typeof r=="string"?r:Rm}getDestinationHash(t){if(typeof t=="string"){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const e=JSON.stringify(t);if(e.length>0)return this.getAnchorUrl("#"+escape(e))}return this.getAnchorUrl("")}getAnchorUrl(t){return this.baseUrl?this.baseUrl+t:t}setHash(t){if(!this.pdfDocument)return;let e,s;if(t.includes("=")){const n=fr(t);if(n.has("search")){const r=n.get("search").replaceAll('"',""),a=n.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:a?r:r.match(/\S+/g)})}if(n.has("page")&&(e=n.get("page")|0||1),n.has("zoom")){const r=n.get("zoom").split(","),a=r[0],o=parseFloat(a);a.includes("Fit")?a==="Fit"||a==="FitB"?s=[null,{name:a}]:a==="FitH"||a==="FitBH"||a==="FitV"||a==="FitBV"?s=[null,{name:a},r.length>1?r[1]|0:null]:a==="FitR"?r.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):s=[null,{name:a},r[1]|0,r[2]|0,r[3]|0,r[4]|0]:console.error(`PDFLinkService.setHash: "${a}" is not a valid zoom value.`):s=[null,{name:"XYZ"},r.length>1?r[1]|0:null,r.length>2?r[2]|0:null,o?o/100:a]}s?this.pdfViewer.scrollPageIntoView({pageNumber:e||this.page,destArray:s,allowNegativeOffset:!0}):e&&(this.page=e),n.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:n.get("pagemode")}),n.has("nameddest")&&this.goToDestination(n.get("nameddest"));return}s=unescape(t);try{s=JSON.parse(s),Array.isArray(s)||(s=s.toString())}catch{}if(typeof s=="string"||pr.#t(s)){this.goToDestination(s);return}console.error(`PDFLinkService.setHash: "${unescape(t)}" is not a valid destination.`)}executeNamedAction(t){if(this.pdfDocument){switch(t){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:t})}}async executeSetOCGState(t){if(!this.pdfDocument)return;const e=this.pdfDocument,s=await this.pdfViewer.optionalContentConfigPromise;e===this.pdfDocument&&(s.setOCGState(t),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(s))}static#t(t){if(!Array.isArray(t)||t.length<2)return!1;const[e,s,...n]=t;if(!(typeof e=="object"&&Number.isInteger(e?.num)&&Number.isInteger(e?.gen))&&!Number.isInteger(e)||!(typeof s=="object"&&typeof s?.name=="string"))return!1;const r=n.length;let a=!0;switch(s.name){case"XYZ":if(r<2||r>3)return!1;break;case"Fit":case"FitB":return r===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(r>1)return!1;break;case"FitR":if(r!==4)return!1;a=!1;break;default:return!1}for(const o of n)if(!(typeof o=="number"||a&&o===null))return!1;return!0}}class to extends pr{setDocument(t,e=null){}}const{AbortException:Mm,AnnotationEditorLayer:Lm,AnnotationEditorParamsType:z0,AnnotationEditorType:Re,AnnotationEditorUIManager:Om,AnnotationLayer:Nm,AnnotationMode:hs,build:W0,ColorPicker:G0,createValidAbsoluteUrl:Dm,DOMSVGFactory:X0,DrawLayer:_m,FeatureTest:K0,fetchData:Al,getDocument:Y0,getFilenameFromUrl:J0,getPdfFilenameFromUrl:Fm,getXfaPageViewport:Z0,GlobalWorkerOptions:Q0,ImageKind:q0,InvalidPDFException:tA,isDataScheme:eA,isPdfFile:km,MissingPDFException:sA,noContextMenu:nA,normalizeUnicode:jm,OPS:iA,OutputScale:$m,PasswordResponses:rA,PDFDataRangeTransport:aA,PDFDateString:oA,PDFWorker:lA,PermissionFlag:pi,PixelsPerInch:os,RenderingCancelledException:da,setLayerDimensions:Bm,shadow:ki,stopEvent:fa,TextLayer:Hm,TouchManager:cA,UnexpectedResponseException:hA,Util:uA,VerbosityLevel:dA,version:wl,XfaLayer:Br}=globalThis.pdfjsLib;class Fh{#t=null;#e=null;constructor({pdfPage:t,linkService:e,downloadManager:s,annotationStorage:n=null,imageResourcesPath:r="",renderForms:a=!0,enableScripting:o=!1,hasJSActionsPromise:l=null,fieldObjectsPromise:c=null,annotationCanvasMap:h=null,accessibilityManager:u=null,annotationEditorUIManager:d=null,onAppend:f=null}){this.pdfPage=t,this.linkService=e,this.downloadManager=s,this.imageResourcesPath=r,this.renderForms=a,this.annotationStorage=n,this.enableScripting=o,this._hasJSActionsPromise=l||Promise.resolve(!1),this._fieldObjectsPromise=c||Promise.resolve(null),this._annotationCanvasMap=h,this._accessibilityManager=u,this._annotationEditorUIManager=d,this.#t=f,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=e.eventBus}async render(t,e,s="display"){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:t.clone({dontFlip:!0})});return}const[n,r,a]=await Promise.all([this.pdfPage.getAnnotations({intent:s}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const o=this.div=document.createElement("div");if(o.className="annotationLayer",this.#t?.(o),n.length===0){this.hide();return}this.annotationLayer=new Nm({div:o,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:t.clone({dontFlip:!0}),structTreeLayer:e?.structTreeLayer||null}),await this.annotationLayer.render({annotations:n,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:r,fieldObjects:a}),this.linkService.isInPresentationMode&&this.#s(nn.FULLSCREEN),this.#e||(this.#e=new AbortController,this._eventBus?._on("presentationmodechanged",l=>{this.#s(l.state)},{signal:this.#e.signal}))}cancel(){this._cancelled=!0,this.#e?.abort(),this.#e=null}hide(){this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}#s(t){if(!this.div)return;let e=!1;switch(t){case nn.FULLSCREEN:e=!0;break;case nn.NORMAL:break;default:return}for(const s of this.div.childNodes)s.hasAttribute("data-internal-link")||(s.inert=e)}}function xl(i,t){const e=document.createElement("a");if(!e.click)throw new Error('DownloadManager: "a.click()" is not supported.');e.href=i,e.target="_parent","download"in e&&(e.download=t),(document.body||document.documentElement).append(e),e.click(),e.remove()}class Vm{#t=new WeakMap;downloadData(t,e,s){const n=URL.createObjectURL(new Blob([t],{type:s}));xl(n,e)}openOrDownloadData(t,e,s=null){const r=km(e)?"application/pdf":"";return this.downloadData(t,e,r),!1}download(t,e,s){let n;if(t)n=URL.createObjectURL(new Blob([t],{type:"application/pdf"}));else{if(!Dm(e,"http://example.com")){console.error(`download - not a valid URL: ${e}`);return}n=e+"#pdfjs.action=download"}xl(n,s)}}const El={EVENT:"event",TIMEOUT:"timeout"};async function Um({target:i,name:t,delay:e=0}){if(typeof i!="object"||!(Number.isInteger(e)&&e>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");const{promise:s,resolve:n}=Promise.withResolvers(),r=new AbortController;function a(c){r.abort(),clearTimeout(l),n(c)}const o=i instanceof kh?"_on":"addEventListener";i[o](t,a.bind(null,El.EVENT),{signal:r.signal});const l=setTimeout(a.bind(null,El.TIMEOUT),e);return s}class kh{#t=Object.create(null);on(t,e,s=null){this._on(t,e,{external:!0,once:s?.once,signal:s?.signal})}off(t,e,s=null){this._off(t,e)}dispatch(t,e){const s=this.#t[t];if(!s||s.length===0)return;let n;for(const{listener:r,external:a,once:o}of s.slice(0)){if(o&&this._off(t,r),a){(n||=[]).push(r);continue}r(e)}if(n){for(const r of n)r(e);n=null}}_on(t,e,s=null){let n=null;if(s?.signal instanceof AbortSignal){const{signal:a}=s;if(a.aborted){console.error("Cannot use an `aborted` signal.");return}const o=()=>this._off(t,e);n=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}(this.#t[t]||=[]).push({listener:e,external:s?.external===!0,once:s?.once===!0,rmAbort:n})}_off(t,e,s=null){const n=this.#t[t];if(n)for(let r=0,a=n.length;r<a;r++){const o=n[r];if(o.listener===e){o.rmAbort?.(),n.splice(r,1);return}}}}class gr{constructor(t){this.value=t}valueOf(){return this.value}}class Jt extends gr{constructor(t="???"){super(t)}toString(t){return`{${this.value}}`}}class ds extends gr{constructor(t,e={}){super(t),this.opts=e}toString(t){try{return t.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(e){return t.reportError(e),this.value.toString(10)}}}class jn extends gr{constructor(t,e={}){super(t),this.opts=e}toString(t){try{return t.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(e){return t.reportError(e),new Date(this.value).toISOString()}}}const Sl=100,zm="",Wm="";function Gm(i,t,e){if(e===t||e instanceof ds&&t instanceof ds&&e.value===t.value)return!0;if(t instanceof ds&&typeof e=="string"){let s=i.memoizeIntlObject(Intl.PluralRules,t.opts).select(t.value);if(e===s)return!0}return!1}function Tl(i,t,e){return t[e]?dn(i,t[e].value):(i.reportError(new RangeError("No default")),new Jt)}function pa(i,t){const e=[],s=Object.create(null);for(const n of t)n.type==="narg"?s[n.name]=Zn(i,n.value):e.push(Zn(i,n));return{positional:e,named:s}}function Zn(i,t){switch(t.type){case"str":return t.value;case"num":return new ds(t.value,{minimumFractionDigits:t.precision});case"var":return Xm(i,t);case"mesg":return Km(i,t);case"term":return Ym(i,t);case"func":return Jm(i,t);case"select":return Zm(i,t);default:return new Jt}}function Xm(i,{name:t}){let e;if(i.params)if(Object.prototype.hasOwnProperty.call(i.params,t))e=i.params[t];else return new Jt(`$${t}`);else if(i.args&&Object.prototype.hasOwnProperty.call(i.args,t))e=i.args[t];else return i.reportError(new ReferenceError(`Unknown variable: $${t}`)),new Jt(`$${t}`);if(e instanceof gr)return e;switch(typeof e){case"string":return e;case"number":return new ds(e);case"object":if(e instanceof Date)return new jn(e.getTime());default:return i.reportError(new TypeError(`Variable type not supported: $${t}, ${typeof e}`)),new Jt(`$${t}`)}}function Km(i,{name:t,attr:e}){const s=i.bundle._messages.get(t);if(!s)return i.reportError(new ReferenceError(`Unknown message: ${t}`)),new Jt(t);if(e){const n=s.attributes[e];return n?dn(i,n):(i.reportError(new ReferenceError(`Unknown attribute: ${e}`)),new Jt(`${t}.${e}`))}return s.value?dn(i,s.value):(i.reportError(new ReferenceError(`No value: ${t}`)),new Jt(t))}function Ym(i,{name:t,attr:e,args:s}){const n=`-${t}`,r=i.bundle._terms.get(n);if(!r)return i.reportError(new ReferenceError(`Unknown term: ${n}`)),new Jt(n);if(e){const o=r.attributes[e];if(o){i.params=pa(i,s).named;const l=dn(i,o);return i.params=null,l}return i.reportError(new ReferenceError(`Unknown attribute: ${e}`)),new Jt(`${n}.${e}`)}i.params=pa(i,s).named;const a=dn(i,r.value);return i.params=null,a}function Jm(i,{name:t,args:e}){let s=i.bundle._functions[t];if(!s)return i.reportError(new ReferenceError(`Unknown function: ${t}()`)),new Jt(`${t}()`);if(typeof s!="function")return i.reportError(new TypeError(`Function ${t}() is not callable`)),new Jt(`${t}()`);try{let n=pa(i,e);return s(n.positional,n.named)}catch(n){return i.reportError(n),new Jt(`${t}()`)}}function Zm(i,{selector:t,variants:e,star:s}){let n=Zn(i,t);if(n instanceof Jt)return Tl(i,e,s);for(const r of e){const a=Zn(i,r.key);if(Gm(i,n,a))return dn(i,r.value)}return Tl(i,e,s)}function jh(i,t){if(i.dirty.has(t))return i.reportError(new RangeError("Cyclic reference")),new Jt;i.dirty.add(t);const e=[],s=i.bundle._useIsolating&&t.length>1;for(const n of t){if(typeof n=="string"){e.push(i.bundle._transform(n));continue}if(i.placeables++,i.placeables>Sl)throw i.dirty.delete(t),new RangeError(`Too many placeables expanded: ${i.placeables}, max allowed is ${Sl}`);s&&e.push(zm),e.push(Zn(i,n).toString(i)),s&&e.push(Wm)}return i.dirty.delete(t),e.join("")}function dn(i,t){return typeof t=="string"?i.bundle._transform(t):jh(i,t)}class Qm{constructor(t,e,s){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=t,this.errors=e,this.args=s}reportError(t){if(!this.errors||!(t instanceof Error))throw t;this.errors.push(t)}memoizeIntlObject(t,e){let s=this.bundle._intls.get(t);s||(s={},this.bundle._intls.set(t,s));let n=JSON.stringify(e);return s[n]||(s[n]=new t(this.bundle.locales,e)),s[n]}}function ji(i,t){const e=Object.create(null);for(const[s,n]of Object.entries(i))t.includes(s)&&(e[s]=n.valueOf());return e}const Pl=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function qm(i,t){let e=i[0];if(e instanceof Jt)return new Jt(`NUMBER(${e.valueOf()})`);if(e instanceof ds)return new ds(e.valueOf(),{...e.opts,...ji(t,Pl)});if(e instanceof jn)return new ds(e.valueOf(),{...ji(t,Pl)});throw new TypeError("Invalid argument to NUMBER")}const Cl=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function tv(i,t){let e=i[0];if(e instanceof Jt)return new Jt(`DATETIME(${e.valueOf()})`);if(e instanceof jn)return new jn(e.valueOf(),{...e.opts,...ji(t,Cl)});if(e instanceof ds)return new jn(e.valueOf(),{...ji(t,Cl)});throw new TypeError("Invalid argument to DATETIME")}const Il=new Map;function ev(i){const t=Array.isArray(i)?i.join(" "):i;let e=Il.get(t);return e===void 0&&(e=new Map,Il.set(t,e)),e}class sv{constructor(t,{functions:e,useIsolating:s=!0,transform:n=r=>r}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(t)?t:[t],this._functions={NUMBER:qm,DATETIME:tv,...e},this._useIsolating=s,this._transform=n,this._intls=ev(t)}hasMessage(t){return this._messages.has(t)}getMessage(t){return this._messages.get(t)}addResource(t,{allowOverrides:e=!1}={}){const s=[];for(let n=0;n<t.body.length;n++){let r=t.body[n];if(r.id.startsWith("-")){if(e===!1&&this._terms.has(r.id)){s.push(new Error(`Attempt to override an existing term: "${r.id}"`));continue}this._terms.set(r.id,r)}else{if(e===!1&&this._messages.has(r.id)){s.push(new Error(`Attempt to override an existing message: "${r.id}"`));continue}this._messages.set(r.id,r)}}return s}formatPattern(t,e=null,s=null){if(typeof t=="string")return this._transform(t);let n=new Qm(this,s,e);try{return jh(n,t).toString(n)}catch(r){if(n.errors&&r instanceof Error)return n.errors.push(r),new Jt().toString(n);throw r}}}const Hr=/^(-?[a-zA-Z][\w-]*) *= */gm,Rl=/\.([a-zA-Z][\w-]*) *= */y,nv=/\*?\[/y,Vr=/(-?[0-9]+(?:\.([0-9]+))?)/y,iv=/([a-zA-Z][\w-]*)/y,Ml=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,rv=/^[A-Z][A-Z0-9_-]*$/,gi=/([^{}\n\r]+)/y,av=/([^\\"\n\r]*)/y,Ll=/\\([\\"])/y,Ol=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,ov=/^\n+/,Nl=/ +$/,lv=/ *\r?\n/g,cv=/( *)$/,hv=/{\s*/y,Dl=/\s*}/y,uv=/\[\s*/y,dv=/\s*] */y,fv=/\s*\(\s*/y,pv=/\s*->\s*/y,gv=/\s*:\s*/y,mv=/\s*,?\s*/y,vv=/\s+/y;class yv{constructor(t){this.body=[],Hr.lastIndex=0;let e=0;for(;;){let x=Hr.exec(t);if(x===null)break;e=Hr.lastIndex;try{this.body.push(l(x[1]))}catch(I){if(I instanceof SyntaxError)continue;throw I}}function s(x){return x.lastIndex=e,x.test(t)}function n(x,I){if(t[e]===x)return e++,!0;if(I)throw new I(`Expected ${x}`);return!1}function r(x,I){if(s(x))return e=x.lastIndex,!0;if(I)throw new I(`Expected ${x.toString()}`);return!1}function a(x){x.lastIndex=e;let I=x.exec(t);if(I===null)throw new SyntaxError(`Expected ${x.toString()}`);return e=x.lastIndex,I}function o(x){return a(x)[1]}function l(x){let I=h(),M=c();if(I===null&&Object.keys(M).length===0)throw new SyntaxError("Expected message value or attributes");return{id:x,value:I,attributes:M}}function c(){let x=Object.create(null);for(;s(Rl);){let I=o(Rl),M=h();if(M===null)throw new SyntaxError("Expected attribute value");x[I]=M}return x}function h(){let x;if(s(gi)&&(x=o(gi)),t[e]==="{"||t[e]==="}")return u(x?[x]:[],1/0);let I=S();return I?x?u([x,I],I.length):(I.value=T(I.value,ov),u([I],I.length)):x?T(x,Nl):null}function u(x=[],I){for(;;){if(s(gi)){x.push(o(gi));continue}if(t[e]==="{"){x.push(d());continue}if(t[e]==="}")throw new SyntaxError("Unbalanced closing brace");let W=S();if(W){x.push(W),I=Math.min(I,W.length);continue}break}let M=x.length-1,H=x[M];typeof H=="string"&&(x[M]=T(H,Nl));let B=[];for(let W of x)W instanceof _l&&(W=W.value.slice(0,W.value.length-I)),W&&B.push(W);return B}function d(){r(hv,SyntaxError);let x=f();if(r(Dl))return x;if(r(pv)){let I=m();return r(Dl,SyntaxError),{type:"select",selector:x,...I}}throw new SyntaxError("Unclosed placeable")}function f(){if(t[e]==="{")return d();if(s(Ml)){let[,x,I,M=null]=a(Ml);if(x==="$")return{type:"var",name:I};if(r(fv)){let H=p();if(x==="-")return{type:"term",name:I,attr:M,args:H};if(rv.test(I))return{type:"func",name:I,args:H};throw new SyntaxError("Function names must be all upper-case")}return x==="-"?{type:"term",name:I,attr:M,args:[]}:{type:"mesg",name:I,attr:M}}return y()}function p(){let x=[];for(;;){switch(t[e]){case")":return e++,x;case void 0:throw new SyntaxError("Unclosed argument list")}x.push(g()),r(mv)}}function g(){let x=f();return x.type!=="mesg"?x:r(gv)?{type:"narg",name:x.name,value:y()}:x}function m(){let x=[],I=0,M;for(;s(nv);){n("*")&&(M=I);let H=v(),B=h();if(B===null)throw new SyntaxError("Expected variant value");x[I++]={key:H,value:B}}if(I===0)return null;if(M===void 0)throw new SyntaxError("Expected default variant");return{variants:x,star:M}}function v(){r(uv,SyntaxError);let x;return s(Vr)?x=w():x={type:"str",value:o(iv)},r(dv,SyntaxError),x}function y(){if(s(Vr))return w();if(t[e]==='"')return b();throw new SyntaxError("Invalid expression")}function w(){let[,x,I=""]=a(Vr),M=I.length;return{type:"num",value:parseFloat(x),precision:M}}function b(){n('"',SyntaxError);let x="";for(;;){if(x+=o(av),t[e]==="\\"){x+=A();continue}if(n('"'))return{type:"str",value:x};throw new SyntaxError("Unclosed string literal")}}function A(){if(s(Ll))return o(Ll);if(s(Ol)){let[,x,I]=a(Ol),M=parseInt(x||I,16);return M<=55295||57344<=M?String.fromCodePoint(M):""}throw new SyntaxError("Unknown escape sequence")}function S(){let x=e;switch(r(vv),t[e]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return R(t.slice(x,e))}return t[e-1]===" "?R(t.slice(x,e)):!1}function T(x,I){return x.replace(I,"")}function R(x){let I=x.replace(lv,`
`),M=cv.exec(x)[1].length;return new _l(I,M)}}}class _l{constructor(t,e){this.value=t,this.length=e}}const bv=/<|&#?\w+;/,Av={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},wv={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function xv(i,t){const{value:e}=t;if(typeof e=="string")if(i.localName==="title"&&i.namespaceURI==="http://www.w3.org/1999/xhtml")i.textContent=e;else if(!bv.test(e))i.textContent=e;else{const s=i.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");s.innerHTML=e,Ev(s.content,i)}$h(t,i)}function Ev(i,t){for(const e of i.childNodes)if(e.nodeType!==e.TEXT_NODE){if(e.hasAttribute("data-l10n-name")){const s=Tv(t,e);i.replaceChild(s,e);continue}if(Cv(e)){const s=Pv(e);i.replaceChild(s,e);continue}console.warn(`An element of forbidden type "${e.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),i.replaceChild(ga(e),e)}t.textContent="",t.appendChild(i)}function Sv(i,t){if(!i)return!1;for(let e of i)if(e.name===t)return!0;return!1}function $h(i,t){const e=t.hasAttribute("data-l10n-attrs")?t.getAttribute("data-l10n-attrs").split(",").map(s=>s.trim()):null;for(const s of Array.from(t.attributes))Fl(s.name,t,e)&&!Sv(i.attributes,s.name)&&t.removeAttribute(s.name);if(i.attributes)for(const s of Array.from(i.attributes))Fl(s.name,t,e)&&t.getAttribute(s.name)!==s.value&&t.setAttribute(s.name,s.value)}function Tv(i,t){const e=t.getAttribute("data-l10n-name"),s=i.querySelector(`[data-l10n-name="${e}"]`);if(!s)return console.warn(`An element named "${e}" wasn't found in the source.`),ga(t);if(s.localName!==t.localName)return console.warn(`An element named "${e}" was found in the translation but its type ${t.localName} didn't match the element found in the source (${s.localName}).`),ga(t);i.removeChild(s);const n=s.cloneNode(!1);return Bh(t,n)}function Pv(i){const t=i.ownerDocument.createElement(i.localName);return Bh(i,t)}function ga(i){return i.ownerDocument.createTextNode(i.textContent)}function Cv(i){const t=Av[i.namespaceURI];return t&&t.includes(i.localName)}function Fl(i,t,e=null){if(e&&e.includes(i))return!0;const s=wv[t.namespaceURI];if(!s)return!1;const n=i.toLowerCase(),r=t.localName;if(s.global.includes(n))return!0;if(!s[r])return!1;if(s[r].includes(n))return!0;if(t.namespaceURI==="http://www.w3.org/1999/xhtml"&&r==="input"&&n==="value"){const a=t.type.toLowerCase();if(a==="submit"||a==="button"||a==="reset")return!0}return!1}function Bh(i,t){return t.textContent=i.textContent,$h(i,t),t}Mt(3949);class Iv extends Array{static from(t){return t instanceof this?t:new this(t)}}class Rv extends Iv{constructor(t){if(super(),Symbol.asyncIterator in Object(t))this.iterator=t[Symbol.asyncIterator]();else if(Symbol.iterator in Object(t))this.iterator=t[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){const t=this;let e=0;return{async next(){return t.length<=e&&t.push(t.iterator.next()),t[e++]}}}async touchNext(t=1){let e=0;for(;e++<t;){const s=this[this.length-1];if(s&&(await s).done)break;this.push(this.iterator.next())}return this[this.length-1]}}class Mv{constructor(t=[],e){this.resourceIds=t,this.generateBundles=e,this.onChange(!0)}addResourceIds(t,e=!1){return this.resourceIds.push(...t),this.onChange(e),this.resourceIds.length}removeResourceIds(t){return this.resourceIds=this.resourceIds.filter(e=>!t.includes(e)),this.onChange(),this.resourceIds.length}async formatWithFallback(t,e){const s=[];let n=!1;for await(const r of this.bundles){n=!0;const a=Nv(e,r,t,s);if(a.size===0)break;if(typeof console<"u"){const o=r.locales[0],l=Array.from(a).join(", ");console.warn(`[fluent] Missing translations in ${o}: ${l}`)}}return!n&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(t)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),s}formatMessages(t){return this.formatWithFallback(t,Ov)}formatValues(t){return this.formatWithFallback(t,Lv)}async formatValue(t,e){const[s]=await this.formatValues([{id:t,args:e}]);return s}handleEvent(){this.onChange()}onChange(t=!1){this.bundles=Rv.from(this.generateBundles(this.resourceIds)),t&&this.bundles.touchNext(2)}}function Lv(i,t,e,s){return e.value?i.formatPattern(e.value,s,t):null}function Ov(i,t,e,s){const n={value:null,attributes:null};e.value&&(n.value=i.formatPattern(e.value,s,t));let r=Object.keys(e.attributes);if(r.length>0){n.attributes=new Array(r.length);for(let[a,o]of r.entries()){let l=i.formatPattern(e.attributes[o],s,t);n.attributes[a]={name:o,value:l}}}return n}function Nv(i,t,e,s){const n=[],r=new Set;return e.forEach(({id:a,args:o},l)=>{if(s[l]!==void 0)return;let c=t.getMessage(a);if(c){if(n.length=0,s[l]=i(t,n,c,o),n.length>0&&typeof console<"u"){const h=t.locales[0],u=n.join(", ");console.warn(`[fluent][resolver] errors in ${h}/${a}: ${u}.`)}}else r.add(a)}),r}const Fs="data-l10n-id",xn="data-l10n-args",Dv=`[${Fs}]`;class _v extends Mv{constructor(t,e){super(t,e),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[Fs,xn]}}onChange(t=!1){super.onChange(t),this.roots&&this.translateRoots()}setAttributes(t,e,s){return t.setAttribute(Fs,e),s?t.setAttribute(xn,JSON.stringify(s)):t.removeAttribute(xn),t}getAttributes(t){return{id:t.getAttribute(Fs),args:JSON.parse(t.getAttribute(xn)||null)}}connectRoot(t){for(const e of this.roots)if(e===t||e.contains(t)||t.contains(e))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==t.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=t.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(e=>this.translateMutations(e));this.roots.add(t),this.mutationObserver.observe(t,this.observerConfig)}disconnectRoot(t){return this.roots.delete(t),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){const t=Array.from(this.roots);return Promise.all(t.map(e=>this.translateFragment(e)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(const t of this.roots)this.mutationObserver.observe(t,this.observerConfig)}translateMutations(t){for(const e of t)switch(e.type){case"attributes":e.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(e.target);break;case"childList":for(const s of e.addedNodes)if(s.nodeType===s.ELEMENT_NODE)if(s.childElementCount)for(const n of this.getTranslatables(s))this.pendingElements.add(n);else s.hasAttribute(Fs)&&this.pendingElements.add(s);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(t){return this.translateElements(this.getTranslatables(t))}async translateElements(t){if(!t.length)return;const e=t.map(this.getKeysForElement),s=await this.formatMessages(e);return this.applyTranslations(t,s)}applyTranslations(t,e){this.pauseObserving();for(let s=0;s<t.length;s++)e[s]!==void 0&&xv(t[s],e[s]);this.resumeObserving()}getTranslatables(t){const e=Array.from(t.querySelectorAll(Dv));return typeof t.hasAttribute=="function"&&t.hasAttribute(Fs)&&e.push(t),e}getKeysForElement(t){return{id:t.getAttribute(Fs),args:JSON.parse(t.getAttribute(xn)||null)}}}class $i{#t;#e;#s;#n;constructor({lang:t,isRTL:e},s=null){this.#s=$i.#r(t),this.#n=s,this.#t=e??$i.#i(this.#s)?"rtl":"ltr"}_setL10n(t){this.#n=t}getLanguage(){return this.#s}getDirection(){return this.#t}async get(t,e=null,s){return Array.isArray(t)?(t=t.map(a=>({id:a})),(await this.#n.formatMessages(t)).map(a=>a.value)):(await this.#n.formatMessages([{id:t,args:e}]))[0]?.value||s}async translate(t){(this.#e||=new Set).add(t);try{this.#n.connectRoot(t),await this.#n.translateRoots()}catch{}}async translateOnce(t){try{await this.#n.translateElements([t])}catch(e){console.error("translateOnce:",e)}}async destroy(){if(this.#e){for(const t of this.#e)this.#n.disconnectRoot(t);this.#e.clear(),this.#e=null}this.#n.pauseObserving()}pause(){this.#n.pauseObserving()}resume(){this.#n.resumeObserving()}static#r(t){return t=t?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[t]||t}static#i(t){const e=t.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(e)}}function kl(i,t){const e=new yv(t),s=new sv(i),n=s.addResource(e);return n.length&&console.error("L10n errors",n),s}class us extends $i{constructor(t){super({lang:t});const e=t?us.#t.bind(us,"en-us",this.getLanguage()):us.#n.bind(us,this.getLanguage());this._setL10n(new _v([],e))}static async*#t(t,e){const{baseURL:s,paths:n}=await this.#s(),r=[e];if(t!==e){const a=e.split("-",1)[0];a!==e&&r.push(a),r.push(t)}for(const a of r){const o=await this.#e(a,s,n);o?yield o:a==="en-us"&&(yield this.#r(a))}}static async#e(t,e,s){const n=s[t];if(!n)return null;const r=new URL(n,e),a=await Al(r,"text");return kl(t,a)}static async#s(){try{const{href:t}=document.querySelector('link[type="application/l10n"]'),e=await Al(t,"json");return{baseURL:t.replace(/[^/]*$/,"")||"./",paths:e}}catch{}return{baseURL:"./",paths:Object.create(null)}}static async*#n(t){yield this.#r(t)}static async#r(t){return kl(t,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Properties
pdfjs-document-properties-button-label = Document Properties
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width }  { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width }  { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printing
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in document
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-free-text2 =
    .aria-label = Text Editor
    .default-content = Start typing
pdfjs-ink =
    .aria-label = Draw Editor
pdfjs-ink-canvas =
    .aria-label = User-created image
pdfjs-editor-alt-text-button =
    .aria-label = Alt text
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button =
    .aria-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people cant see the image or when it doesnt load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, A young man sits down at a table to eat a meal
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner  resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle  resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner  resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right  resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner  resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle  resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner  resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left  resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description here
pdfjs-editor-new-alt-text-description = Short description for people who cant see the image or when the image doesnt load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldnt create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button =
    .aria-label = Alt text added
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button =
    .aria-label = Missing alt text
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button =
    .aria-label = Review alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who cant see the image or when the image doesnt load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloading
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close
pdfjs-editor-undo-bar-message-highlight = Highlight removed
pdfjs-editor-undo-bar-message-freetext = Text removed
pdfjs-editor-undo-bar-message-ink = Drawing removed
pdfjs-editor-undo-bar-message-stamp = Image removed
pdfjs-editor-undo-bar-message-multiple =
    { $count ->
        [one] { $count } annotation removed
       *[other] { $count } annotations removed
    }
pdfjs-editor-undo-bar-undo-button =
    .title = Undo
pdfjs-editor-undo-bar-undo-button-label = Undo
pdfjs-editor-undo-bar-close-button =
    .title = Close
pdfjs-editor-undo-bar-close-button-label = Close`)}}const Fv=1e3,kv=50,jv=1e3;function Ur(){return document.location.hash}class $v{#t=null;constructor({linkService:t,eventBus:e}){this.linkService=t,this.eventBus=e,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",s=>{this._isPagesLoaded=!!s.pagesCount},{once:!0})})}initialize({fingerprint:t,resetHistory:e=!1,updateUrl:s=!1}){if(!t||typeof t!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const n=this._fingerprint!==""&&this._fingerprint!==t;this._fingerprint=t,this._updateUrl=s===!0,this._initialized=!0,this.#d();const r=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=Ur(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#r(r,!0)||e){const{hash:o,page:l,rotation:c}=this.#a(!0);if(!o||n||e){this.#e(null,!0);return}this.#e({hash:o,page:l,rotation:c},!0);return}const a=r.destination;this.#i(a,r.uid,!0),a.rotation!==void 0&&(this._initialRotation=a.rotation),a.dest?(this._initialBookmark=JSON.stringify(a.dest),this._destination.page=null):a.hash?this._initialBookmark=a.hash:a.page&&(this._initialBookmark=`page=${a.page}`)}reset(){this._initialized&&(this.#c(),this._initialized=!1,this.#u()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:e,pageNumber:s}){if(!this._initialized)return;if(t&&typeof t!="string"){console.error(`PDFHistory.push: "${t}" is not a valid namedDest parameter.`);return}else if(Array.isArray(e)){if(!this.#n(s)&&(s!==null||this._destination)){console.error(`PDFHistory.push: "${s}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${e}" is not a valid explicitDest parameter.`);return}const n=t||JSON.stringify(e);if(!n)return;let r=!1;if(this._destination&&(Bv(this._destination.hash,n)||Hv(this._destination.dest,e))){if(this._destination.page)return;r=!0}this._popStateInProgress&&!r||(this.#e({dest:e,hash:n,page:s,rotation:this.linkService.rotation},r),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(t){if(this._initialized){if(!this.#n(t)){console.error(`PDFHistory.pushPage: "${t}" is not a valid page number.`);return}this._destination?.page!==t&&(this._popStateInProgress||(this.#e({dest:null,hash:`page=${t}`,page:t,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#s()}back(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this.#r(t)&&t.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this.#r(t)&&t.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#e(t,e=!1){const s=e||!this._destination,n={fingerprint:this._fingerprint,uid:s?this._uid:this._uid+1,destination:t};this.#i(t,n.uid);let r;if(this._updateUrl&&t?.hash){const a=document.location.href.split("#",1)[0];a.startsWith("file://")||(r=`${a}#${t.hash}`)}s?window.history.replaceState(n,"",r):window.history.pushState(n,"",r)}#s(t=!1){if(!this._position)return;let e=this._position;if(t&&(e=Object.assign(Object.create(null),this._position),e.temporary=!0),!this._destination){this.#e(e);return}if(this._destination.temporary){this.#e(e,!0);return}if(this._destination.hash===e.hash||!this._destination.page&&this._numPositionUpdates<=kv)return;let s=!1;if(this._destination.page>=e.first&&this._destination.page<=e.page){if(this._destination.dest!==void 0||!this._destination.first)return;s=!0}this.#e(e,s)}#n(t){return Number.isInteger(t)&&t>0&&t<=this.linkService.pagesCount}#r(t,e=!1){if(!t)return!1;if(t.fingerprint!==this._fingerprint)if(e){if(typeof t.fingerprint!="string"||t.fingerprint.length!==this._fingerprint.length)return!1;const[s]=performance.getEntriesByType("navigation");if(s?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(t.uid)||t.uid<0||t.destination===null||typeof t.destination!="object")}#i(t,e,s=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),s&&t?.temporary&&delete t.temporary,this._destination=t,this._uid=e,this._maxUid=Math.max(this._maxUid,e),this._numPositionUpdates=0}#a(t=!1){const e=unescape(Ur()).substring(1),s=fr(e),n=s.get("nameddest")||"";let r=s.get("page")|0;return(!this.#n(r)||t&&n.length>0)&&(r=null),{hash:e,page:r,rotation:this.linkService.rotation}}#l({location:t}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:t.pdfOpenParams.substring(1),page:this.linkService.page,first:t.pageNumber,rotation:t.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#s(!0),this._updateViewareaTimeout=null},jv))}#h({state:t}){const e=Ur(),s=this._currentHash!==e;if(this._currentHash=e,!t){this._uid++;const{hash:r,page:a,rotation:o}=this.#a();this.#e({hash:r,page:a,rotation:o},!0);return}if(!this.#r(t))return;this._popStateInProgress=!0,s&&(this._blockHashChange++,Um({target:window,name:"hashchange",delay:Fv}).then(()=>{this._blockHashChange--}));const n=t.destination;this.#i(n,t.uid,!0),_h(n.rotation)&&(this.linkService.rotation=n.rotation),n.dest?this.linkService.goToDestination(n.dest):n.hash?this.linkService.setHash(n.hash):n.page&&(this.linkService.page=n.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#c(){(!this._destination||this._destination.temporary)&&this.#s()}#d(){if(this.#t)return;this.#t=new AbortController;const{signal:t}=this.#t;this.eventBus._on("updateviewarea",this.#l.bind(this),{signal:t}),window.addEventListener("popstate",this.#h.bind(this),{signal:t}),window.addEventListener("pagehide",this.#c.bind(this),{signal:t})}#u(){this.#t?.abort(),this.#t=null}}function Bv(i,t){return typeof i!="string"||typeof t!="string"?!1:i===t||fr(i).get("nameddest")===t}function Hv(i,t){function e(s,n){if(typeof s!=typeof n||Array.isArray(s)||Array.isArray(n))return!1;if(s!==null&&typeof s=="object"&&n!==null){if(Object.keys(s).length!==Object.keys(n).length)return!1;for(const r in s)if(!e(s[r],n[r]))return!1;return!0}return s===n||Number.isNaN(s)&&Number.isNaN(n)}if(!(Array.isArray(i)&&Array.isArray(t))||i.length!==t.length)return!1;for(let s=0,n=i.length;s<n;s++)if(!e(i[s],t[s]))return!1;return!0}class Vv{#t=null;#e=null;#s=null;#n=null;#r=null;#i;constructor(t){this.pdfPage=t.pdfPage,this.accessibilityManager=t.accessibilityManager,this.l10n=t.l10n,this.l10n||=new us,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#i=t.uiManager,this.#t=t.annotationLayer||null,this.#r=t.textLayer||null,this.#e=t.drawLayer||null,this.#s=t.onAppend||null,this.#n=t.structTreeLayer||null}async render(t,e="display"){if(e!=="display"||this._cancelled)return;const s=t.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:s}),this.show();return}const n=this.div=document.createElement("div");n.className="annotationEditorLayer",n.hidden=!0,n.dir=this.#i.direction,this.#s?.(n),this.annotationEditorLayer=new Lm({uiManager:this.#i,div:n,structTreeLayer:this.#n,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:s,annotationLayer:this.#t,textLayer:this.#r,drawLayer:this.#e});const r={viewport:s,div:n,annotations:null,intent:e};this.annotationEditorLayer.render(r),this.show()}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.annotationEditorLayer.pause(!0),this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1,this.annotationEditorLayer.pause(!1))}}{var ma=new Map;const i=navigator.userAgent||"",t=navigator.platform||"",e=navigator.maxTouchPoints||1,s=/Android/.test(i),n=/\b(iPad|iPhone|iPod)(?=;)/.test(i)||t==="MacIntel"&&e>1;(function(){(n||s)&&ma.set("maxCanvasPixels",5242880)})(),(function(){s&&ma.set("useSystemFonts",!1)})()}const j={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},va={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},es={allowedGlobalEvents:{value:null,kind:j.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:j.BROWSER+j.API},isInAutomation:{value:!1,kind:j.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:j.BROWSER},nimbusDataStr:{value:"",kind:j.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:j.BROWSER},supportsDocumentFonts:{value:!0,kind:j.BROWSER},supportsIntegratedFind:{value:!1,kind:j.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:j.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:j.BROWSER},supportsPinchToZoom:{value:!0,kind:j.BROWSER},toolbarDensity:{value:0,kind:j.BROWSER+j.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:j.VIEWER+j.PREFERENCE},annotationEditorMode:{value:0,kind:j.VIEWER+j.PREFERENCE},annotationMode:{value:2,kind:j.VIEWER+j.PREFERENCE},cursorToolOnLoad:{value:0,kind:j.VIEWER+j.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:j.VIEWER},defaultZoomDelay:{value:400,kind:j.VIEWER+j.PREFERENCE},defaultZoomValue:{value:"",kind:j.VIEWER+j.PREFERENCE},disableHistory:{value:!1,kind:j.VIEWER},disablePageLabels:{value:!1,kind:j.VIEWER+j.PREFERENCE},enableAltText:{value:!1,kind:j.VIEWER+j.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:j.VIEWER+j.PREFERENCE+j.EVENT_DISPATCH},enableGuessAltText:{value:!0,kind:j.VIEWER+j.PREFERENCE+j.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:j.VIEWER+j.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:j.VIEWER+j.PREFERENCE},enablePermissions:{value:!1,kind:j.VIEWER+j.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:j.VIEWER+j.PREFERENCE},enableScripting:{value:!0,kind:j.VIEWER+j.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:j.VIEWER+j.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:j.VIEWER},externalLinkTarget:{value:0,kind:j.VIEWER+j.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:j.VIEWER+j.PREFERENCE},historyUpdateUrl:{value:!1,kind:j.VIEWER+j.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:j.VIEWER+j.PREFERENCE},imageResourcesPath:{value:"./images/",kind:j.VIEWER},maxCanvasPixels:{value:2**25,kind:j.VIEWER},forcePageColors:{value:!1,kind:j.VIEWER+j.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:j.VIEWER+j.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:j.VIEWER+j.PREFERENCE},pdfBugEnabled:{value:!1,kind:j.VIEWER+j.PREFERENCE},printResolution:{value:150,kind:j.VIEWER},sidebarViewOnLoad:{value:-1,kind:j.VIEWER+j.PREFERENCE},scrollModeOnLoad:{value:-1,kind:j.VIEWER+j.PREFERENCE},spreadModeOnLoad:{value:-1,kind:j.VIEWER+j.PREFERENCE},textLayerMode:{value:1,kind:j.VIEWER+j.PREFERENCE},viewOnLoad:{value:0,kind:j.VIEWER+j.PREFERENCE},cMapPacked:{value:!0,kind:j.API},cMapUrl:{value:"../web/cmaps/",kind:j.API},disableAutoFetch:{value:!1,kind:j.API+j.PREFERENCE},disableFontFace:{value:!1,kind:j.API+j.PREFERENCE},disableRange:{value:!1,kind:j.API+j.PREFERENCE},disableStream:{value:!1,kind:j.API+j.PREFERENCE},docBaseUrl:{value:"",kind:j.API},enableHWA:{value:!0,kind:j.API+j.VIEWER+j.PREFERENCE},enableXfa:{value:!0,kind:j.API+j.PREFERENCE},fontExtraProperties:{value:!1,kind:j.API},isEvalSupported:{value:!0,kind:j.API},isOffscreenCanvasSupported:{value:!0,kind:j.API},maxImageSize:{value:-1,kind:j.API},pdfBug:{value:!1,kind:j.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:j.API},useSystemFonts:{value:void 0,kind:j.API,type:va.BOOLEAN+va.UNDEFINED},verbosity:{value:1,kind:j.API},workerPort:{value:null,kind:j.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:j.WORKER}};es.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:j.VIEWER},es.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:j.VIEWER},es.viewerCssTheme={value:0,kind:j.VIEWER+j.PREFERENCE},es.enableFakeMLManager={value:!0,kind:j.VIEWER};es.disablePreferences={value:!1,kind:j.VIEWER};var Ts;const Ze=class Ze{static get(t){return ie(this,Ts).get(t)}static getAll(t=null,e=!1){const s=Object.create(null);for(const n in es){const r=es[n];t&&!(t&r.kind)||(s[n]=e?r.value:ie(this,Ts).get(n))}return s}static set(t,e){this.setAll({[t]:e})}static setAll(t,e=!1){this._hasInvokedSet||=!0;let s;for(const n in t){const r=es[n],a=t[n];if(!r||!(typeof a==typeof r.value||va[(typeof a).toUpperCase()]&r.type))continue;const{kind:o}=r;e&&!(o&j.BROWSER||o&j.PREFERENCE)||(this.eventBus&&o&j.EVENT_DISPATCH&&(s||=new Map).set(n,a),ie(this,Ts).set(n,a))}if(s)for(const[n,r]of s)this.eventBus.dispatch(n.toLowerCase(),{source:this,value:r})}};Ts=new WeakMap,lo(Ze,"eventBus"),Ls(Ze,Ts,new Map),(()=>{for(const t in es)ie(Ze,Ts).set(t,es[t].value);for(const[t,e]of ma)ie(Ze,Ts).set(t,e);Ze._hasInvokedSet=!1,Ze._checkDisablePreferences=()=>Ze.get("disablePreferences")?!0:(Ze._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)})();let ya=Ze;class Uv{#t=null;constructor(t){this.pageIndex=t.pageIndex}async render(t="display"){t!=="display"||this.#t||this._cancelled||(this.#t=new _m({pageIndex:this.pageIndex}))}cancel(){this._cancelled=!0,this.#t&&(this.#t.destroy(),this.#t=null)}setParent(t){this.#t?.setParent(t)}getDrawLayer(){return this.#t}}const jl={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},zv=/^H(\d+)$/;class Hh{#t;#e=null;#s;#n=new Map;#r;#i=null;constructor(t,e){this.#t=t.getStructTree(),this.#r=e}async render(){if(this.#s)return this.#s;const{promise:t,resolve:e,reject:s}=Promise.withResolvers();this.#s=t;try{this.#e=this.#h(await this.#t)}catch(n){s(n)}return this.#t=null,this.#e?.classList.add("structTree"),e(this.#e),t}async getAriaAttributes(t){try{return await this.render(),this.#n.get(t)}catch{}return null}hide(){this.#e&&!this.#e.hidden&&(this.#e.hidden=!0)}show(){this.#e?.hidden&&(this.#e.hidden=!1)}#a(t,e){const{alt:s,id:n,lang:r}=t;if(s!==void 0){let a=!1;const o=kn(s);for(const l of t.children)if(l.type==="annotation"){let c=this.#n.get(l.id);c||(c=new Map,this.#n.set(l.id,c)),c.set("aria-label",o),a=!0}a||e.setAttribute("aria-label",o)}n!==void 0&&e.setAttribute("aria-owns",n),r!==void 0&&e.setAttribute("lang",kn(r,!0))}#l(t,e){const{alt:s,bbox:n,children:r}=t,a=r?.[0];if(!this.#r||!s||!n||a?.type!=="content")return!1;const{id:o}=a;if(!o)return!1;e.setAttribute("aria-owns",o);const l=document.createElement("span");(this.#i||=new Map).set(o,l),l.setAttribute("role","img"),l.setAttribute("aria-label",kn(s));const{pageHeight:c,pageX:h,pageY:u}=this.#r,d="calc(var(--scale-factor)*",{style:f}=l;return f.width=`${d}${n[2]-n[0]}px)`,f.height=`${d}${n[3]-n[1]}px)`,f.left=`${d}${n[0]-h}px)`,f.top=`${d}${c-n[3]+u}px)`,!0}addElementsToTextLayer(){if(this.#i){for(const[t,e]of this.#i)document.getElementById(t)?.append(e);this.#i.clear(),this.#i=null}}#h(t){if(!t)return null;const e=document.createElement("span");if("role"in t){const{role:s}=t,n=s.match(zv);if(n?(e.setAttribute("role","heading"),e.setAttribute("aria-level",n[1])):jl[s]&&e.setAttribute("role",jl[s]),s==="Figure"&&this.#l(t,e))return e}if(this.#a(t,e),t.children)if(t.children.length===1&&"id"in t.children[0])this.#a(t.children[0],e);else for(const s of t.children)e.append(this.#h(s));return e}}class $n{#t=!1;#e=null;#s=new Map;#n=new Map;setTextMapping(t){this.#e=t}static#r(t,e){const s=t.getBoundingClientRect(),n=e.getBoundingClientRect();if(s.width===0&&s.height===0)return 1;if(n.width===0&&n.height===0)return-1;const r=s.y,a=s.y+s.height,o=s.y+s.height/2,l=n.y,c=n.y+n.height,h=n.y+n.height/2;if(o<=l&&h>=a)return-1;if(h<=r&&o>=c)return 1;const u=s.x+s.width/2,d=n.x+n.width/2;return u-d}enable(){if(this.#t)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#e)throw new Error("Text divs and strings have not been set.");if(this.#t=!0,this.#e=this.#e.slice(),this.#e.sort($n.#r),this.#s.size>0){const t=this.#e;for(const[e,s]of this.#s){if(!document.getElementById(e)){this.#s.delete(e);continue}this.#i(e,t[s])}}for(const[t,e]of this.#n)this.addPointerInTextLayer(t,e);this.#n.clear()}disable(){this.#t&&(this.#n.clear(),this.#e=null,this.#t=!1)}removePointerInTextLayer(t){if(!this.#t){this.#n.delete(t);return}const e=this.#e;if(!e||e.length===0)return;const{id:s}=t,n=this.#s.get(s);if(n===void 0)return;const r=e[n];this.#s.delete(s);let a=r.getAttribute("aria-owns");a?.includes(s)&&(a=a.split(" ").filter(o=>o!==s).join(" "),a?r.setAttribute("aria-owns",a):(r.removeAttribute("aria-owns"),r.setAttribute("role","presentation")))}#i(t,e){const s=e.getAttribute("aria-owns");s?.includes(t)||e.setAttribute("aria-owns",s?`${s} ${t}`:t),e.removeAttribute("role")}addPointerInTextLayer(t,e){const{id:s}=t;if(!s)return null;if(!this.#t)return this.#n.set(t,e),null;e&&this.removePointerInTextLayer(t);const n=this.#e;if(!n||n.length===0)return null;const r=Jn(n,c=>$n.#r(t,c)<0),a=Math.max(0,r-1),o=n[a];this.#i(s,o),this.#s.set(s,a);const l=o.parentNode;return l?.classList.contains("markedContent")?l.id:null}moveElementInDOM(t,e,s,n){const r=this.addPointerInTextLayer(s,n);if(!t.hasChildNodes())return t.append(e),r;const a=Array.from(t.childNodes).filter(c=>c!==e);if(a.length===0)return r;const o=s||e,l=Jn(a,c=>$n.#r(o,c)<0);return l===0?a[0].before(e):a[l-1].after(e),r}}class Wv{#t=null;constructor({findController:t,eventBus:e,pageIndex:s}){this.findController=t,this.matches=[],this.eventBus=e,this.pageIdx=s,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(t,e){this.textDivs=t,this.textContentItemsStr=e}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#t||(this.#t=new AbortController,this.eventBus._on("updatetextlayermatches",t=>{(t.pageIndex===this.pageIdx||t.pageIndex===-1)&&this._updateMatches()},{signal:this.#t.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#t?.abort(),this.#t=null,this._updateMatches(!0))}_convertMatches(t,e){if(!t)return[];const{textContentItemsStr:s}=this;let n=0,r=0;const a=s.length-1,o=[];for(let l=0,c=t.length;l<c;l++){let h=t[l];for(;n!==a&&h>=r+s[n].length;)r+=s[n].length,n++;n===s.length&&console.error("Could not find a matching mapping");const u={begin:{divIdx:n,offset:h-r}};for(h+=e[l];n!==a&&h>r+s[n].length;)r+=s[n].length,n++;u.end={divIdx:n,offset:h-r},o.push(u)}return o}_renderMatches(t){if(t.length===0)return;const{findController:e,pageIdx:s}=this,{textContentItemsStr:n,textDivs:r}=this,a=s===e.selected.pageIdx,o=e.selected.matchIdx,l=e.state.highlightAll;let c=null;const h={offset:void 0};function u(v,y){const w=v.divIdx;return r[w].textContent="",d(w,0,v.offset,y)}function d(v,y,w,b){let A=r[v];if(A.nodeType===Node.TEXT_NODE){const R=document.createElement("span");A.before(R),R.append(A),r[v]=R,A=R}const S=n[v].substring(y,w),T=document.createTextNode(S);if(b){const R=document.createElement("span");if(R.className=`${b} appended`,R.append(T),A.append(R),b.includes("selected")){const{left:x}=R.getClientRects()[0],I=A.getBoundingClientRect().left;return x-I}return 0}return A.append(T),0}let f=o,p=f+1;if(l)f=0,p=t.length;else if(!a)return;let g=-1,m=-1;for(let v=f;v<p;v++){const y=t[v],w=y.begin;if(w.divIdx===g&&w.offset===m)continue;g=w.divIdx,m=w.offset;const b=y.end,A=a&&v===o,S=A?" selected":"";let T=0;if(!c||w.divIdx!==c.divIdx?(c!==null&&d(c.divIdx,c.offset,h.offset),u(w)):d(c.divIdx,c.offset,w.offset),w.divIdx===b.divIdx)T=d(w.divIdx,w.offset,b.offset,"highlight"+S);else{T=d(w.divIdx,w.offset,h.offset,"highlight begin"+S);for(let R=w.divIdx+1,x=b.divIdx;R<x;R++)r[R].className="highlight middle"+S;u(b,"highlight end"+S)}c=b,A&&e.scrollMatchIntoView({element:r[w.divIdx],selectedLeft:T,pageIndex:s,matchIndex:o})}c&&d(c.divIdx,c.offset,h.offset)}_updateMatches(t=!1){if(!this.enabled&&!t)return;const{findController:e,matches:s,pageIdx:n}=this,{textContentItemsStr:r,textDivs:a}=this;let o=-1;for(const h of s){const u=Math.max(o,h.begin.divIdx);for(let d=u,f=h.end.divIdx;d<=f;d++){const p=a[d];p.textContent=r[d],p.className=""}o=h.end.divIdx+1}if(!e?.highlightMatches||t)return;const l=e.pageMatches[n]||null,c=e.pageMatchesLength[n]||null;this.matches=this._convertMatches(l,c),this._renderMatches(this.matches)}}class rn{#t=!1;#e=null;#s=!1;#n=null;static#r=new Map;static#i=null;constructor({pdfPage:t,highlighter:e=null,accessibilityManager:s=null,enablePermissions:n=!1,onAppend:r=null}){this.pdfPage=t,this.highlighter=e,this.accessibilityManager=s,this.#t=n===!0,this.#e=r,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}async render(t,e=null){if(this.#s&&this.#n){this.#n.update({viewport:t,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#n=new Hm({textContentSource:this.pdfPage.streamTextContent(e||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:t});const{textDivs:s,textContentItemsStr:n}=this.#n;this.highlighter?.setTextMapping(s,n),this.accessibilityManager?.setTextMapping(s),await this.#n.render(),this.#s=!0;const r=document.createElement("div");r.className="endOfContent",this.div.append(r),this.#a(r),this.#e?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()}hide(){!this.div.hidden&&this.#s&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#s&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#n?.cancel(),this.#n=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),rn.#l(this.div)}#a(t){const{div:e}=this;e.addEventListener("mousedown",()=>{e.classList.add("selecting")}),e.addEventListener("copy",s=>{if(!this.#t){const n=document.getSelection();s.clipboardData.setData("text/plain",kn(jm(n.toString())))}fa(s)}),rn.#r.set(e,t),rn.#h()}static#l(t){this.#r.delete(t),this.#r.size===0&&(this.#i?.abort(),this.#i=null)}static#h(){if(this.#i)return;this.#i=new AbortController;const{signal:t}=this.#i,e=(a,o)=>{o.append(a),a.style.width="",a.style.height="",o.classList.remove("selecting")};let s=!1;document.addEventListener("pointerdown",()=>{s=!0},{signal:t}),document.addEventListener("pointerup",()=>{s=!1,this.#r.forEach(e)},{signal:t}),window.addEventListener("blur",()=>{s=!1,this.#r.forEach(e)},{signal:t}),document.addEventListener("keyup",()=>{s||this.#r.forEach(e)},{signal:t});var n,r;document.addEventListener("selectionchange",()=>{const a=document.getSelection();if(a.rangeCount===0){this.#r.forEach(e);return}const o=new Set;for(let f=0;f<a.rangeCount;f++){const p=a.getRangeAt(f);for(const g of this.#r.keys())!o.has(g)&&p.intersectsNode(g)&&o.add(g)}for(const[f,p]of this.#r)o.has(f)?f.classList.add("selecting"):e(p,f);if(n??=getComputedStyle(this.#r.values().next().value).getPropertyValue("-moz-user-select")==="none",n)return;const l=a.getRangeAt(0),c=r&&(l.compareBoundaryPoints(Range.END_TO_END,r)===0||l.compareBoundaryPoints(Range.START_TO_END,r)===0);let h=c?l.startContainer:l.endContainer;h.nodeType===Node.TEXT_NODE&&(h=h.parentNode);const u=h.parentElement?.closest(".textLayer"),d=this.#r.get(u);d&&(d.style.width=u.style.width,d.style.height=u.style.height,h.parentElement.insertBefore(d,c?h:h.nextSibling)),r=l.cloneRange()},{signal:t})}}class Vh{constructor({pdfPage:t,annotationStorage:e=null,linkService:s,xfaHtml:n=null}){this.pdfPage=t,this.annotationStorage=e,this.linkService=s,this.xfaHtml=n,this.div=null,this._cancelled=!1}async render(t,e="display"){if(e==="print"){const r={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:e};return this.div=document.createElement("div"),r.div=this.div,Br.render(r)}const s=await this.pdfPage.getXfa();if(this._cancelled||!s)return{textDivs:[]};const n={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:s,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:e};return this.div?Br.update(n):(this.div=document.createElement("div"),n.div=this.div,Br.render(n))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}const Gv={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new to}},Xv=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]);class Uh{#t=hs.ENABLE_FORMS;#e=null;#s=!1;#n=!1;#r=!1;#i=null;#a=null;#l=null;#h=null;#c=1;#d=1;#u=null;#f=Vt.INITIAL;#o=ts.ENABLE;#p={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#m=[null,null,null,null];constructor(t){const e=t.container,s=t.defaultViewport;this.id=t.id,this.renderingId="page"+this.id,this.#i=t.layerProperties||Gv,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=t.scale||Nh,this.viewport=s,this.pdfPageRotate=s.rotation,this._optionalContentConfigPromise=t.optionalContentConfigPromise||null,this.#o=t.textLayerMode??ts.ENABLE,this.#t=t.annotationMode??hs.ENABLE_FORMS,this.imageResourcesPath=t.imageResourcesPath||"",this.maxCanvasPixels=t.maxCanvasPixels??ya.get("maxCanvasPixels"),this.pageColors=t.pageColors||null,this.#s=t.enableHWA||!1,this.eventBus=t.eventBus,this.renderingQueue=t.renderingQueue,this.l10n=t.l10n,this.l10n||=new us,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=e,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null;const n=document.createElement("div");if(n.className="page",n.setAttribute("data-page-number",this.id),n.setAttribute("role","region"),n.setAttribute("data-l10n-id","pdfjs-page-landmark"),n.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=n,this.#v(),e?.append(n),this._isStandalone){e?.style.setProperty("--scale-factor",this.scale*os.PDF_TO_CSS_UNITS),this.pageColors?.background&&e?.style.setProperty("--page-bg-color",this.pageColors.background);const{optionalContentConfigPromise:r}=t;r&&r.then(a=>{r===this._optionalContentConfigPromise&&(this.#p.initialOptionalContent=a.hasInitialVisibility)}),t.l10n||this.l10n.translate(this.div)}}#g(t,e){const s=Xv.get(e),n=this.#m[s];if(this.#m[s]=t,n){n.replaceWith(t);return}for(let r=s-1;r>=0;r--){const a=this.#m[r];if(a){a.after(t);return}}this.div.prepend(t)}get renderingState(){return this.#f}set renderingState(t){if(t!==this.#f)switch(this.#f=t,this.#a&&(clearTimeout(this.#a),this.#a=null),t){case Vt.PAUSED:this.div.classList.remove("loading");break;case Vt.RUNNING:this.div.classList.add("loadingIcon"),this.#a=setTimeout(()=>{this.div.classList.add("loading"),this.#a=null},0);break;case Vt.INITIAL:case Vt.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#v(){const{viewport:t}=this;if(this.pdfPage){if(this.#h===t.rotation)return;this.#h=t.rotation}Bm(this.div,t,!0,!1)}setPdfPage(t){this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=t,this.pdfPageRotate=t.rotate;const e=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:this.scale*os.PDF_TO_CSS_UNITS,rotation:e}),this.#v(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return ki(this,"_textHighlighter",new Wv({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#i.findController}))}#y(t,e){this.eventBus.dispatch(t,{source:this,pageNumber:this.id,error:e})}async#b(){let t=null;try{await this.annotationLayer.render(this.viewport,{structTreeLayer:this.structTreeLayer},"display")}catch(e){console.error("#renderAnnotationLayer:",e),t=e}finally{this.#y("annotationlayerrendered",t)}}async#A(){let t=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(e){console.error("#renderAnnotationEditorLayer:",e),t=e}finally{this.#y("annotationeditorlayerrendered",t)}}async#x(){try{await this.drawLayer.render("display")}catch(t){console.error("#renderDrawLayer:",t)}}async#S(){let t=null;try{const e=await this.xfaLayer.render(this.viewport,"display");e?.textDivs&&this._textHighlighter&&this.#E(e.textDivs)}catch(e){console.error("#renderXfaLayer:",e),t=e}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#g(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#y("xfalayerrendered",t)}}async#T(){if(!this.textLayer)return;let t=null;try{await this.textLayer.render(this.viewport)}catch(e){if(e instanceof Mm)return;console.error("#renderTextLayer:",e),t=e}this.#y("textlayerrendered",t),this.#R()}async#R(){if(!this.textLayer)return;const t=await this.structTreeLayer?.render();t&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&t.parentNode!==this.canvas&&this.canvas.append(t),this.l10n.resume()),this.structTreeLayer?.show()}async#E(t){const e=await this.pdfPage.getTextContent(),s=[];for(const n of e.items)s.push(n.str);this._textHighlighter.setTextMapping(t,s),this._textHighlighter.enable()}#I(){const{canvas:t}=this;t&&(t.remove(),t.width=t.height=0,this.canvas=null,this.#l=null)}reset({keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:e=!1,keepXfaLayer:s=!1,keepTextLayer:n=!1,keepCanvasWrapper:r=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:e,keepXfaLayer:s,keepTextLayer:n}),this.renderingState=Vt.INITIAL;const a=this.div,o=a.childNodes,l=t&&this.annotationLayer?.div||null,c=e&&this.annotationEditorLayer?.div||null,h=s&&this.xfaLayer?.div||null,u=n&&this.textLayer?.div||null,d=r&&this.#e||null;for(let f=o.length-1;f>=0;f--){const p=o[f];switch(p){case l:case c:case h:case u:case d:continue}p.remove();const g=this.#m.indexOf(p);g>=0&&(this.#m[g]=null)}a.removeAttribute("data-loaded"),l&&this.annotationLayer.hide(),c&&this.annotationEditorLayer.hide(),h&&this.xfaLayer.hide(),u&&this.textLayer.hide(),this.structTreeLayer?.hide(),!r&&this.#e&&(this.#e=null,this.#I())}toggleEditingMode(t){this.hasEditableAnnotations()&&(this.#r=t,this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0}))}update({scale:t=0,rotation:e=null,optionalContentConfigPromise:s=null,drawingDelay:n=-1}){this.scale=t||this.scale,typeof e=="number"&&(this.rotation=e),s instanceof Promise&&(this._optionalContentConfigPromise=s,s.then(a=>{s===this._optionalContentConfigPromise&&(this.#p.initialOptionalContent=a.hasInitialVisibility)})),this.#p.directDrawing=!0;const r=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*os.PDF_TO_CSS_UNITS,rotation:r}),this.#v(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let a=!1;if(this.#n){if(this.maxCanvasPixels===0)a=!0;else if(this.maxCanvasPixels>0){const{width:l,height:c}=this.viewport,{sx:h,sy:u}=this.outputScale;a=(Math.floor(l)*h|0)*(Math.floor(c)*u|0)>this.maxCanvasPixels}}const o=n>=0&&n<1e3;if(o||a){if(o&&!a&&this.renderingState!==Vt.FINISHED&&(this.cancelRendering({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:n}),this.renderingState=Vt.FINISHED,this.#p.directDrawing=!1),this.cssTransform({redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!o,hideTextLayer:o}),o)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#u});return}}this.cssTransform({}),this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0})}cancelRendering({keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:e=!1,keepXfaLayer:s=!1,keepTextLayer:n=!1,cancelExtraDelay:r=0}={}){this.renderTask&&(this.renderTask.cancel(r),this.renderTask=null),this.resume=null,this.textLayer&&(!n||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!t||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!e||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!s||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:e=!1,redrawXfaLayer:s=!1,redrawTextLayer:n=!1,hideTextLayer:r=!1}){const{canvas:a}=this;if(!a)return;const o=this.#l;if(this.viewport!==o){const l=(360+this.viewport.rotation-o.rotation)%360;if(l===90||l===270){const{width:c,height:h}=this.viewport,u=h/c,d=c/h;a.style.transform=`rotate(${l}deg) scale(${u},${d})`}else a.style.transform=l===0?"":`rotate(${l}deg)`}t&&this.annotationLayer&&this.#b(),e&&this.annotationEditorLayer&&(this.drawLayer&&this.#x(),this.#A()),s&&this.xfaLayer&&this.#S(),this.textLayer&&(r?(this.textLayer.hide(),this.structTreeLayer?.hide()):n&&this.#T())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(t,e){return this.viewport.convertToPdfPoint(t,e)}async#P(t,e=null){if(t===this.renderTask&&(this.renderTask=null),e instanceof da){this.#u=null;return}if(this.#u=e,this.renderingState=Vt.FINISHED,this.#p.regularAnnotations=!t.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#u}),e)throw e}async draw(){this.renderingState!==Vt.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:t,l10n:e,pageColors:s,pdfPage:n,viewport:r}=this;if(!n)throw this.renderingState=Vt.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Vt.RUNNING;let a=this.#e;if(a||(a=this.#e=document.createElement("div"),a.classList.add("canvasWrapper"),this.#g(a,"canvasWrapper")),!this.textLayer&&this.#o!==ts.DISABLE&&!n.isPureXfa&&(this._accessibilityManager||=new $n,this.textLayer=new rn({pdfPage:n,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#o===ts.ENABLE_PERMISSIONS,onAppend:M=>{this.l10n.pause(),this.#g(M,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#t!==hs.DISABLE){const{annotationStorage:M,annotationEditorUIManager:H,downloadManager:B,enableScripting:W,fieldObjectsPromise:et,hasJSActionsPromise:F,linkService:_}=this.#i;this._annotationCanvasMap||=new Map,this.annotationLayer=new Fh({pdfPage:n,annotationStorage:M,imageResourcesPath:this.imageResourcesPath,renderForms:this.#t===hs.ENABLE_FORMS,linkService:_,downloadManager:B,enableScripting:W,hasJSActionsPromise:F,fieldObjectsPromise:et,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:H,onAppend:Y=>{this.#g(Y,"annotationLayer")}})}const o=M=>{if(p?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=Vt.PAUSED,this.resume=()=>{this.renderingState=Vt.RUNNING,M()};return}M()},{width:l,height:c}=r,h=document.createElement("canvas");h.setAttribute("role","presentation");const u=!!(s?.background&&s?.foreground),d=this.canvas,f=!d&&!u;this.canvas=h,this.#l=r;let p=M=>{if(f){a.prepend(h),p=null;return}M&&(d?(d.replaceWith(h),d.width=d.height=0):a.prepend(h),p=null)};const g=h.getContext("2d",{alpha:!1,willReadFrequently:!this.#s}),m=this.outputScale=new $m;if(this.maxCanvasPixels===0){const M=1/this.scale;m.sx*=M,m.sy*=M,this.#n=!0}else if(this.maxCanvasPixels>0){const M=l*c,H=Math.sqrt(this.maxCanvasPixels/M);m.sx>H||m.sy>H?(m.sx=H,m.sy=H,this.#n=!0):this.#n=!1}const v=dl(m.sx),y=dl(m.sy),w=h.width=ui(di(l*m.sx),v[0]),b=h.height=ui(di(c*m.sy),y[0]),A=ui(di(l),v[1]),S=ui(di(c),y[1]);m.sx=w/A,m.sy=b/S,this.#c!==v[1]&&(t.style.setProperty("--scale-round-x",`${v[1]}px`),this.#c=v[1]),this.#d!==y[1]&&(t.style.setProperty("--scale-round-y",`${y[1]}px`),this.#d=y[1]);const T=m.scaled?[m.sx,0,0,m.sy,0,0]:null,R={canvasContext:g,transform:T,viewport:r,annotationMode:this.#t,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:s,isEditing:this.#r},x=this.renderTask=n.render(R);x.onContinue=o;const I=x.promise.then(async()=>{p?.(!0),await this.#P(x),this.structTreeLayer||=new Hh(n,r.rawDims),this.#T(),this.annotationLayer&&await this.#b();const{annotationEditorUIManager:M}=this.#i;M&&(this.drawLayer||=new Uv({pageIndex:this.id}),await this.#x(),this.drawLayer.setParent(a),this.annotationEditorLayer||=new Vv({uiManager:M,pdfPage:n,l10n:e,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:H=>{this.#g(H,"annotationEditorLayer")}}),this.#A())},M=>(M instanceof da?(d?.remove(),this.#I()):p?.(!0),this.#P(x,M)));if(n.isPureXfa){if(!this.xfaLayer){const{annotationStorage:M,linkService:H}=this.#i;this.xfaLayer=new Vh({pdfPage:n,annotationStorage:M,linkService:H})}this.#S()}return t.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),I}setPageLabel(t){this.pageLabel=typeof t=="string"?t:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:t,initialOptionalContent:e,regularAnnotations:s}=this.#p;return t&&e&&s?this.canvas:null}}async function Kv(i){const e="".split("#",1)[0];let{info:s,metadata:n,contentDispositionFilename:r,contentLength:a}=await i.getMetadata();if(!a){const{length:o}=await i.getDownloadInfo();a=o}return{...s,baseURL:e,filesize:a,filename:r||Fm(""),metadata:n?.getRaw(),authors:n?.get("dc:creator"),numPages:i.numPages,URL:""}}class Yv{constructor(t){this._ready=new Promise((e,s)=>{import(t).then(r=>{e(r.QuickJSSandbox())}).catch(s)})}async createSandbox(t){(await this._ready).create(t)}async dispatchEventInSandbox(t){const e=await this._ready;setTimeout(()=>e.dispatchEvent(t),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}class Jv{#t=null;#e=null;#s=null;#n=null;#r=null;#i=null;#a=null;#l=null;#h=!1;#c=null;#d=null;constructor({eventBus:t,externalServices:e=null,docProperties:s=null}){this.#r=t,this.#i=e,this.#s=s}setViewer(t){this.#l=t}async setDocument(t){if(this.#a&&await this.#m(),this.#a=t,!t)return;const[e,s,n]=await Promise.all([t.getFieldObjects(),t.getCalculationOrderIds(),t.getJSActions()]);if(!e&&!n){await this.#m();return}if(t!==this.#a)return;try{this.#c=this.#p()}catch(o){console.error("setDocument:",o),await this.#m();return}const r=this.#r;this.#n=new AbortController;const{signal:a}=this.#n;r._on("updatefromsandbox",o=>{o?.source===window&&this.#u(o.detail)},{signal:a}),r._on("dispatcheventinsandbox",o=>{this.#c?.dispatchEventInSandbox(o.detail)},{signal:a}),r._on("pagechanging",({pageNumber:o,previous:l})=>{o!==l&&(this.#o(l),this.#f(o))},{signal:a}),r._on("pagerendered",({pageNumber:o})=>{this._pageOpenPending.has(o)&&o===this.#l.currentPageNumber&&this.#f(o)},{signal:a}),r._on("pagesdestroy",async()=>{await this.#o(this.#l.currentPageNumber),await this.#c?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#t?.resolve()},{signal:a});try{const o=await this.#s(t);if(t!==this.#a)return;await this.#c.createSandbox({objects:e,calculationOrder:s,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...o,actions:n}}),r.dispatch("sandboxcreated",{source:this})}catch(o){console.error("setDocument:",o),await this.#m();return}await this.#c?.dispatchEventInSandbox({id:"doc",name:"Open"}),await this.#f(this.#l.currentPageNumber,!0),Promise.resolve().then(()=>{t===this.#a&&(this.#h=!0)})}async dispatchWillSave(){return this.#c?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){return this.#c?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){if(this.#c){await this.#d?.promise,this.#d=Promise.withResolvers();try{await this.#c.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(t){throw this.#d.resolve(),this.#d=null,t}await this.#d.promise}}async dispatchDidPrint(){return this.#c?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this.#e?.promise||null}get ready(){return this.#h}get _pageOpenPending(){return ki(this,"_pageOpenPending",new Set)}get _visitedPages(){return ki(this,"_visitedPages",new Map)}async#u(t){const e=this.#l,s=e.isInPresentationMode||e.isChangingPresentationMode,{id:n,siblings:r,command:a,value:o}=t;if(!n){switch(a){case"clear":console.clear();break;case"error":console.error(o);break;case"layout":if(!s){const c=am(o);e.spreadMode=c.spreadMode}break;case"page-num":e.currentPageNumber=o+1;break;case"print":await e.pagesPromise,this.#r.dispatch("print",{source:this});break;case"println":console.log(o);break;case"zoom":s||(e.currentScaleValue=o);break;case"SaveAs":this.#r.dispatch("download",{source:this});break;case"FirstPage":e.currentPageNumber=1;break;case"LastPage":e.currentPageNumber=e.pagesCount;break;case"NextPage":e.nextPage();break;case"PrevPage":e.previousPage();break;case"ZoomViewIn":s||e.increaseScale();break;case"ZoomViewOut":s||e.decreaseScale();break;case"WillPrintFinished":this.#d?.resolve(),this.#d=null;break}return}if(s&&t.focus)return;delete t.id,delete t.siblings;const l=r?[n,...r]:[n];for(const c of l){const h=document.querySelector(`[data-element-id="${c}"]`);h?h.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:t})):this.#a?.annotationStorage.setValue(c,t)}}async#f(t,e=!1){const s=this.#a,n=this._visitedPages;if(e&&(this.#t=Promise.withResolvers()),!this.#t)return;const r=this.#l.getPageView(t-1);if(r?.renderingState!==Vt.FINISHED){this._pageOpenPending.add(t);return}this._pageOpenPending.delete(t);const a=(async()=>{const o=await(n.has(t)?null:r.pdfPage?.getJSActions());s===this.#a&&await this.#c?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:o})})();n.set(t,a)}async#o(t){const e=this.#a,s=this._visitedPages;if(!this.#t||this._pageOpenPending.has(t))return;const n=s.get(t);n&&(s.set(t,null),await n,e===this.#a&&await this.#c?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:t}))}#p(){if(this.#e=Promise.withResolvers(),this.#c)throw new Error("#initScripting: Scripting already exists.");return this.#i.createScripting()}async#m(){if(!this.#c){this.#a=null,this.#e?.resolve();return}this.#t&&(await Promise.race([this.#t.promise,new Promise(t=>{setTimeout(t,1e3)})]).catch(()=>{}),this.#t=null),this.#a=null;try{await this.#c.destroySandbox()}catch{}this.#d?.reject(new Error("Scripting destroyed.")),this.#d=null,this.#n?.abort(),this.#n=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#c=null,this.#h=!1,this.#e?.resolve()}}class Zv extends Jv{constructor(t){t.externalServices||window.addEventListener("updatefromsandbox",e=>{t.eventBus.dispatch("updatefromsandbox",{source:window,detail:e.detail})}),t.externalServices||={createScripting:()=>new Yv(t.sandboxBundleSrc)},t.docProperties||=e=>Kv(e),super(t)}}Mt(3215);const Qv=3e4;class qv{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}renderHighestPriority(t){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(t)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),Qv)))}getHighestPriority(t,e,s,n=!1){const r=t.views,a=r.length;if(a===0)return null;for(let u=0;u<a;u++){const d=r[u].view;if(!this.isViewFinished(d))return d}const o=t.first.id,l=t.last.id;if(l-o+1>a){const u=t.ids;for(let d=1,f=l-o;d<f;d++){const p=s?o+d:l-d;if(u.has(p))continue;const g=e[p-1];if(!this.isViewFinished(g))return g}}let c=s?l:o-2,h=e[c];return h&&!this.isViewFinished(h)||n&&(c+=s?1:-1,h=e[c],h&&!this.isViewFinished(h))?h:null}isViewFinished(t){return t.renderingState===Vt.FINISHED}renderView(t){switch(t.renderingState){case Vt.FINISHED:return!1;case Vt.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case Vt.RUNNING:this.highestPriorityPage=t.renderingId;break;case Vt.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally(()=>{this.renderHighestPriority()}).catch(e=>{e instanceof da||console.error("renderView:",e)});break}return!0}}const $l=10,mi={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function Bl(i){return Object.values(Re).includes(i)&&i!==Re.DISABLE}class ty{#t=new Set;#e=0;constructor(t){this.#e=t}push(t){const e=this.#t;e.has(t)&&e.delete(t),e.add(t),e.size>this.#e&&this.#s()}resize(t,e=null){this.#e=t;const s=this.#t;if(e){const n=s.size;let r=1;for(const a of s)if(e.has(a.id)&&(s.delete(a),s.add(a)),++r>n)break}for(;s.size>this.#e;)this.#s()}has(t){return this.#t.has(t)}[Symbol.iterator](){return this.#t.keys()}#s(){const t=this.#t.keys().next().value;t?.destroy(),this.#t.delete(t)}}class zh{#t=null;#e=null;#s=null;#n=Re.NONE;#r=null;#i=hs.ENABLE_FORMS;#a=null;#l=null;#h=!1;#c=!1;#d=!1;#u=!1;#f=!1;#o=null;#p=null;#m=null;#g=null;#v=!1;#y=null;#b=!1;#A=0;#x=new ResizeObserver(this.#z.bind(this));#S=null;#T=null;#R=!0;#E=ts.ENABLE;constructor(t){const e="4.10.38";if(wl!==e)throw new Error(`The API version "${wl}" does not match the Viewer version "${e}".`);if(this.container=t.container,this.viewer=t.viewer||t.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#x.observe(this.container),this.eventBus=t.eventBus,this.linkService=t.linkService||new to,this.downloadManager=t.downloadManager||null,this.findController=t.findController||null,this.#e=t.altTextManager||null,this.#l=t.editorUndoBar||null,this.findController&&(this.findController.onIsPageVisible=n=>this._getVisiblePages().ids.has(n)),this._scriptingManager=t.scriptingManager||null,this.#E=t.textLayerMode??ts.ENABLE,this.#i=t.annotationMode??hs.ENABLE_FORMS,this.#n=t.annotationEditorMode??Re.NONE,this.#s=t.annotationEditorHighlightColors||null,this.#c=t.enableHighlightFloatingButton===!0,this.#u=t.enableUpdatedAddImage===!0,this.#f=t.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=t.imageResourcesPath||"",this.enablePrintAutoRotate=t.enablePrintAutoRotate||!1,this.removePageBorders=t.removePageBorders||!1,this.maxCanvasPixels=t.maxCanvasPixels,this.l10n=t.l10n,this.l10n||=new us,this.#d=t.enablePermissions||!1,this.pageColors=t.pageColors||null,this.#p=t.mlManager||null,this.#h=t.enableHWA||!1,this.#R=t.supportsPinchToZoom!==!1,this.defaultRenderingQueue=!t.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new qv,this.renderingQueue.setViewer(this)):this.renderingQueue=t.renderingQueue;const{abortSignal:s}=t;s?.addEventListener("abort",()=>{this.#x.disconnect(),this.#x=null},{once:!0}),this.scroll=Qg(this.container,this._scrollUpdate.bind(this),s),this.presentationModeState=nn.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#j(),this.eventBus._on("thumbnailrendered",({pageNumber:n,pdfPage:r})=>{const a=this._pages[n-1];this.#t.has(a)||r?.cleanup()}),t.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(t){return this._pages[t]}getCachedPageViews(){return new Set(this.#t)}get pageViewsReady(){return this._pages.every(t=>t?.pdfPage)}get renderForms(){return this.#i===hs.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(t){if(!Number.isInteger(t))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(t,!0)||console.error(`currentPageNumber: "${t}" is not a valid page.`))}_setCurrentPageNumber(t,e=!1){if(this._currentPageNumber===t)return e&&this.#B(),!0;if(!(0<t&&t<=this.pagesCount))return!1;const s=this._currentPageNumber;return this._currentPageNumber=t,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:t,pageLabel:this._pageLabels?.[t-1]??null,previous:s}),e&&this.#B(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(t){if(!this.pdfDocument)return;let e=t|0;if(this._pageLabels){const s=this._pageLabels.indexOf(t);s>=0&&(e=s+1)}this._setCurrentPageNumber(e,!0)||console.error(`currentPageLabel: "${t}" is not a valid page.`)}get currentScale(){return this._currentScale!==Fr?this._currentScale:Nh}set currentScale(t){if(isNaN(t))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#N(t,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(t){this.pdfDocument&&this.#N(t,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!_h(t))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(t%=360,t<0&&(t+=360),this._pagesRotation===t))return;this._pagesRotation=t;const e=this._currentPageNumber;this.refresh(!0,{rotation:t}),this._currentScaleValue&&this.#N(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:t,pageNumber:e}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){const t=this;return ki(this,"_layerProperties",{get annotationEditorUIManager(){return t.#r},get annotationStorage(){return t.pdfDocument?.annotationStorage},get downloadManager(){return t.downloadManager},get enableScripting(){return!!t._scriptingManager},get fieldObjectsPromise(){return t.pdfDocument?.getFieldObjects()},get findController(){return t.findController},get hasJSActionsPromise(){return t.pdfDocument?.hasJSActions()},get linkService(){return t.linkService}})}#I(t){const e={annotationEditorMode:this.#n,annotationMode:this.#i,textLayerMode:this.#E};return t&&(!t.includes(pi.COPY)&&this.#E===ts.ENABLE&&(e.textLayerMode=ts.ENABLE_PERMISSIONS),t.includes(pi.MODIFY_CONTENTS)||(e.annotationEditorMode=Re.DISABLE),!t.includes(pi.MODIFY_ANNOTATIONS)&&!t.includes(pi.FILL_INTERACTIVE_FORMS)&&this.#i===hs.ENABLE_FORMS&&(e.annotationMode=hs.ENABLE)),e}async#P(t){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;const e=Promise.withResolvers(),s=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&e.resolve()},{signal:typeof AbortSignal.any=="function"?AbortSignal.any([t,s.signal]):t}),await Promise.race([this._onePageRenderedCapability.promise,e.promise]),s.abort()}async getAllText(){const t=[],e=[];for(let s=1,n=this.pdfDocument.numPages;s<=n;++s){if(this.#b)return null;e.length=0;const r=await this.pdfDocument.getPage(s),{items:a}=await r.getTextContent();for(const o of a)o.str&&e.push(o.str),o.hasEOL&&e.push(`
`);t.push(kn(e.join("")))}return t.join(`
`)}#L(t,e){const s=document.getSelection(),{focusNode:n,anchorNode:r}=s;if(r&&n&&s.containsNode(this.#y)){if(this.#v||t===ts.ENABLE_PERMISSIONS){fa(e);return}this.#v=!0;const{classList:a}=this.viewer;a.add("copyAll");const o=new AbortController;window.addEventListener("keydown",l=>this.#b=l.key==="Escape",{signal:o.signal}),this.getAllText().then(async l=>{l!==null&&await navigator.clipboard.writeText(l)}).catch(l=>{console.warn(`Something goes wrong when extracting the text: ${l.message}`)}).finally(()=>{this.#v=!1,this.#b=!1,o.abort(),a.remove("copyAll")}),fa(e)}}setDocument(t){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#r?.destroy(),this.#r=null),this.pdfDocument=t,!t)return;const e=t.numPages,s=t.getPage(1),n=t.getOptionalContentConfig({intent:"display"}),r=this.#d?t.getPermissions():Promise.resolve(),{eventBus:a,pageColors:o,viewer:l}=this;this.#o=new AbortController;const{signal:c}=this.#o;if(e>mi.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const d=this._scrollMode=Pt.PAGE;a.dispatch("scrollmodechanged",{source:this,mode:d})}this._pagesCapability.promise.then(()=>{a.dispatch("pagesloaded",{source:this,pagesCount:e})},()=>{});const h=d=>{const f=this._pages[d.pageNumber-1];f&&this.#t.push(f)};a._on("pagerender",h,{signal:c});const u=d=>{d.cssTransform||(this._onePageRenderedCapability.resolve({timestamp:d.timestamp}),a._off("pagerendered",u))};a._on("pagerendered",u,{signal:c}),Promise.all([s,r]).then(([d,f])=>{if(t!==this.pdfDocument)return;this._firstPageCapability.resolve(d),this._optionalContentConfigPromise=n;const{annotationEditorMode:p,annotationMode:g,textLayerMode:m}=this.#I(f);if(m!==ts.DISABLE){const b=this.#y=document.createElement("div");b.id="hiddenCopyElement",l.before(b)}if(typeof AbortSignal.any=="function"&&p!==Re.DISABLE){const b=p;t.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):Bl(b)?(this.#r=new Om(this.container,l,this.#e,a,t,o,this.#s,this.#c,this.#u,this.#f,this.#p,this.#l,this.#R),a.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#r}),b!==Re.NONE&&(b===Re.STAMP&&this.#p?.loadModel("altText"),this.#r.updateMode(b))):console.error(`Invalid AnnotationEditor mode: ${b}`)}const v=this._scrollMode===Pt.PAGE?null:l,y=this.currentScale,w=d.getViewport({scale:y*os.PDF_TO_CSS_UNITS});l.style.setProperty("--scale-factor",w.scale),o?.background&&l.style.setProperty("--page-bg-color",o.background),(o?.foreground==="CanvasText"||o?.background==="Canvas")&&(l.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),l.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let b=1;b<=e;++b){const A=new Uh({container:v,eventBus:a,id:b,scale:y,defaultViewport:w.clone(),optionalContentConfigPromise:n,renderingQueue:this.renderingQueue,textLayerMode:m,annotationMode:g,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,pageColors:o,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#h});this._pages.push(A)}this._pages[0]?.setPdfPage(d),this._scrollMode===Pt.PAGE?this.#O():this._spreadMode!==ae.NONE&&this._updateSpreadMode(),this.#P(c).then(async()=>{if(t!==this.pdfDocument)return;if(this.findController?.setDocument(t),this._scriptingManager?.setDocument(t),this.#y&&document.addEventListener("copy",this.#L.bind(this,m),{signal:c}),this.#r&&a.dispatch("annotationeditormodechanged",{source:this,mode:this.#n}),t.loadingParams.disableAutoFetch||e>mi.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let b=e-1;if(b<=0){this._pagesCapability.resolve();return}for(let A=2;A<=e;++A){const S=t.getPage(A).then(T=>{const R=this._pages[A-1];R.pdfPage||R.setPdfPage(T),--b===0&&this._pagesCapability.resolve()},T=>{console.error(`Unable to get page ${A} to initialize viewer`,T),--b===0&&this._pagesCapability.resolve()});A%mi.PAUSE_EAGER_PAGE_INIT===0&&await S}}),a.dispatch("pagesinit",{source:this}),t.getMetadata().then(({info:b})=>{t===this.pdfDocument&&b.Language&&(l.lang=b.Language)}),this.defaultRenderingQueue&&this.update()}).catch(d=>{console.error("Unable to initialize viewer",d),this._pagesCapability.reject(d)})}setPageLabels(t){if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let e=0,s=this._pages.length;e<s;e++)this._pages[e].setPageLabel(this._pageLabels?.[e]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=Fr,this._currentScaleValue=null,this._pageLabels=null,this.#t=new ty($l),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=Pt.VERTICAL,this._previousScrollMode=Pt.UNKNOWN,this._spreadMode=ae.NONE,this.#S={previousPageNumber:1,scrollDown:!0,pages:[]},this.#o?.abort(),this.#o=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#y?.remove(),this.#y=null,this.#M()}#O(){if(this._scrollMode!==Pt.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const t=this._currentPageNumber,e=this.#S,s=this.viewer;if(s.textContent="",e.pages.length=0,this._spreadMode===ae.NONE&&!this.isInPresentationMode){const n=this._pages[t-1];s.append(n.div),e.pages.push(n)}else{const n=new Set,r=this._spreadMode-1;r===-1?n.add(t-1):t%2!==r?(n.add(t-1),n.add(t)):(n.add(t-2),n.add(t-1));const a=document.createElement("div");if(a.className="spread",this.isInPresentationMode){const o=document.createElement("div");o.className="dummyPage",a.append(o)}for(const o of n){const l=this._pages[o];l&&(a.append(l.div),e.pages.push(l))}s.append(a)}e.scrollDown=t>=e.previousPageNumber,e.previousPageNumber=t}_scrollUpdate(){this.pagesCount!==0&&this.update()}#_(t,e=null){const{div:s,id:n}=t;if(this._currentPageNumber!==n&&this._setCurrentPageNumber(n),this._scrollMode===Pt.PAGE&&(this.#O(),this.update()),!e&&!this.isInPresentationMode){const r=s.offsetLeft+s.clientLeft,a=r+s.clientWidth,{scrollLeft:o,clientWidth:l}=this.container;(this._scrollMode===Pt.HORIZONTAL||r<o||a>o+l)&&(e={left:0,top:0})}Dh(s,e),!this._currentScaleValue&&this._location&&(this._location=null)}#C(t){return t===this._currentScale||Math.abs(t-this._currentScale)<1e-15}#w(t,e,{noScroll:s=!1,preset:n=!1,drawingDelay:r=-1,origin:a=null}){if(this._currentScaleValue=e.toString(),this.#C(t)){n&&this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:e});return}this.viewer.style.setProperty("--scale-factor",t*os.PDF_TO_CSS_UNITS);const o=r>=0&&r<1e3;this.refresh(!0,{scale:t,drawingDelay:o?r:-1}),o&&(this.#T=setTimeout(()=>{this.#T=null,this.refresh()},r));const l=this._currentScale;if(this._currentScale=t,!s){let c=this._currentPageNumber,h;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(c=this._location.pageNumber,h=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:c,destArray:h,allowNegativeOffset:!0}),Array.isArray(a)){const u=t/l-1,[d,f]=this.containerTopLeft;this.container.scrollLeft+=(a[0]-f)*u,this.container.scrollTop+=(a[1]-d)*u}}this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:n?e:void 0}),this.defaultRenderingQueue&&this.update()}get#F(){return this._spreadMode!==ae.NONE&&this._scrollMode!==Pt.HORIZONTAL?2:1}#N(t,e){let s=parseFloat(t);if(s>0)e.preset=!1,this.#w(s,t,e);else{const n=this._pages[this._currentPageNumber-1];if(!n)return;let r=cl,a=hl;this.isInPresentationMode?(r=a=4,this._spreadMode!==ae.NONE&&(r*=2)):this.removePageBorders?r=a=0:this._scrollMode===Pt.HORIZONTAL&&([r,a]=[a,r]);const o=(this.container.clientWidth-r)/n.width*n.scale/this.#F,l=(this.container.clientHeight-a)/n.height*n.scale;switch(t){case"page-actual":s=1;break;case"page-width":s=o;break;case"page-height":s=l;break;case"page-fit":s=Math.min(o,l);break;case"auto":const c=fl(n)?o:Math.min(l,o);s=Math.min(Zg,c);break;default:console.error(`#setScale: "${t}" is an unknown zoom value.`);return}e.preset=!0,this.#w(s,t,e)}}#B(){const t=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#N(this._currentScaleValue,{noScroll:!0}),this.#_(t)}pageLabelToPageNumber(t){if(!this._pageLabels)return null;const e=this._pageLabels.indexOf(t);return e<0?null:e+1}scrollPageIntoView({pageNumber:t,destArray:e=null,allowNegativeOffset:s=!1,ignoreDestinationZoom:n=!1}){if(!this.pdfDocument)return;const r=Number.isInteger(t)&&this._pages[t-1];if(!r){console.error(`scrollPageIntoView: "${t}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!e){this._setCurrentPageNumber(t,!0);return}let a=0,o=0,l=0,c=0,h,u;const d=r.rotation%180!==0,f=(d?r.height:r.width)/r.scale/os.PDF_TO_CSS_UNITS,p=(d?r.width:r.height)/r.scale/os.PDF_TO_CSS_UNITS;let g=0;switch(e[1].name){case"XYZ":a=e[2],o=e[3],g=e[4],a=a!==null?a:0,o=o!==null?o:p;break;case"Fit":case"FitB":g="page-fit";break;case"FitH":case"FitBH":o=e[2],g="page-width",o===null&&this._location?(a=this._location.left,o=this._location.top):(typeof o!="number"||o<0)&&(o=p);break;case"FitV":case"FitBV":a=e[2],l=f,c=p,g="page-height";break;case"FitR":a=e[2],o=e[3],l=e[4]-a,c=e[5]-o;let w=cl,b=hl;this.removePageBorders&&(w=b=0),h=(this.container.clientWidth-w)/l/os.PDF_TO_CSS_UNITS,u=(this.container.clientHeight-b)/c/os.PDF_TO_CSS_UNITS,g=Math.min(Math.abs(h),Math.abs(u));break;default:console.error(`scrollPageIntoView: "${e[1].name}" is not a valid destination type.`);return}if(n||(g&&g!==this._currentScale?this.currentScaleValue=g:this._currentScale===Fr&&(this.currentScaleValue=Kg)),g==="page-fit"&&!e[4]){this.#_(r);return}const m=[r.viewport.convertToViewportPoint(a,o),r.viewport.convertToViewportPoint(a+l,o+c)];let v=Math.min(m[0][0],m[1][0]),y=Math.min(m[0][1],m[1][1]);s||(v=Math.max(v,0),y=Math.max(y,0)),this.#_(r,{left:v,top:y})}_updateLocation(t){const e=this._currentScale,s=this._currentScaleValue,n=parseFloat(s)===e?Math.round(e*1e4)/100:s,r=t.id,a=this._pages[r-1],o=this.container,l=a.getPagePoint(o.scrollLeft-t.x,o.scrollTop-t.y),c=Math.round(l[0]),h=Math.round(l[1]);let u=`#page=${r}`;this.isInPresentationMode||(u+=`&zoom=${n},${c},${h}`),this._location={pageNumber:r,scale:n,top:h,left:c,rotation:this._pagesRotation,pdfOpenParams:u}}update(){const t=this._getVisiblePages(),e=t.views,s=e.length;if(s===0)return;const n=Math.max($l,2*s+1);this.#t.resize(n,t.ids),this.renderingQueue.renderHighestPriority(t);const r=this._spreadMode===ae.NONE&&(this._scrollMode===Pt.PAGE||this._scrollMode===Pt.VERTICAL),a=this._currentPageNumber;let o=!1;for(const l of e){if(l.percent<100)break;if(l.id===a&&r){o=!0;break}}this._setCurrentPageNumber(o?a:e[0].id),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#U(){const t=this._getVisiblePages(),e=[],{ids:s,views:n}=t;for(const r of n){const{view:a}=r;if(!a.hasEditableAnnotations()){s.delete(a.id);continue}e.push(r)}return e.length===0?null:(this.renderingQueue.renderHighestPriority({first:e[0],last:e.at(-1),views:e,ids:s}),s)}containsElement(t){return this.container.contains(t)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===nn.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===nn.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const t=this._scrollMode===Pt.PAGE?this.#S.pages:this._pages,e=this._scrollMode===Pt.HORIZONTAL,s=e&&this._isContainerRtl;return tm({scrollEl:this.container,views:t,sortByVisibility:!0,horizontal:e,rtl:s})}cleanup(){for(const t of this._pages)t.renderingState!==Vt.FINISHED&&t.reset()}_cancelRendering(){for(const t of this._pages)t.cancelRendering()}async#$(t){if(t.pdfPage)return t.pdfPage;try{const e=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(e),e}catch(e){return console.error("Unable to get page for page view",e),null}}#k(t){if(t.first?.id===1)return!0;if(t.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case Pt.PAGE:return this.#S.scrollDown;case Pt.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(t){const e=t||this._getVisiblePages(),s=this.#k(e),n=this._spreadMode!==ae.NONE&&this._scrollMode!==Pt.HORIZONTAL,r=this.renderingQueue.getHighestPriority(e,this._pages,s,n);return r?(this.#$(r).then(()=>{this.renderingQueue.renderView(r)}),!0):!1}get hasEqualPageSizes(){const t=this._pages[0];for(let e=1,s=this._pages.length;e<s;++e){const n=this._pages[e];if(n.width!==t.width||n.height!==t.height)return!1}return!0}getPagesOverview(){let t;return this._pages.map(e=>{const s=e.pdfPage.getViewport({scale:1}),n=fl(s);if(t===void 0)t=n;else if(this.enablePrintAutoRotate&&n!==t)return{width:s.height,height:s.width,rotation:(s.rotation-90)%360};return{width:s.width,height:s.height,rotation:s.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(t){if(!(t instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${t}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=t,this.refresh(!1,{optionalContentConfigPromise:t}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:t}))}get scrollMode(){return this._scrollMode}set scrollMode(t){if(this._scrollMode!==t){if(!em(t))throw new Error(`Invalid scroll mode: ${t}`);this.pagesCount>mi.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=t,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(t=null){const e=this._scrollMode,s=this.viewer;s.classList.toggle("scrollHorizontal",e===Pt.HORIZONTAL),s.classList.toggle("scrollWrapped",e===Pt.WRAPPED),!(!this.pdfDocument||!t)&&(e===Pt.PAGE?this.#O():this._previousScrollMode===Pt.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#N(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(t){if(this._spreadMode!==t){if(!sm(t))throw new Error(`Invalid spread mode: ${t}`);this._spreadMode=t,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:t}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(t=null){if(!this.pdfDocument)return;const e=this.viewer,s=this._pages;if(this._scrollMode===Pt.PAGE)this.#O();else if(e.textContent="",this._spreadMode===ae.NONE)for(const n of this._pages)e.append(n.div);else{const n=this._spreadMode-1;let r=null;for(let a=0,o=s.length;a<o;++a)r===null?(r=document.createElement("div"),r.className="spread",e.append(r)):a%2===n&&(r=r.cloneNode(!1),e.append(r)),r.append(s[a].div)}t&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#N(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}_getPageAdvance(t,e=!1){switch(this._scrollMode){case Pt.WRAPPED:{const{views:s}=this._getVisiblePages(),n=new Map;for(const{id:r,y:a,percent:o,widthPercent:l}of s){if(o===0||l<100)continue;let c=n.get(a);c||n.set(a,c||=[]),c.push(r)}for(const r of n.values()){const a=r.indexOf(t);if(a===-1)continue;const o=r.length;if(o===1)break;if(e)for(let l=a-1,c=0;l>=c;l--){const h=r[l],u=r[l+1]-1;if(h<u)return t-u}else for(let l=a+1,c=o;l<c;l++){const h=r[l],u=r[l-1]+1;if(h>u)return u-t}if(e){const l=r[0];if(l<t)return t-l+1}else{const l=r[o-1];if(l>t)return l-t+1}break}break}case Pt.HORIZONTAL:break;case Pt.PAGE:case Pt.VERTICAL:{if(this._spreadMode===ae.NONE)break;const s=this._spreadMode-1;if(e&&t%2!==s)break;if(!e&&t%2===s)break;const{views:n}=this._getVisiblePages(),r=e?t-1:t+1;for(const{id:a,percent:o,widthPercent:l}of n)if(a===r){if(o>0&&l===100)return 2;break}break}}return 1}nextPage(){const t=this._currentPageNumber,e=this.pagesCount;if(t>=e)return!1;const s=this._getPageAdvance(t,!1)||1;return this.currentPageNumber=Math.min(t+s,e),!0}previousPage(){const t=this._currentPageNumber;if(t<=1)return!1;const e=this._getPageAdvance(t,!0)||1;return this.currentPageNumber=Math.max(t-e,1),!0}updateScale({drawingDelay:t,scaleFactor:e=null,steps:s=null,origin:n}){if(s===null&&e===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let r=this._currentScale;if(e>0&&e!==1)r=Math.round(r*e*100)/100;else if(s){const a=s>0?ll:1/ll,o=s>0?Math.ceil:Math.floor;s=Math.abs(s);do r=o((r*a).toFixed(2)*10)/10;while(--s>0)}r=Math.max(Yg,Math.min(Jg,r)),this.#N(r,{noScroll:!1,drawingDelay:t,origin:n})}increaseScale(t={}){this.updateScale({...t,steps:t.steps??1})}decreaseScale(t={}){this.updateScale({...t,steps:-(t.steps??1)})}#j(t=this.container.clientHeight){t!==this.#A&&(this.#A=t,nm.setProperty("--viewer-container-height",`${t}px`))}#z(t){for(const e of t)if(e.target===this.container){this.#j(Math.floor(e.borderBoxSize[0].blockSize)),this.#a=null;break}}get containerTopLeft(){return this.#a||=[this.container.offsetTop,this.container.offsetLeft]}#M(){this.#m?.abort(),this.#m=null,this.#g!==null&&(clearTimeout(this.#g),this.#g=null)}get annotationEditorMode(){return this.#r?this.#n:Re.DISABLE}set annotationEditorMode({mode:t,editId:e=null,isFromKeyboard:s=!1}){if(!this.#r)throw new Error("The AnnotationEditor is not enabled.");if(this.#n===t)return;if(!Bl(t))throw new Error(`Invalid AnnotationEditor mode: ${t}`);if(!this.pdfDocument)return;t===Re.STAMP&&this.#p?.loadModel("altText");const{eventBus:n}=this,r=()=>{this.#M(),this.#n=t,this.#r.updateMode(t,e,s),n.dispatch("annotationeditormodechanged",{source:this,mode:t})};if(t===Re.NONE||this.#n===Re.NONE){const a=t!==Re.NONE;a||this.pdfDocument.annotationStorage.resetModifiedIds();for(const l of this._pages)l.toggleEditingMode(a);const o=this.#U();if(a&&o){this.#M(),this.#m=new AbortController;const l=AbortSignal.any([this.#o.signal,this.#m.signal]);n._on("pagerendered",({pageNumber:c})=>{o.delete(c),o.size===0&&(this.#g=setTimeout(r,0))},{signal:l});return}}r()}refresh(t=!1,e=Object.create(null)){if(this.pdfDocument){for(const s of this._pages)s.update(e);this.#T!==null&&(clearTimeout(this.#T),this.#T=null),t||this.update()}}}class ey extends zh{_resetView(){super._resetView(),this._scrollMode=Pt.PAGE,this._spreadMode=ae.NONE}set scrollMode(t){}_updateScrollMode(){}set spreadMode(t){}_updateSpreadMode(){}}Ht.AnnotationLayerBuilder;Ht.DownloadManager;Ht.EventBus;Ht.FindState;Ht.GenericL10n;Ht.LinkTarget;Ht.PDFFindController;Ht.PDFHistory;Ht.PDFLinkService;Ht.PDFPageView;Ht.PDFScriptingManager;Ht.PDFSinglePageViewer;Ht.PDFViewer;Ht.ProgressBar;Ht.RenderingStates;Ht.ScrollMode;Ht.SimpleLinkService;Ht.SpreadMode;Ht.StructTreeLayerBuilder;var sy=Ht.TextLayerBuilder;Ht.XfaLayerBuilder;Ht.parseQueryString;const ny="/assets/pdf.worker.min-rsCePomN.mjs",iy=()=>{if(typeof window>"u")return"";const t=(window.location?.pathname||"/").replace(/\/index\.html$/,"");return!t||t==="/"?"":t.endsWith("/")?t.slice(0,-1):t},eo=i=>{if(i.startsWith("http://")||i.startsWith("https://"))return i;const t=iy();return t?`${t}${i}`:i},mr=async(i,t={})=>await(await fetch(eo(i),{headers:{"Content-Type":"application/json"},...t})).json(),ry=async()=>await mr("/api/library/list"),ay=async i=>{const t=new FormData;return t.append("file",i),await(await fetch(eo("/api/library/add"),{method:"POST",body:t})).json()},oy=async i=>await mr("/api/session/open",{method:"POST",body:JSON.stringify({file_id:i})}),ly=async()=>await mr("/api/session/status"),cy=async()=>await mr("/api/host/config"),hy=async i=>await(await fetch(eo(`/api/library/file/${i}`))).arrayBuffer(),uy={class:"pdf-controls"},dy=["disabled"],fy=["disabled"],py={__name:"PdfViewer",props:{fileId:{type:String,required:!0}},emits:["add-context"],setup(i,{emit:t}){const e=i;Wg.workerSrc=ny;const s=t,n=Nt(null),r=Nt(null),a=Nt(null),o=Nt(null),l=Nt(null),c=ku(null),h=Nt(1),u=Nt(0),d=Nt(1.1),f=Nt(!1),p=Nt(0),g=Nt(0),m=Nt(""),v=()=>{f.value=!1,m.value=""},y=async()=>{if(e.fileId)try{const B=await hy(e.fileId);c.value=gc(await Gg({data:B}).promise),u.value=c.value.numPages||0,h.value=1,v(),await bc(),await b()}catch(B){console.error("[SmartReader][PdfViewer] loadPdf failed",B)}},w=async(B,W)=>{if(!r.value)return;r.value.innerHTML="",r.value.style.width=`${W.width}px`,r.value.style.height=`${W.height}px`,r.value.style.setProperty("--scale-factor",W.scale.toString()),await new sy({pdfPage:B,onAppend:F=>{F.style.width=`${W.width}px`,F.style.height=`${W.height}px`,r.value?.append(F)}}).render(W),console.info("[SmartReader][PdfViewer] text layer rendered",{layerChildren:r.value.childElementCount})},b=async()=>{if(!(!c.value||!n.value))try{const B=await c.value.getPage(h.value),W=B.getViewport({scale:d.value}),et=n.value,F=et.getContext("2d");if(!F){console.error("[SmartReader][PdfViewer] canvas context unavailable");return}const _=window.devicePixelRatio||1;et.width=Math.floor(W.width*_),et.height=Math.floor(W.height*_),et.style.width=`${W.width}px`,et.style.height=`${W.height}px`,o.value&&(o.value.style.width=`${W.width}px`,o.value.style.height=`${W.height}px`),a.value&&console.info("[SmartReader][PdfViewer] layout",{viewport:{width:W.width,height:W.height,scale:W.scale},canvas:{width:et.width,height:et.height},viewer:{width:a.value.clientWidth,height:a.value.clientHeight}});const Y=_!==1?[_,0,0,_,0,0]:null;await B.render({canvasContext:F,viewport:W,transform:Y}).promise,await w(B,W)}catch(B){console.error("[SmartReader][PdfViewer] renderPage failed",B)}},A=async()=>{h.value<=1||(h.value-=1,await b())},S=async()=>{h.value>=u.value||(h.value+=1,await b())},T=async()=>{d.value=Math.min(d.value+.1,2),await b()},R=async()=>{d.value=Math.max(d.value-.1,.6),await b()},x=()=>{const B=window.getSelection();if(!B||B.isCollapsed){v();return}const W=B.toString().trim();if(!W){v();return}if(!a.value){v();return}const et=B.rangeCount?B.getRangeAt(0):null;if(!et||!a.value.contains(et.commonAncestorContainer)){v();return}const F=et.getBoundingClientRect(),_=a.value.getBoundingClientRect();p.value=F.left-_.left+a.value.scrollLeft,g.value=F.bottom-_.top+a.value.scrollTop,m.value=W,f.value=!0},I=()=>{requestAnimationFrame(x)},M=()=>{m.value&&(s("add-context",m.value),v(),window.getSelection()?.removeAllRanges())},H=B=>{f.value&&(l.value?.contains(B.target)||a.value?.contains(B.target)||v())};return Ln(()=>e.fileId,y),Qi(()=>{document.addEventListener("mousedown",H),y()}),Rc(()=>{document.removeEventListener("mousedown",H)}),(B,W)=>(U(),ct(Ut,null,[X("div",{class:"pdf-canvas",ref_key:"viewerRef",ref:a,onMouseup:I,onScroll:v},[X("div",{class:"pdf-page",ref_key:"pageRef",ref:o},[X("canvas",{ref_key:"canvasRef",ref:n},null,512),X("div",{ref_key:"textLayerRef",ref:r,class:"pdf-text-layer"},null,512)],512),f.value?(U(),ct("div",{key:0,ref_key:"menuRef",ref:l,class:"pdf-selection-menu",style:Ki({left:`${p.value}px`,top:`${g.value}px`})},[X("button",{class:"button ghost",onClick:M},"")],4)):Se("",!0)],544),X("div",uy,[X("div",null,[X("button",{class:"button ghost",onClick:A,disabled:h.value===1},"",8,dy),X("button",{class:"button ghost",onClick:S,disabled:h.value===u.value},"",8,fy)]),X("div",null," "+ut(h.value)+" / "+ut(u.value||1)+" ",1),X("div",null,[X("button",{class:"button ghost",onClick:R},"-"),X("button",{class:"button ghost",onClick:T},"+")])])],64))}},De={USER_COMMAND:"user_command",AGENT_ACK:"agent_ack",AGENT_THOUGHT:"agent_thought",AGENT_PLAN:"agent_plan",TODO_UPDATE:"todo_update",TOOL_CALL:"tool_call",TOOL_RESULT:"tool_result",AGENT_STREAM:"agent_stream",AGENT_RESPONSE:"agent_response",AGENT_ERROR:"agent_error",HUMAN_INTERVENTION_REQUEST:"human_intervention_request",HUMAN_INTERVENTION_RESPONSE:"human_intervention_response"},gy=i=>{const t=i.sanitizeAssistantText??((n,r=!0)=>r?n.trim():n),e=n=>{const r=n.payload,a=n.message_type,o={id:n.id,type:"unknown",content:"",createdAt:new Date(n.timestamp).toISOString(),payload:r};switch(a){case De.USER_COMMAND:return{...o,type:"user",content:r.text||""};case De.AGENT_ACK:return{...o,type:"ack",content:r.message||i.strings.processing};case De.AGENT_THOUGHT:return{...o,type:"thought",content:r.content||"",stage:r.stage||"thinking"};case De.AGENT_PLAN:return{...o,type:"plan",content:"",todos:r.todos||[],reasoning:r.reasoning||""};case De.TODO_UPDATE:return{...o,type:"todo_update",content:"",todoId:r.todo_id||"",status:r.status||"pending",result:r.result,error:r.error};case De.TOOL_CALL:return{...o,type:"tool_call",content:"",toolName:r.tool_name||"unknown"};case De.TOOL_RESULT:return{...o,type:"tool_result",content:"",toolName:r.tool_name||"unknown",success:r.success??!0,result:typeof r.result=="string"?r.result:JSON.stringify(r.result),actionRequired:r.action_required};case De.AGENT_STREAM:return{...o,type:"stream",content:t(r.content||r.chunk||"",!1),isFinal:r.is_final||!1};case De.AGENT_RESPONSE:return{...o,type:"response",content:t(r.content||"")};case De.AGENT_ERROR:return{...o,type:"error",content:"",errorCode:r.code||"UNKNOWN",errorMessage:r.message||i.strings.unknownError,suggestion:r.suggestion};case De.HUMAN_INTERVENTION_REQUEST:return{...o,type:"hil_request",content:r.description||i.strings.hil.title,hilRequestId:r.request_id||"",hilStatus:"pending",hilDescription:r.description||"",hilRiskLevel:r.risk_level||"medium",toolName:r.tool_name||""};case De.HUMAN_INTERVENTION_RESPONSE:return{...o,type:"unknown",content:"",hilResponseText:r.response_text||i.strings.hil.responded};default:return{...o,type:"unknown",content:JSON.stringify(r)}}};return{toUIMessage:e,mergeMessages:n=>{const r=[],a=new Map,o=new Map;for(const l of n){const c=e(l);if(c.type==="tool_call")r.push(c),c.payload?.tool_call_id&&a.set(c.payload.tool_call_id,c);else if(c.type==="tool_result"){const h=c.payload?.tool_call_id;if(h&&a.has(h)){const u=a.get(h);u.type="tool_result",u.success=c.success,u.result=c.result,u.error=c.error,u.payload={...u.payload,...c.payload,arguments:u.payload?.arguments}}else r.push(c)}else if(c.type==="hil_request")r.push(c),c.hilRequestId&&o.set(c.hilRequestId,c);else if(c.type==="unknown"&&c.hilResponseText){const h=c.payload?.request_id;if(h&&o.has(h)){const u=o.get(h),d=c.payload?.action;d==="accept"?(u.hilStatus="accepted",u.hilResponseText=i.strings.hil.confirmed):d==="reject"?(u.hilStatus="rejected",u.hilResponseText=i.strings.hil.rejected.replace("{reason}",c.payload?.reason||i.strings.hil.userCancelled)):d==="edit"&&(u.hilStatus="edited",u.hilResponseText=i.strings.hil.edited)}}else r.push(c)}return r}}},Hl={processing:"",unknownError:"",hil:{title:"",responded:"",confirmed:"",rejected:"",userCancelled:"",edited:""}},my={calling:"",completed:"",failed:"",unknown:"",parameters:"",result:"",error:"",executing:""},vy={title:"",pending:"",viewDetails:"",risk:{low:"",medium:"",high:""}},yy={received:"",taskPlan:"",step:"",completed:"",failed:"",error:"",expand:"",collapse:"",thinking:"",errorCode:""},by={planning:"",analyzing:"",gathering:"",reflecting:"",thinking:""},Ay=i=>by[i]??i,wy=i=>{const t=new Date(i);return Number.isNaN(t.getTime())?"":t.toLocaleTimeString()},xy=i=>i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Ey=i=>i?xy(i).replace(/```(\w*)\n([\s\S]*?)```/g,"<pre><code>$2</code></pre>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noreferrer">$1</a>').replace(/\n/g,"<br>"):"",Sy=Zt({name:"EmptyIcon",setup(){return()=>Ni("span")}}),Ty=()=>Sy,En=()=>typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`id_${Date.now().toString(36)}_${Math.random().toString(36).slice(2)}`;class Py{constructor(t){this.ws=null,this.handlers=new Map,this.messageHandlers=new Set,this.pendingMessages=[],this.heartbeatTimer=null,this.reconnectAttempts=0,this.state="idle",this.sessionId=null,this.serverVersion=null,this.supportedFeatures=[],this.options={heartbeatInterval:3e4,reconnect:{enabled:!0,maxAttempts:5,baseDelay:1200},...t}}get connectionState(){return this.state}get sessionInfo(){return{sessionId:this.sessionId,serverVersion:this.serverVersion,supportedFeatures:this.supportedFeatures}}on(t,e){const s=this.handlers.get(t)??new Set;s.add(e),this.handlers.set(t,s)}onMessage(t){this.messageHandlers.add(t)}off(t,e){const s=this.handlers.get(t);s&&s.delete(e)}offMessage(t){this.messageHandlers.delete(t)}async connect(){if(this.ws&&(this.ws.readyState===WebSocket.OPEN||this.ws.readyState===WebSocket.CONNECTING))return;this.updateState("connecting");const t=new WebSocket(this.options.url);this.ws=t,t.onopen=()=>{this.reconnectAttempts=0,this.updateState("open"),this.sendHandshake(),this.flushPendingMessages(),this.startHeartbeat(),this.emit("open")},t.onclose=()=>{this.stopHeartbeat(),this.updateState("closed"),this.emit("close"),this.shouldReconnect()&&this.scheduleReconnect()},t.onerror=()=>{this.updateState("error"),this.emit("error")},t.onmessage=e=>{try{const s=JSON.parse(e.data);this.handleMessage(s)}catch{this.emit("error")}}}disconnect(){this.stopHeartbeat(),this.ws&&(this.ws.close(),this.ws=null),this.updateState("closed")}sendUserCommand(t,e){const s=e?.traceId??En(),n=e?.messageId??En(),r=e?.taskId??En(),a=this.createEnvelope({type:"user_command",trace_id:s,message_id:n,project_id:e?.projectId??this.options.projectId??"",context:{task_id:r},payload:t});return this.sendEnvelope(a),{traceId:s,messageId:n,taskId:r}}sendHumanInterventionResponse(t){const e=this.createEnvelope({type:"human_intervention_response",payload:{request_id:t.requestId,action:t.action,args:t.args,reason:t.reason}});return this.sendEnvelope(e),e.message_id}sendEnvelope(t){const e=this.createEnvelope(t);return this.sendEnvelopeInternal(e),e.message_id}createEnvelope(t){return{protocol:"zmp",version:"2.0",trace_id:t.trace_id??En(),message_id:t.message_id??En(),project_id:t.project_id??this.options.projectId??"",timestamp:t.timestamp??Date.now(),type:t.type??"unknown",direction:t.direction??"request",context:t.context,payload:t.payload??{}}}sendEnvelopeInternal(t){if(this.ws?.readyState===WebSocket.OPEN){this.ws.send(JSON.stringify(t));return}this.pendingMessages.push(t)}flushPendingMessages(){for(;this.pendingMessages.length>0;){const t=this.pendingMessages.shift();if(!t)break;if(this.ws?.readyState===WebSocket.OPEN)this.ws.send(JSON.stringify(t));else{this.pendingMessages.unshift(t);break}}}sendHandshake(){this.sendEnvelopeInternal(this.createEnvelope({type:"handshake",payload:{client_version:"2.0.0",capabilities:this.options.capabilities??["agent_v2","streaming"]}}))}startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.options.heartbeatInterval&&(this.heartbeatTimer=window.setInterval(()=>{this.ws?.readyState===WebSocket.OPEN&&this.sendEnvelopeInternal(this.createEnvelope({type:"heartbeat",payload:{ping_time:Date.now()}}))},this.options.heartbeatInterval))}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}handleMessage(t){if(t.type==="handshake"&&t.direction==="response"){const e=t.payload;this.sessionId=e.session_id??null,this.serverVersion=e.server_version??null,this.supportedFeatures=e.supported_features??[],this.emit("handshake",this.sessionInfo);return}if(t.type==="heartbeat"&&t.direction==="request"){this.sendEnvelopeInternal(this.createEnvelope({type:"heartbeat",payload:{ping_time:t.payload.ping_time}}));return}this.messageHandlers.forEach(e=>e(t))}updateState(t){this.state=t,this.emit("state",t)}emit(t,e){const s=this.handlers.get(t);s&&s.forEach(n=>n(e))}shouldReconnect(){const t=this.options.reconnect;return!(!t?.enabled||this.reconnectAttempts>=(t.maxAttempts??0))}scheduleReconnect(){const t=this.options.reconnect;if(!t?.enabled)return;const e=(t.baseDelay??1e3)*Math.pow(2,this.reconnectAttempts);this.reconnectAttempts+=1,this.updateState("reconnecting"),window.setTimeout(()=>{this.connect()},e)}}const Cy=i=>{const t={...Hl.hil,...i?.strings?.hil};return{...Hl,...i?.strings,hil:t}};class Iy{constructor(t){if(this.rawMessages=Nt([]),this.uiMessages=Bt(()=>this.mapper.mergeMessages(this.rawMessages.value)),this.messageIds=new Set,this.sessionId=t?.sessionId??null,this.storageAdapter=t?.storageAdapter,this.storageNamespace=t?.storageNamespace?.trim()||void 0,t?.messageMapper)this.mapper=t.messageMapper;else{const e=Cy(t?.messageMapperOptions);this.mapper=gy({strings:e,sanitizeAssistantText:t?.messageMapperOptions?.sanitizeAssistantText})}}setSession(t){this.sessionId=t}getStorageKey(t){return this.storageNamespace?`${this.storageNamespace}:${t}`:t}async loadSession(t){const e=t??this.sessionId;if(!e||!this.storageAdapter)return;this.sessionId=e;const n=[...await this.storageAdapter.loadSessionMessages(this.getStorageKey(e))].sort((r,a)=>r.timestamp-a.timestamp);this.rawMessages.value=n,this.messageIds=new Set(n.map(r=>r.id))}async addMessage(t){const e=this.rawMessages.value.findIndex(s=>s.id===t.id);if(e>=0){this.rawMessages.value[e]={...this.rawMessages.value[e],...t},this.storageAdapter&&this.sessionId&&await this.storageAdapter.updateMessage(this.getStorageKey(this.sessionId),t);return}this.messageIds.add(t.id),this.rawMessages.value.push(t),this.storageAdapter&&this.sessionId&&await this.storageAdapter.saveMessage(this.getStorageKey(this.sessionId),t)}async clearSession(t){const e=t??this.sessionId;e&&this.storageAdapter&&await this.storageAdapter.clearSession(this.getStorageKey(e)),this.rawMessages.value=[],this.messageIds.clear()}}const Vl=i=>i.trim().replace(/[^a-zA-Z0-9_-]+/g,"_"),Ry=(i,t)=>{if(i&&i.trim()){const e=i.split("/").map(s=>Vl(s)).filter(Boolean).join("_");if(e)return`dawnchat_${e}`}return t&&t.trim()?`dawnchat_chat_${Vl(t)}`:"dawnchat_chat"};class My{constructor(t){this.namespace=t?.namespace?.trim()||void 0,this.dbName=t?.dbName??Ry(t?.dbPath,this.namespace),this.storeName=t?.storeName??"messages",this.version=t?.version??1}async loadSessionMessages(t){const e=await this.openDb();return new Promise((s,n)=>{const r=e.transaction(this.storeName,"readonly"),l=r.objectStore(this.storeName).index("sessionId").getAll(IDBKeyRange.only(t));l.onsuccess=()=>{const h=(l.result??[]).map(u=>u.message).sort((u,d)=>u.timestamp-d.timestamp);s(h)},l.onerror=()=>n(l.error),r.oncomplete=()=>e.close(),r.onerror=()=>e.close()})}async saveMessage(t,e){await this.putMessage(t,e)}async updateMessage(t,e){await this.putMessage(t,e)}async clearSession(t){const e=await this.openDb();return new Promise((s,n)=>{const r=e.transaction(this.storeName,"readwrite"),a=r.objectStore(this.storeName),l=a.index("sessionId").getAllKeys(IDBKeyRange.only(t));l.onsuccess=()=>{l.result.forEach(h=>a.delete(h))},l.onerror=()=>n(l.error),r.oncomplete=()=>{e.close(),s()},r.onerror=()=>{e.close(),n(r.error)}})}async putMessage(t,e){const s=await this.openDb();return new Promise((n,r)=>{const a=s.transaction(this.storeName,"readwrite"),o=a.objectStore(this.storeName),l={key:`${t}:${e.id}`,sessionId:t,timestamp:e.timestamp,message:e},c=o.put(l);c.onsuccess=()=>n(),c.onerror=()=>r(c.error),a.oncomplete=()=>s.close(),a.onerror=()=>s.close()})}openDb(){return typeof indexedDB>"u"?Promise.reject(new Error("IndexedDB is not available")):new Promise((t,e)=>{const s=indexedDB.open(this.dbName,this.version);s.onupgradeneeded=()=>{const n=s.result;if(!n.objectStoreNames.contains(this.storeName)){const r=n.createObjectStore(this.storeName,{keyPath:"key"});r.createIndex("sessionId","sessionId",{unique:!1}),r.createIndex("timestamp","timestamp",{unique:!1})}},s.onsuccess=()=>t(s.result),s.onerror=()=>e(s.error)})}}const Ul=(i,t="assistant")=>({id:i.message_id,trace_id:i.trace_id,message_type:i.type,project_id:i.project_id,payload:i.payload??{},timestamp:i.timestamp??Date.now(),sender_id:t}),Ly=i=>{const t=i.storageNamespace??i.namespace,e=i.storageAdapter??(i.dbPath||t?new My({dbPath:i.dbPath,namespace:t}):void 0),s=i.store??new Iy({sessionId:i.sessionId??i.projectId,storageAdapter:e,storageNamespace:t,messageMapperOptions:i.messageMapperOptions,messageMapper:i.messageMapper}),n=i.client??new Py({url:i.wsUrl,projectId:i.projectId,sessionId:i.sessionId,capabilities:i.capabilities,heartbeatInterval:i.heartbeatInterval,reconnect:i.reconnect}),r=Nt("idle"),a=Nt({sessionId:i.sessionId??null,serverVersion:null,supportedFeatures:[]}),o=Nt(null);n.on("state",d=>{r.value=d}),n.on("handshake",d=>{const f=d;a.value={sessionId:f.sessionId??null,serverVersion:f.serverVersion??null,supportedFeatures:f.supportedFeatures??[]}}),n.on("error",d=>{o.value=d}),n.onMessage(d=>{s.addMessage(Ul(d))});const l=async()=>{const d=i.sessionId??i.projectId;d&&await s.loadSession(d),await n.connect()},c=()=>{n.disconnect()},h=(d,f)=>{const p={text:d,files:f?.files,model_config:f?.modelConfig??i.modelConfig,mode:f?.mode??i.mode,workflow_context:f?.workflowContext??i.workflowContext,plugin_context:f?.pluginContext??i.pluginContext,chat_history:f?.history},g=n.sendUserCommand(p,{projectId:i.projectId}),m=Ul({trace_id:g.traceId,message_id:g.messageId,project_id:i.projectId??"",timestamp:Date.now(),type:"user_command",context:{task_id:g.taskId},payload:p},"user");return s.addMessage(m),g},u=d=>n.sendHumanInterventionResponse(d);return i.autoConnect!==!1&&(Qi(()=>{l()}),qi(()=>{c()})),{store:s,client:n,messages:Bt(()=>s.uiMessages.value),rawMessages:Bt(()=>s.rawMessages.value),connectionState:r,sessionInfo:a,lastError:o,connect:l,disconnect:c,sendMessage:h,sendHumanResponse:u}},Oy={class:"header-content"},Ny={key:1,class:"icon"},Dy={class:"title"},_y={class:"expand-btn"},Fy={class:"message-body"},ky={class:"content-wrapper"},jy=Zt({__name:"CollapsibleMessage",props:{title:{},icon:{},defaultExpanded:{type:Boolean},expandText:{},collapseText:{}},setup(i){const e=Nt(i.defaultExpanded||!1),s=()=>{e.value=!e.value};return(n,r)=>(U(),ct("div",{class:ue(["collapsible-message",{expanded:e.value}])},[X("div",{class:"message-header",onClick:s},[X("div",Oy,[Un(n.$slots,"header",{},()=>[i.icon&&typeof i.icon!="string"?(U(),ht(cn(i.icon),{key:0,class:"icon-component",size:16})):i.icon?(U(),ct("span",Ny,ut(i.icon),1)):Se("",!0),X("span",Dy,ut(i.title),1)],!0)]),X("button",_y,ut(e.value?i.collapseText:i.expandText),1)]),Na(X("div",Fy,[X("div",ky,[Un(n.$slots,"default",{},void 0,!0)])],512),[[eh,e.value]])],2))}}),Wh=me(jy,[["__scopeId","data-v-8c2ded27"]]);const zl=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$y=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,s)=>s?s.toUpperCase():e.toLowerCase()),By=i=>{const t=$y(i);return t.charAt(0).toUpperCase()+t.slice(1)},Hy=(...i)=>i.filter((t,e,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===e).join(" ").trim(),Wl=i=>i==="";var Sn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const Vy=({name:i,iconNode:t,absoluteStrokeWidth:e,"absolute-stroke-width":s,strokeWidth:n,"stroke-width":r,size:a=Sn.width,color:o=Sn.stroke,...l},{slots:c})=>Ni("svg",{...Sn,...l,width:a,height:a,stroke:o,"stroke-width":Wl(e)||Wl(s)||e===!0||s===!0?Number(n||r||Sn["stroke-width"])*24/Number(a):n||r||Sn["stroke-width"],class:Hy("lucide",l.class,...i?[`lucide-${zl(By(i))}-icon`,`lucide-${zl(i)}`]:["lucide-icon"])},[...t.map(h=>Ni(...h)),...c.default?[c.default()]:[]]);const Pe=(i,t)=>(e,{slots:s,attrs:n})=>Ni(Vy,{...n,...e,iconNode:t,name:i},s);const Uy=Pe("brain-circuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);const zy=Pe("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Wy=Pe("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const Gh=Pe("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const vr=Pe("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const Gy=Pe("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const Xy=Pe("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const Ky=Pe("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const Yy=Pe("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);const Bi=Pe("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const Jy=Pe("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);const Zy=Pe("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Xh=Pe("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]);const Qy=Pe("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),qy={class:"header-left"},tb={class:"tool-name"},eb={key:0,class:"tool-summary"},sb={class:"tool-body"},nb={key:0,class:"section arguments-section"},ib={class:"section-title"},rb={class:"code-block"},ab={key:1,class:"section result-section"},ob={class:"section-title"},lb={key:0,class:"result-content"},cb={key:0,class:"code-block"},hb={key:1,class:"text-result"},ub={key:1,class:"error-content"},db={key:2,class:"section running-section"},fb={class:"running-indicator"},pb=Zt({__name:"ToolCallMessage",props:{toolName:{},toolCallId:{},arguments:{},success:{type:Boolean,default:!0},result:{},resultDescription:{},error:{},isComplete:{type:Boolean,default:!1},defaultExpanded:{type:Boolean,default:!1},labels:{}},setup(i){const t=i,e=Nt(t.defaultExpanded),s=()=>{e.value=!e.value},n=Bt(()=>t.isComplete?t.success?"success":"failed":"running"),r=Bt(()=>{switch(n.value){case"running":return Bi;case"success":return Gh;case"failed":return vr;default:return Xh}}),a=Bt(()=>{switch(n.value){case"running":return t.labels.calling;case"success":return t.labels.completed;case"failed":return t.labels.failed;default:return t.labels.unknown}}),o=Bt(()=>n.value==="running"),l=Bt(()=>t.arguments&&Object.keys(t.arguments).length>0),c=Bt(()=>{if(!t.arguments)return"";try{return JSON.stringify(t.arguments,null,2)}catch{return String(t.arguments)}}),h=Bt(()=>t.isComplete&&(t.result||t.error)),u=Bt(()=>{if(!t.result)return!1;try{return JSON.parse(t.result),!0}catch{return t.result.startsWith("{")||t.result.startsWith("[")}}),d=Bt(()=>{if(!t.result)return"";try{const f=JSON.parse(t.result);return JSON.stringify(f,null,2)}catch{return t.result}});return(f,p)=>(U(),ct("div",{class:ue(["tool-call-message",[n.value,{expanded:e.value}]])},[X("div",{class:"tool-header",onClick:s},[X("div",qy,[(U(),ht(cn(r.value),{size:16,class:ue(["tool-icon",{"animate-spin":o.value}])},null,8,["class"])),X("span",tb,ut(i.toolName),1),X("span",{class:ue(["status-badge",n.value])},ut(a.value),3)]),X("button",{class:ue(["expand-btn",{rotated:e.value}])},[bt(yt(Wy),{size:16})],2)]),i.isComplete&&!e.value&&i.resultDescription?(U(),ct("div",eb,ut(i.resultDescription),1)):Se("",!0),Na(X("div",sb,[l.value?(U(),ct("div",nb,[X("div",ib,ut(i.labels.parameters),1),X("pre",rb,ut(c.value),1)])):Se("",!0),h.value?(U(),ct("div",ab,[X("div",ob,ut(i.success?i.labels.result:i.labels.error),1),i.success?(U(),ct("div",lb,[u.value?(U(),ct("pre",cb,ut(d.value),1)):(U(),ct("div",hb,ut(i.result),1))])):(U(),ct("div",ub,ut(i.error),1))])):Se("",!0),o.value?(U(),ct("div",db,[X("div",fb,[bt(yt(Bi),{size:16,class:"animate-spin"}),X("span",null,ut(i.labels.executing),1)])])):Se("",!0)],512),[[eh,e.value]])],2))}}),Hi=me(pb,[["__scopeId","data-v-089b7608"]]),gb=Zt({__name:"MessageItem",props:{role:{},variant:{}},setup(i){return(t,e)=>(U(),ct("div",{class:ue(["message",[i.role,i.variant]])},[Un(t.$slots,"default",{},void 0,!0)],2))}}),Te=me(gb,[["__scopeId","data-v-a673a801"]]),mb=Zt({__name:"MessageBubble",props:{variant:{}},setup(i){const t=i,e=Bt(()=>{if(t.variant==="user")return"variant-user";if(t.variant==="assistant")return"variant-assistant"});return(s,n)=>(U(),ct("div",{class:ue(["message-content",e.value])},[Un(s.$slots,"default",{},void 0,!0)],2))}}),so=me(mb,[["__scopeId","data-v-b9bc1bd1"]]),vb={class:"message-time"},yb=Zt({__name:"MessageMeta",props:{text:{}},setup(i){return(t,e)=>(U(),ct("div",vb,ut(i.text),1))}}),no=me(yb,[["__scopeId","data-v-3496fa1f"]]),bb={key:0,class:"status-indicator"},Ab={class:"status-text"},wb={key:1,class:"status-indicator completed"},xb={class:"status-text"},Eb=Zt({__name:"AckMessage",props:{content:{},isLatest:{type:Boolean},receivedText:{}},setup(i){return(t,e)=>(U(),ht(Te,{role:"system",variant:"status-message"},{default:Gt(()=>[i.isLatest?(U(),ct("div",bb,[bt(yt(Bi),{size:14,class:"status-icon spinning"}),X("span",Ab,ut(i.content),1)])):(U(),ct("div",wb,[bt(yt(zy),{size:14,class:"status-icon"}),X("span",xb,ut(i.receivedText),1)]))]),_:1}))}}),Kh=me(Eb,[["__scopeId","data-v-fb11a36d"]]),Sb={class:"error-content"},Tb={class:"error-details"},Pb={class:"error-title"},Cb={key:0,class:"error-code"},Ib={key:1,class:"error-suggestion"},Rb=Zt({__name:"ErrorMessage",props:{errorMessage:{},errorCode:{},suggestion:{},time:{},labels:{}},setup(i){return(t,e)=>(U(),ht(Te,{role:"assistant",variant:"error-message"},{default:Gt(()=>[X("div",Sb,[bt(yt(vr),{size:20,class:"error-icon"}),X("div",Tb,[X("div",Pb,ut(i.errorMessage),1),i.errorCode?(U(),ct("div",Cb,ut(i.labels.errorCode)+": "+ut(i.errorCode),1)):Se("",!0),i.suggestion?(U(),ct("div",Ib,[bt(yt(Yy),{size:14,class:"mr-1 inline-icon"}),Cs(" "+ut(i.suggestion),1)])):Se("",!0)])]),bt(no,{text:i.time},null,8,["text"])]),_:1}))}}),Yh=me(Rb,[["__scopeId","data-v-2ebecc9b"]]),Mb={class:"hil-message-header"},Lb={class:"hil-title"},Ob={class:"hil-message-body"},Nb={class:"hil-description"},Db={key:0,class:"hil-tool-name"},_b={class:"hil-message-footer"},Fb={class:"hil-status pending"},kb=Zt({__name:"HilMessage",props:{riskLevel:{},status:{},description:{},toolName:{},responseText:{},requestId:{},labels:{}},emits:["viewDetails"],setup(i,{emit:t}){const e=i,s=t,n=Bt(()=>e.riskLevel==="high"?Zy:e.riskLevel==="medium"?Qy:Ky),r=Bt(()=>e.status==="accepted"?Gh:e.status==="rejected"?vr:Jy),a=()=>{s("viewDetails",e.requestId)};return(o,l)=>(U(),ht(Te,{role:"system",variant:"hil-message-wrapper"},{default:Gt(()=>[X("div",{class:ue(["hil-message",[`risk-${i.riskLevel}`,i.status]])},[X("div",Mb,[(U(),ht(cn(n.value),{size:16,class:"hil-icon"})),X("span",Lb,ut(i.labels.title),1),X("span",{class:ue(["hil-risk-badge",`risk-${i.riskLevel}`])},ut(i.labels.risk[i.riskLevel]),3)]),X("div",Ob,[X("p",Nb,ut(i.description),1),i.toolName?(U(),ct("div",Db,[bt(yt(Xh),{size:14,class:"mr-1 inline-icon"}),Cs(" "+ut(i.toolName),1)])):Se("",!0)]),X("div",_b,[i.status==="pending"?(U(),ct(Ut,{key:0},[X("span",Fb,[bt(yt(Bi),{size:14,class:"mr-1 inline-icon spinning"}),Cs(" "+ut(i.labels.pending),1)]),X("button",{class:"hil-action-btn",onClick:a},ut(i.labels.viewDetails),1)],64)):(U(),ct("span",{key:1,class:ue(["hil-status",i.status])},[(U(),ht(cn(r.value),{size:14,class:"mr-1 inline-icon"})),Cs(" "+ut(i.responseText),1)],2))])],2)]),_:1}))}}),Jh=me(kb,[["__scopeId","data-v-395d714e"]]),jb={class:"plan-content"},$b={key:0,class:"plan-reasoning"},Bb={class:"plan-todo-list"},Hb={class:"todo-text"},Vb=Zt({__name:"PlanMessage",props:{title:{},icon:{},expandText:{},collapseText:{},todos:{},reasoning:{},todoIconResolver:{type:Function}},setup(i){return(t,e)=>(U(),ht(Te,{role:"system",variant:"plan-message"},{default:Gt(()=>[bt(Wh,{title:i.title,icon:i.icon,"default-expanded":!0,"expand-text":i.expandText,"collapse-text":i.collapseText},{default:Gt(()=>[X("div",jb,[i.reasoning?(U(),ct("div",$b,ut(i.reasoning),1)):Se("",!0),X("div",Bb,[(U(!0),ct(Ut,null,tr(i.todos,s=>(U(),ct("div",{key:s.id,class:"plan-todo-item"},[(U(),ht(cn(i.todoIconResolver(s.status)),{size:14,class:"todo-icon"})),X("span",Hb,ut(s.description),1)]))),128))])])]),_:1},8,["title","icon","expand-text","collapse-text"])]),_:1}))}}),Zh=me(Vb,[["__scopeId","data-v-770bf6b6"]]),Ub=["innerHTML"],zb=Zt({__name:"ResponseMessage",props:{html:{},time:{}},setup(i){return(t,e)=>(U(),ht(Te,{role:"assistant"},{default:Gt(()=>[bt(so,{variant:"assistant"},{default:Gt(()=>[X("div",{class:"markdown-content",innerHTML:i.html},null,8,Ub)]),_:1}),bt(no,{text:i.time},null,8,["text"])]),_:1}))}}),Qh=me(zb,[["__scopeId","data-v-0c1d1d55"]]),Wb={class:"stream-content"},Gb={key:0,class:"stream-cursor"},Xb=Zt({__name:"StreamMessage",props:{content:{},isFinal:{type:Boolean}},setup(i){return(t,e)=>(U(),ht(Te,{role:"assistant",variant:"streaming"},{default:Gt(()=>[bt(so,{variant:"assistant"},{default:Gt(()=>[X("span",Wb,ut(i.content),1),i.isFinal?Se("",!0):(U(),ct("span",Gb,""))]),_:1})]),_:1}))}}),qh=me(Xb,[["__scopeId","data-v-fb3189fd"]]),Kb={class:"thought-content-text"},tu=Zt({__name:"ThoughtMessage",props:{title:{},content:{},icon:{},expandText:{},collapseText:{}},setup(i){return(t,e)=>(U(),ht(Te,{role:"system",variant:"thought-message"},{default:Gt(()=>[bt(Wh,{title:i.title,icon:i.icon,"default-expanded":!1,"expand-text":i.expandText,"collapse-text":i.collapseText},{default:Gt(()=>[X("div",Kb,ut(i.content),1)]),_:1},8,["title","icon","expand-text","collapse-text"])]),_:1}))}}),Yb={key:0,class:"system-note error"},Jb=Zt({__name:"TodoUpdateMessage",props:{status:{},todoId:{},error:{},stepLabel:{},failedLabel:{}},setup(i){return(t,e)=>(U(),ht(Te,{role:"system",variant:"todo-update-message"},{default:Gt(()=>[i.status==="failed"?(U(),ct("div",Yb,[bt(yt(vr),{size:14,class:"mr-1 inline-icon"}),Cs(" "+ut(i.stepLabel)+" "+ut(i.todoId?.substring(0,8))+" "+ut(i.failedLabel)+": "+ut(i.error),1)])):Se("",!0)]),_:1}))}}),eu=me(Jb,[["__scopeId","data-v-a4a13402"]]),Zb={class:"unknown-content"},Qb={class:"unknown-text"},qb=Zt({__name:"UnknownMessage",props:{content:{}},setup(i){return(t,e)=>(U(),ht(Te,{role:"system",variant:"unknown-message"},{default:Gt(()=>[X("div",Zb,[bt(yt(Xy),{size:16,class:"unknown-icon"}),X("span",Qb,ut(i.content),1)])]),_:1}))}}),su=me(qb,[["__scopeId","data-v-d9fff15c"]]),nu=Zt({__name:"UserMessage",props:{content:{},time:{}},setup(i){return(t,e)=>(U(),ht(Te,{role:"user"},{default:Gt(()=>[bt(so,{variant:"user"},{default:Gt(()=>[Cs(ut(i.content),1)]),_:1}),bt(no,{text:i.time},null,8,["text"])]),_:1}))}}),t0=Zt({__name:"MessageList",props:{messages:{},formatTime:{type:Function},renderMarkdown:{type:Function},stageLabelResolver:{type:Function},todoIconResolver:{type:Function},toolCallLabels:{},hilLabels:{},labels:{},icons:{}},emits:["view-details"],setup(i,{emit:t}){const e=i,s=t,n=Bt(()=>e.icons?.thought??Uy),r=Bt(()=>e.icons?.plan??Gy),a=m=>m.todos?`${e.labels.taskPlan}: ${m.todos.length} ${e.labels.step}`:`${e.labels.taskPlan}: ${e.labels.completed}`,o=m=>m.toolName??m.payload?.tool_name??e.toolCallLabels.unknown,l=m=>m.payload?.tool_call_id||"",c=m=>m.payload?.arguments||{},h=m=>m.success??m.payload?.success??!0,u=m=>m.result||m.payload?.result,d=m=>m.payload?.result_description,f=m=>m.error||m.payload?.error,p=m=>m.content||(m.payload?JSON.stringify(m.payload):""),g=m=>{s("view-details",m)};return(m,v)=>(U(!0),ct(Ut,null,tr(i.messages,(y,w)=>(U(),ct(Ut,{key:y.id},[y.type==="user"?(U(),ht(nu,{key:0,content:y.content,time:i.formatTime(y.createdAt)},null,8,["content","time"])):y.type==="ack"?(U(),ht(Kh,{key:1,content:y.content,"is-latest":w===i.messages.length-1,"received-text":i.labels.received},null,8,["content","is-latest","received-text"])):y.type==="thought"?(U(),ht(tu,{key:2,title:y.stage?`${i.stageLabelResolver(y.stage)}...`:i.labels.thinking,content:y.content,icon:n.value,"expand-text":i.labels.expand,"collapse-text":i.labels.collapse},null,8,["title","content","icon","expand-text","collapse-text"])):y.type==="plan"?(U(),ht(Zh,{key:3,title:a(y),icon:r.value,"expand-text":i.labels.expand,"collapse-text":i.labels.collapse,todos:y.todos||[],reasoning:y.reasoning,"todo-icon-resolver":i.todoIconResolver},null,8,["title","icon","expand-text","collapse-text","todos","reasoning","todo-icon-resolver"])):y.type==="todo_update"?(U(),ht(eu,{key:4,status:y.status,"todo-id":y.todoId,error:y.error,"step-label":i.labels.step,"failed-label":i.labels.failed},null,8,["status","todo-id","error","step-label","failed-label"])):y.type==="tool_call"?(U(),ht(Te,{key:5,role:"system",variant:"tool-call-wrapper"},{default:Gt(()=>[bt(Hi,{"tool-name":o(y),"tool-call-id":l(y),arguments:c(y),"is-complete":!1,labels:i.toolCallLabels},null,8,["tool-name","tool-call-id","arguments","labels"])]),_:2},1024)):y.type==="tool_result"?(U(),ht(Te,{key:6,role:"system",variant:"tool-result-wrapper"},{default:Gt(()=>[bt(Hi,{"tool-name":o(y),"tool-call-id":l(y),arguments:c(y),success:h(y),result:u(y),"result-description":d(y),error:f(y),"is-complete":!0,"default-expanded":!1,labels:i.toolCallLabels},null,8,["tool-name","tool-call-id","arguments","success","result","result-description","error","labels"])]),_:2},1024)):y.type==="hil_request"?(U(),ht(Jh,{key:7,"risk-level":y.hilRiskLevel||"medium",status:y.hilStatus||"pending",description:y.hilDescription||"","tool-name":y.toolName,"response-text":y.hilResponseText,"request-id":y.hilRequestId,labels:i.hilLabels,onViewDetails:g},null,8,["risk-level","status","description","tool-name","response-text","request-id","labels"])):y.type==="stream"?(U(),ht(qh,{key:8,content:y.content,"is-final":y.isFinal},null,8,["content","is-final"])):y.type==="response"?(U(),ht(Qh,{key:9,html:i.renderMarkdown(y.content),time:i.formatTime(y.createdAt)},null,8,["html","time"])):y.type==="error"?(U(),ht(Yh,{key:10,"error-message":y.errorMessage||i.labels.error,"error-code":y.errorCode,suggestion:y.suggestion,time:i.formatTime(y.createdAt),labels:{errorCode:i.labels.errorCode}},null,8,["error-message","error-code","suggestion","time","labels"])):(U(),ht(su,{key:11,content:p(y)},null,8,["content"]))],64))),128))}}),e0=Zt({__name:"ExtensibleMessageList",props:{messages:{},formatTime:{type:Function},renderMarkdown:{type:Function},stageLabelResolver:{type:Function},todoIconResolver:{type:Function},toolCallLabels:{},hilLabels:{},labels:{},icons:{},renderers:{},transform:{type:Function}},emits:["view-details"],setup(i,{emit:t}){const e=i,s=t,n=Bt(()=>e.icons?.thought),r=Bt(()=>e.icons?.plan),a=Bt(()=>e.transform?e.transform(e.messages):e.messages),o=y=>e.renderers?.[y],l=y=>y.todos?`${e.labels.taskPlan}: ${y.todos.length} ${e.labels.step}`:`${e.labels.taskPlan}: ${e.labels.completed}`,c=y=>y.toolName??y.payload?.tool_name??e.toolCallLabels.unknown,h=y=>y.payload?.tool_call_id||"",u=y=>y.payload?.arguments||{},d=y=>y.success??y.payload?.success??!0,f=y=>y.result||y.payload?.result,p=y=>y.payload?.result_description||y.result||y.payload?.result,g=y=>y.error||y.payload?.error,m=y=>y.content||(y.payload?JSON.stringify(y.payload):""),v=y=>{s("view-details",y)};return(y,w)=>(U(!0),ct(Ut,null,tr(a.value,(b,A)=>(U(),ct(Ut,{key:b.id},[o(b.type)?(U(),ht(cn(o(b.type)),{key:0,message:b},null,8,["message"])):b.type==="user"?(U(),ht(yt(nu),{key:1,content:b.content,time:i.formatTime(b.createdAt)},null,8,["content","time"])):b.type==="ack"?(U(),ht(yt(Kh),{key:2,content:b.content,"is-latest":A===a.value.length-1,"received-text":i.labels.received},null,8,["content","is-latest","received-text"])):b.type==="thought"?(U(),ht(yt(tu),{key:3,title:b.stage?`${i.stageLabelResolver(b.stage)}...`:i.labels.thinking,content:b.content,icon:n.value,"expand-text":i.labels.expand,"collapse-text":i.labels.collapse},null,8,["title","content","icon","expand-text","collapse-text"])):b.type==="plan"?(U(),ht(yt(Zh),{key:4,title:l(b),icon:r.value,"expand-text":i.labels.expand,"collapse-text":i.labels.collapse,todos:b.todos||[],reasoning:b.reasoning,"todo-icon-resolver":i.todoIconResolver},null,8,["title","icon","expand-text","collapse-text","todos","reasoning","todo-icon-resolver"])):b.type==="todo_update"?(U(),ht(yt(eu),{key:5,status:b.status,"todo-id":b.todoId,error:b.error,"step-label":i.labels.step,"failed-label":i.labels.failed},null,8,["status","todo-id","error","step-label","failed-label"])):b.type==="tool_call"?(U(),ht(yt(Te),{key:6,role:"system",variant:"tool-call-wrapper"},{default:Gt(()=>[bt(yt(Hi),{"tool-name":c(b),"tool-call-id":h(b),arguments:u(b),"is-complete":!1,labels:i.toolCallLabels},null,8,["tool-name","tool-call-id","arguments","labels"])]),_:2},1024)):b.type==="tool_result"?(U(),ht(yt(Te),{key:7,role:"system",variant:"tool-result-wrapper"},{default:Gt(()=>[bt(yt(Hi),{"tool-name":c(b),"tool-call-id":h(b),arguments:u(b),success:d(b),result:f(b),"result-description":p(b),error:g(b),"is-complete":!0,"default-expanded":!1,labels:i.toolCallLabels},null,8,["tool-name","tool-call-id","arguments","success","result","result-description","error","labels"])]),_:2},1024)):b.type==="hil_request"?(U(),ht(yt(Jh),{key:8,"risk-level":b.hilRiskLevel||"medium",status:b.hilStatus||"pending",description:b.hilDescription||"","tool-name":b.toolName,"response-text":b.hilResponseText,"request-id":b.hilRequestId,labels:i.hilLabels,onViewDetails:v},null,8,["risk-level","status","description","tool-name","response-text","request-id","labels"])):b.type==="stream"?(U(),ht(yt(qh),{key:9,content:b.content,"is-final":b.isFinal},null,8,["content","is-final"])):b.type==="response"?(U(),ht(yt(Qh),{key:10,html:i.renderMarkdown(b.content),time:i.formatTime(b.createdAt)},null,8,["html","time"])):b.type==="error"?(U(),ht(yt(Yh),{key:11,"error-message":b.errorMessage||i.labels.error,"error-code":b.errorCode,suggestion:b.suggestion,time:i.formatTime(b.createdAt),labels:{errorCode:i.labels.errorCode}},null,8,["error-message","error-code","suggestion","time","labels"])):(U(),ht(yt(su),{key:12,content:m(b)},null,8,["content"]))],64))),128))}}),s0={class:"dc-chat-root"},n0={class:"dc-chat-root__messages"},i0={class:"dc-chat-root__composer"},r0=Zt({__name:"ChatRoot",props:{messages:{},formatTime:{type:Function,default:wy},renderMarkdown:{type:Function,default:Ey},stageLabelResolver:{type:Function,default:Ay},todoIconResolver:{type:Function,default:Ty},toolCallLabels:{default:()=>my},hilLabels:{default:()=>vy},labels:{default:()=>yy},icons:{},renderers:{},transform:{}},emits:["view-details"],setup(i,{emit:t}){const e=t,s=n=>{e("view-details",n)};return(n,r)=>(U(),ct("div",s0,[X("div",n0,[i.renderers||i.transform?(U(),ht(e0,{key:0,messages:i.messages,"format-time":i.formatTime,"render-markdown":i.renderMarkdown,"stage-label-resolver":i.stageLabelResolver,"todo-icon-resolver":i.todoIconResolver,"tool-call-labels":i.toolCallLabels,"hil-labels":i.hilLabels,labels:i.labels,icons:i.icons,renderers:i.renderers,transform:i.transform,onViewDetails:s},null,8,["messages","format-time","render-markdown","stage-label-resolver","todo-icon-resolver","tool-call-labels","hil-labels","labels","icons","renderers","transform"])):(U(),ht(yt(t0),{key:1,messages:i.messages,"format-time":i.formatTime,"render-markdown":i.renderMarkdown,"stage-label-resolver":i.stageLabelResolver,"todo-icon-resolver":i.todoIconResolver,"tool-call-labels":i.toolCallLabels,"hil-labels":i.hilLabels,labels:i.labels,icons:i.icons,onViewDetails:s},null,8,["messages","format-time","render-markdown","stage-label-resolver","todo-icon-resolver","tool-call-labels","hil-labels","labels","icons"]))]),X("div",i0,[Un(n.$slots,"composer")])]))}}),a0={class:"dc-message-composer"},o0=["placeholder","disabled"],l0=["disabled"],c0=Zt({__name:"MessageComposer",props:{modelValue:{default:""},placeholder:{default:""},sendLabel:{default:""},disabled:{type:Boolean,default:!1},sendOnEnter:{type:Boolean,default:!0}},emits:["update:modelValue","send"],setup(i,{emit:t}){const e=i,s=t,n=Bt({get:()=>e.modelValue,set:l=>s("update:modelValue",l)}),r=Bt(()=>n.value.trim().length>0),a=()=>{if(e.disabled||!r.value)return;const l=n.value.trim();s("send",l),s("update:modelValue","")},o=l=>{e.sendOnEnter&&l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),a())};return(l,c)=>(U(),ct("div",a0,[Na(X("textarea",{"onUpdate:modelValue":c[0]||(c[0]=h=>n.value=h),class:"dc-message-composer__input",placeholder:i.placeholder,disabled:i.disabled,rows:"1",onKeydown:o},null,40,o0),[[bf,n.value]]),X("button",{class:"dc-message-composer__send",type:"button",disabled:i.disabled||!r.value,onClick:a},ut(i.sendLabel),9,l0)]))}}),h0={class:"chat-panel"},u0={key:0,class:"empty-state"},zr="com.dawnchat.smart-reader",d0={__name:"ChatPanel",props:{file:{type:Object,default:null}},setup(i,{expose:t}){const e=i,n=(window.__SMART_READER_HOST__||null)?.ws_url||"",r=Nt(""),{store:a,messages:o,sendMessage:l}=Ly({wsUrl:n,projectId:zr,sessionId:e.file?.id||zr,namespace:zr,mode:"smart_reader",autoConnect:!!n}),c=Bt(()=>!e.file||e.file.status!=="ready"||!n),h=d=>{!d||c.value||l(d,{pluginContext:{file_id:e.file?.id||null}})};return t({appendContext:d=>{d&&(r.value=r.value?`${r.value}

${d}`:d)}}),Ln(()=>e.file?.id,async d=>{d&&(a.setSession(d),await a.loadSession(d))},{immediate:!0}),(d,f)=>(U(),ct("div",h0,[yt(o).length?Se("",!0):(U(),ct("div",u0,"AI ")),bt(yt(r0),{messages:yt(o)},{composer:Gt(()=>[bt(yt(c0),{modelValue:r.value,"onUpdate:modelValue":f[0]||(f[0]=p=>r.value=p),disabled:c.value,"send-label":"",placeholder:"",onSend:h},null,8,["modelValue","disabled"])]),_:1},8,["messages"]),f[1]||(f[1]=X("div",{class:"disclaimer"},"AI ",-1))]))}},f0={class:"workbench"},p0={class:"workbench-header"},g0={class:"workbench-left"},m0={class:"workbench-title"},v0={class:"split-view"},y0={class:"panel"},b0={class:"panel-body"},A0={key:1,class:"empty-state"},w0={class:"panel"},x0={class:"panel-body"},E0={__name:"WorkbenchView",props:{file:{type:Object,default:null}},setup(i){const t=Nt(null),e=s=>{t.value?.appendContext?.(s)};return(s,n)=>(U(),ct("div",f0,[X("div",p0,[X("div",g0,[X("button",{class:"button ghost",onClick:n[0]||(n[0]=r=>s.$emit("back"))}," "),X("div",m0,ut(i.file?.name||""),1)]),n[2]||(n[2]=Jc('<div class="mode-toggle"><button class="active"></button><button class="disabled"></button></div><div class="toolbar-actions"><button class="button secondary"></button><button class="button secondary"></button></div>',2))]),X("div",v0,[X("div",y0,[n[3]||(n[3]=X("div",{class:"panel-header"},"",-1)),X("div",b0,[i.file?(U(),ht(py,{key:0,"file-id":i.file.id,onAddContext:e},null,8,["file-id"])):(U(),ct("div",A0,""))])]),X("div",w0,[n[4]||(n[4]=X("div",{class:"panel-header"},"AI ",-1)),X("div",x0,[bt(d0,{ref_key:"chatPanelRef",ref:t,file:i.file,onRefresh:n[1]||(n[1]=r=>s.$emit("refresh"))},null,8,["file"])])])])]))}},S0=()=>{const i=Nt("lobby"),t=Nt("grid"),e=Nt([]),s=Nt(!1),n=Nt(""),r=Nt(null),a=async(g=!1)=>{g||(s.value=!0),n.value="";try{const m=await ry();m.status==="ok"?e.value=m.files||[]:n.value=m.message||""}catch(m){n.value=m?.message||""}finally{g||(s.value=!1)}},o=async g=>{if(g?.length){s.value=!0,n.value="";try{for(const m of g){const v=await ay(m);v.status!=="ok"&&(n.value=v.detail||v.message||"")}await a()}catch(m){n.value=m?.message||""}finally{s.value=!1}}},l=async g=>{if(!g)return;(await oy(g.id)).status==="ok"&&(r.value=g,i.value="workbench")},c=async()=>{i.value="lobby",r.value=null,await a()},h=async()=>{const g=await ly();g.status==="ok"&&g.file&&(r.value=g.file)};let u=null;const d=()=>e.value.some(g=>g.status==="processing"),f=()=>{u||(u=setInterval(async()=>{i.value==="lobby"&&e.value.length&&d()&&await a(!0)},3e3))},p=()=>{u&&(clearInterval(u),u=null)};return Qi(()=>{a(),f()}),qi(()=>{p()}),{view:i,viewMode:t,files:e,loading:s,error:n,currentFile:r,fetchFiles:a,handleAddFiles:o,openFile:l,backToLobby:c,refreshCurrentFile:h}},T0={class:"app-shell"},P0={class:"main"},C0={__name:"App",setup(i){const{view:t,viewMode:e,files:s,loading:n,error:r,currentFile:a,fetchFiles:o,handleAddFiles:l,openFile:c,backToLobby:h,refreshCurrentFile:u}=S0();return(d,f)=>(U(),ct("div",T0,[yt(t)==="lobby"?(U(),ht(If,{key:0})):Se("",!0),X("main",P0,[yt(t)==="lobby"?(U(),ct(Ut,{key:0},[bt(Df,{"view-mode":yt(e),onAddFiles:yt(l),onRefresh:yt(o),onToggleView:f[0]||(f[0]=p=>e.value=p)},null,8,["view-mode","onAddFiles","onRefresh"]),bt(Vf,{files:yt(s),loading:yt(n),error:yt(r),onOpen:yt(c)},null,8,["files","loading","error","onOpen"])],64)):(U(),ht(E0,{key:1,file:yt(a),onBack:yt(h),onRefresh:yt(u)},null,8,["file","onBack","onRefresh"]))])]))}},I0=async()=>{let i=null;try{i=await cy()}catch{i=null}window.__SMART_READER_HOST__=i,xf(C0).mount("#app")};I0();
